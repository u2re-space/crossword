/**
 * Shell Custom Properties
 *
 * CSS custom properties specific to shell layouts.
 * Uses :has() selectors for context-aware theming.
 *
 * Layer: properties.shell
 *
 * @module properties/shell
 */

@use "../lib" as lib;

// ============================================================================
// LAYER: properties.shell
// ============================================================================

@layer properties.shell {
    
    // ==========================================================================
    // SHELL BASE PROPERTIES
    // ==========================================================================
    
    :root {
        // Shell layout tokens
        --shell-nav-height: 48px;
        --shell-sidebar-width: 240px;
        --shell-sidebar-collapsed: 64px;
        --shell-status-height: 24px;
        --shell-toolbar-height: 40px;
        --shell-tab-height: 36px;
        
        // Shell colors (defaults - can be overridden by shell-specific rules)
        --shell-bg: var(--color-surface);
        --shell-fg: var(--color-on-surface);
        --shell-nav-bg: var(--color-surface-elevated);
        --shell-nav-fg: var(--color-on-surface);
        --shell-sidebar-bg: var(--color-surface);
        --shell-sidebar-fg: var(--color-on-surface);
        --shell-status-bg: var(--color-surface-elevated);
        --shell-status-fg: var(--color-text-secondary);
        
        // Shell borders
        --shell-border-color: var(--color-border);
        --shell-divider-color: var(--color-border);
        
        // Shell transitions
        --shell-transition: var(--transition-normal) var(--ease-in-out);
    }
    
    // ==========================================================================
    // CONTEXT: RAW SHELL
    // Using :has() for context-aware properties
    // ==========================================================================
    
    :root:has([data-shell="raw"]),
    html:has([data-shell="raw"]) {
        // Raw shell: minimal chrome, full content area
        --shell-nav-height: 0;
        --shell-sidebar-width: 0;
        --shell-status-height: 0;
        
        --shell-bg: var(--color-surface);
        --shell-fg: var(--color-on-surface);
    }
    
    body:has([data-shell="raw"]) {
        // Ensure body fills viewport for raw shell
        overflow: hidden;
    }
    
    // ==========================================================================
    // CONTEXT: BASIC SHELL
    // ==========================================================================
    
    :root:has([data-shell="basic"]),
    html:has([data-shell="basic"]) {
        // Basic shell: simple top navigation
        --shell-nav-height: 48px;
        --shell-sidebar-width: 0;
        --shell-status-height: 24px;
        
        --shell-nav-bg: var(--color-surface-elevated);
        --shell-nav-fg: var(--color-on-surface);
        --shell-nav-border: var(--color-border);
    }
    
    body:has([data-shell="basic"]) {
        // Basic shell body adjustments
        padding-block-start: var(--shell-nav-height);
    }
    
    // Basic shell dark theme context
    :root:has([data-shell="basic"][data-theme="dark"]),
    html:has([data-shell="basic"][data-theme="dark"]) {
        --shell-bg: #1e1e1e;
        --shell-fg: #e0e0e0;
        --shell-nav-bg: #252525;
        --shell-nav-fg: #e0e0e0;
        --shell-nav-border: #333333;
    }
    
    // ==========================================================================
    // CONTEXT: FAINT SHELL
    // ==========================================================================
    
    :root:has([data-shell="faint"]),
    html:has([data-shell="faint"]) {
        // Faint shell: sidebar + tabs + toolbar
        --shell-nav-height: 0; // Uses tabs instead
        --shell-sidebar-width: 240px;
        --shell-tab-height: 36px;
        --shell-toolbar-height: 40px;
        --shell-status-height: 24px;
        
        --shell-sidebar-bg: var(--color-surface);
        --shell-sidebar-fg: var(--color-on-surface);
        --shell-sidebar-border: var(--color-border);
        
        // Tab bar
        --shell-tabs-bg: var(--color-surface-elevated);
        --shell-tab-active-bg: var(--color-surface);
        --shell-tab-hover-bg: var(--color-surface-hover);
    }
    
    body:has([data-shell="faint"]) {
        // Faint shell body: account for sidebar
        margin-inline-start: var(--shell-sidebar-width);
    }
    
    // Faint shell dark theme context
    :root:has([data-shell="faint"][data-theme="dark"]),
    html:has([data-shell="faint"][data-theme="dark"]) {
        --shell-bg: #1e1e1e;
        --shell-fg: #f0f0f0;
        --shell-sidebar-bg: #171717;
        --shell-sidebar-fg: #e0e0e0;
        --shell-sidebar-border: #2a2a2a;
        --shell-tabs-bg: #252525;
        --shell-tab-active-bg: #1e1e1e;
        --shell-tab-hover-bg: #2a2a2a;
    }
    
    // ==========================================================================
    // RESPONSIVE: MOBILE/TABLET ADJUSTMENTS
    // ==========================================================================
    
    @media (max-width: 768px) {
        :root:has([data-shell="faint"]),
        html:has([data-shell="faint"]) {
            // Collapse sidebar on mobile
            --shell-sidebar-width: 0;
        }
        
        body:has([data-shell="faint"]) {
            margin-inline-start: 0;
        }
        
        :root:has([data-shell="basic"]),
        html:has([data-shell="basic"]) {
            // Compact nav on mobile
            --shell-nav-height: 44px;
        }
    }
    
    // ==========================================================================
    // PRINT STYLES
    // ==========================================================================
    
    @media print {
        :root {
            --shell-nav-height: 0;
            --shell-sidebar-width: 0;
            --shell-status-height: 0;
            --shell-bg: white;
            --shell-fg: black;
        }
        
        body:has([data-shell]) {
            margin: 0;
            padding: 0;
        }
    }
}
