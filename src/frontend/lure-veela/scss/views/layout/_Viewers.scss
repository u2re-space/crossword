// Viewer Components - Refactored and Optimized
// Unified with design system variables and mixins

@use "veela-lib" as *;
@use "../../library/mixins" as ui;

@layer rs-viewers {
    [data-type="tasks"],
    [data-type="contacts"],
    [data-type="bonuses"],
    [data-type="services"] {
        grid-auto-rows: minmax(0px, max-content);
        grid-auto-flow: row;
        column-fill: balance;
        align-items: start;

        //
        @include grid-auto-fill(260px);
        @include scrollable("y");
    }

    //
    /*
    .app-layout > * > section,
    .app-layout > section {
        grid-column: 1 / -1;
        grid-row: 2 / -1;
        inline-size: stretch;
        block-size: stretch;
    }*/

    //
    .app-layout > * > section,
    .app-layout > section {
        pointer-events: auto;
        touch-action: manipulation;

        margin-inline: var(--padding-sm);
        display: grid;
        grid-template-columns: minmax(0px, 1fr);
        grid-template-rows: minmax(0px, 1fr) minmax(0px, max-content);
        grid-template-areas: "content" "toolbar";
        inline-size: stretch;
        block-size: stretch;
        gap: var(--gap-xs);

        grid-column: 1 / -1;
        grid-row: 2 / -1;

        @include scrollable("y");
        @include ui.tonal-surface(surface-container-low, var(--surface-opacity-subtle), var(--radius-lg), null, 1);
        @include container-clamped(stretch, stretch);

        &.viewer-section {
            background-color: transparent;
        }

        & {
            border-radius: var(--radius-lg);
            clip-path: inset(0px round var(--radius-lg));
        }
    }

    //
    header {
        min-block-size: max-content;
        block-size: max-content;
        line-height: normal;
        touch-action: manipulation;
        pointer-events: auto;

        * { pointer-events: none; }
    }

    //
    .view {
        display: block;
        padding: 0;
        border-radius: var(--radius-sm);

        & > h2 {
            margin: 0 0 var(--gap-sm) 0;
            @include ui.text-heading("title-medium");
            letter-spacing: 0.01em;
        }
    }

    //
    ui-tabbed-box {
        inline-size: stretch;
        block-size: stretch;
        padding-block: var(--padding-sm);

        grid-column: 1 / -1;
        grid-row: 1 / -1;

        //
        @include container("lg") {
            order: 3;
            grid-column: 1 / -1;
        }

        .viewer-tab-content {
            overflow-x: hidden;
            scrollbar-gutter: auto;
            touch-action: manipulation;
            pointer-events: auto;
            align-content: start;

            //
            @include ui.vstack(var(--gap-xs));
            @include ui.tonal-surface(surface-container, var(--surface-opacity-subtle), var(--radius-lg), var(--padding-sm), 1);
            @include scrollable("y");

            .viewer-tab-content-header {
                @include ui.text-heading("title-large", center);
                color: color-mix(in oklch, var(--on-surface, currentColor) var(--surface-opacity-muted, 8%), transparent);
                padding: var(--padding-xs);
                border-radius: var(--radius-sm);
                background-color: transparent;
                pointer-events: none;
            }

            .viewer-tab-content-body {
                @include ui.vstack(var(--gap-xs));
                pointer-events: none;
                block-size: max-content;
            }
        }
    }

    //
    .subgroup {
        @include ui.vstack(var(--gap-xs));
        pointer-events: none;

        .subgroup-items {
            @include ui.vstack(var(--gap-xs));
            padding: var(--padding-xs);
            pointer-events: none;
        }

        .subgroup-header {
            @include ui.text-label("title-small", true);
            color: color-mix(in oklch, var(--on-surface, currentColor) var(--text-tint-primary, 92%), transparent);
            text-align: center;
            padding: var(--padding-xs);
            border-radius: var(--radius-sm);
            @include ui.tonal-surface(surface, var(--surface-opacity-emphasis), var(--radius-sm));
            pointer-events: none;
        }
    }
}
