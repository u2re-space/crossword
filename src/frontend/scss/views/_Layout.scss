@layer rs-layout {
    //
    :root {
        --card-radius: 0.75rem;
        --card-padding: 0.75rem;
        --card-shadow: 0 6px 18px rgba(0,0,0,0.12);
        --card-avatar-size: 40px;
    }

    .app-layout {

        .timeline-tab {
            overflow: hidden auto;
            scrollbar-width: thin;
            scrollbar-color: oklch(from --c2-on-surface(0.0, var(--current, currentColor)) l c h / 0.4) transparent;
            gap: 1rem;
            margin-inline: 0px;
            padding-inline: 0px;
            border-radius: 0.5rem;
            touch-action: manipulation;
            pointer-events: auto;
            display: grid;
            grid-auto-flow: row;
            grid-template-columns: minmax(0px, 1fr);
            grid-auto-rows: minmax(0px, max-content);
            padding-block: clamp(0.35rem, 0.8vw, 0.6rem);
        }

        .timeline-tabs {
            inline-size: stretch;
            block-size: stretch;
            background-color: transparent;
            display: grid;
            grid-template-rows: minmax(0px, max-content) minmax(0px, 1fr);
            gap: clamp(0.5rem, 1vw, 0.8rem);
            padding: clamp(0.45rem, 0.8vw, 0.7rem);
            border-radius: clamp(0.65rem, 1vw, 0.9rem);
            background: color-mix(in oklab, var(--current, currentColor) 4%, transparent);

            &[class*="c2-"] {
                background-color: transparent;
            }
        }

        .timeline-tabs::part(tabs) {
            background: color-mix(in oklab, var(--current, currentColor) 4%, transparent);
            border-radius: clamp(0.5rem, 1vw, 0.8rem);
            padding: clamp(0.3rem, 0.7vw, 0.5rem);
            gap: clamp(0.25rem, 0.6vw, 0.45rem);
        }

        .timeline-tabs::part(content) {
            background: color-mix(in oklab, var(--current, currentColor) 2%, transparent);
            border-radius: clamp(0.55rem, 1vw, 0.8rem);
            padding: clamp(0.3rem, 0.7vw, 0.5rem);
            overflow: hidden;
            box-shadow: inset 0 1px 0 color-mix(in oklab, var(--current, currentColor) 12%, transparent);
        }

        .timeline-tabs::part(tab) {
            background: color-mix(in oklab, var(--current, currentColor) 8%, transparent);
            color: --c2-on-surface(0.0, var(--current, currentColor));
            font-weight: 600;
            font-size: clamp(0.75rem, 0.4cqi + 0.7rem, 0.85rem);
            letter-spacing: 0.01em;
            transition: background-color 160ms ease, color 160ms ease, transform 160ms ease;
            border: 1px solid transparent;
        }

        .timeline-tabs::part(tab)[data-active] {
            background: color-mix(in oklab, var(--current, currentColor) 16%, transparent);
            border-color: color-mix(in oklab, var(--current, currentColor) 24%, transparent);
            transform: translateY(-1px);
        }

        .timeline-tabs::part(tab):focus-visible {
            outline: none;
            border-color: color-mix(in oklab, var(--current, currentColor) 32%, transparent);
            box-shadow: 0 0 0 2px color-mix(in oklab, var(--current, currentColor) 28%, transparent);
        }

        .timeline-day {
            margin-block-end: 1rem;
            pointer-events: auto;
            touch-action: manipulation;
        }

        section {
            pointer-events: auto;
            overflow: hidden auto;
            scrollbar-width: thin;
            scrollbar-color: oklch(from --c2-on-surface(0.0, var(--current, currentColor)) l c h / 0.4) transparent;
            touch-action: manipulation;
        }

        header {
            min-block-size: max-content;
            block-size: max-content;
            line-height: normal;
            touch-action: manipulation;
            pointer-events: auto;

            * {
                pointer-events: none;
            }
        }

        &, & * {
            line-height: normal;
        }

        .tab {
            display: grid;
            grid-auto-flow: row;
            gap: 0.75rem;
            padding: 0.25rem;
            background-color: transparent;
            inline-size: stretch;
            block-size: stretch;
            overflow: hidden auto;
            scrollbar-width: thin;
            scrollbar-color: oklch(from --c2-on-surface(0.0, var(--current, currentColor)) l c h / 0.4) transparent;

            &::-webkit-scrollbar {
                inline-size: 6px;
            }

            &::-webkit-scrollbar-thumb {
                background: color-mix(in oklab, var(--current, currentColor) 28%, transparent);
                border-radius: 999px;
            }

            &::-webkit-scrollbar-track {
                background: transparent;
            }
        }

        .view {
            display: block;
            padding: 0px;
            border-radius: 0.5rem;
        }

        .view > h2 {
            margin: 0 0 0.5rem 0;
            font-weight: 700;
            font-size: 1.125rem;
            letter-spacing: 0.01em;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 0.5rem;
        }

        .sidebar {
            & {
                display: flex;
                flex-direction: column;
                justify-content: flex-start;
                align-items: stretch;
                max-inline-size: stretch;
                min-inline-size: max-content;
                text-align: start;
                inline-size: min(160px, 100cqi);
                box-sizing: border-box;
                gap: 0rem;
                border-radius: 0.25rem;
                background-color: transparent;
                background-color: --c2-surface(0.0, var(--current, transparent));
                box-shadow: 0 0 0.125rem 0 rgba(0, 0, 0, 0.1);
                user-select: none;
                padding: 0.25rem;
            }

            //
            &[slot="sidebar"] {
                grid-column: 1 / 2;
                grid-row: 2 / 3;
                position: sticky;
                inset-block-start: 0.5rem;
                align-self: start;
                max-block-size: calc(100dvb - 1rem);
                overflow: auto;
            }

            // Navigation list container
            ul {
                display: flex;
                flex-direction: column;
                //padding: 0.375rem; /* inset padding */
                padding: 0rem;
                margin: 0;
                inline-size: stretch;
                user-select: none;
                list-style: none;
                overflow: hidden;
                background-color: --c2-surface(0.1, var(--current, transparent));
                box-shadow: inset 0 6px 14px rgba(0,0,0,0.04), inset 0 -6px 10px rgba(255,255,255,0.02);
                box-sizing: border-box;
                gap: 0px;
                border-radius: 0.25rem;

                &::focus {
                    border: none 0px transparent;
                    outline: none 0px transparent;
                }

                // list items are simple rows inside the inset box
                li {
                    display: flex;
                    flex-direction: row;
                    align-items: center;
                    inline-size: stretch;
                    box-sizing: border-box;
                    border-radius: 0.25rem;
                    background-color: transparent;
                    transition: background-color .12s linear, color .12s linear;
                    pointer-events: none;
                    overflow: hidden;

                    gap: 0rem;
                    margin: 0px;
                    user-select: none;
                    padding: 0px;

                    //
                    * { pointer-events: none; }
                    &:hover,
                    &:focus-within {
                        background-color: --c2-surface(0.12, var(--current, transparent));
                    }

                    a {
                        display: flex;
                        flex-direction: row;
                        align-items: center;
                        justify-items: start;

                        padding: 0.5rem;
                        inline-size: stretch;
                        text-decoration: none;
                        color: inherit;
                        block-size: max-content;

                        pointer-events: auto;
                        row-gap: 0rem;
                        column-gap: 0.25rem;

                        background: transparent;
                        background-color: transparent;
                        color: --c2-on-surface(0.0, var(--current, currentColor));

                        user-select: none;
                        border: none 0px transparent;
                        outline: none 0px transparent;

                        &::focus {
                            border: none 0px transparent;
                            outline: none 0px transparent;
                        }

                        ui-icon {
                            justify-self: start;
                            inline-size: 1.5rem;
                            block-size: 1.5rem;
                            pointer-events: none;

                            --icon-color: --c2-on-surface(0.0, var(--current, currentColor));
                        }

                        span {
                            display: block;
                            justify-self: start;
                            text-align: start;
                            inline-size: 100%;
                            pointer-events: none;
                        }
                    }

                    &::focus {
                        border: none 0px transparent;
                        outline: none 0px transparent;
                        background-color: --c2-surface(0.02, var(--current, currentColor));
                    }

                    a:visited {
                        background-color: transparent;
                    }

                    a:link {
                        background-color: transparent;
                    }

                    a:hover {
                        background-color: --c2-surface(0.06, var(--current, currentColor));
                    }

                    a:active {
                        background-color: --c2-surface(0.09, var(--current, currentColor));
                    }
                }
            }

            // enforce left/start alignment for all nested text elements
            &, ul, ul li, ul li a, ul li a span {
                text-align: start;
                direction: ltr;
                justify-items: start;
                justify-self: start;
            }

        }


        & {
            display: grid;
            box-sizing: border-box;

            inline-size: stretch;
            block-size: stretch;

            place-content: center;
            place-items: center;
            justify-content: start;
        }

        & > [slot="bar"] {
            grid-column: 1 / -1;
            margin: 0;
            padding: 0.25rem 0.5rem;
            background-color: --c2-surface(0.02, var(--current, currentColor));
        }

        & > ui-tabbed-box {
            grid-column: 2 / -1;
            grid-row: 2 / 3;
            inline-size: stretch;
            block-size: stretch;
        }

        & section {
            display: grid;
            grid-template-columns: minmax(0px, 1fr);
            grid-template-rows: minmax(0px, 1fr) minmax(0px, max-content);
            grid-template-areas: "content" "toolbar";
            border-radius: 0.5rem;
            inline-size: stretch;
            block-size: stretch;
            gap: 0.25rem;
            background-color: transparent;
            overflow: hidden auto;
            scrollbar-width: thin;
            scrollbar-color: oklch(from --c2-on-surface(0.0, var(--current, currentColor)) l c h / 0.4) transparent;
        }

        & > .toolbar {
            & {
                grid-column: 1 / -1;
                margin: 0;
                flex-direction: row;
                gap: 0.25rem;
                block-size: max-content;
                inline-size: stretch;
                display: flex;
                background-color: transparent;
                justify-content: start;
                padding: 0.25rem 0.5rem;
                padding-block-start: 0.5rem;
                position: sticky;
                inset-block-start: 0;
                z-index: 10;
                backdrop-filter: blur(6px) saturate(120%);
            }

            button {
                & {
                    display: flex;
                    flex-direction: row;
                    gap: 0.25rem;
                    block-size: max-content;
                    inline-size: max-content;
                    max-block-size: 3rem;
                    border-radius: 0.5rem;
                    border: 0px none transparent;
                    outline: 0px none transparent;
                    cursor: pointer;
                    background-color: --c2-surface(0.02, var(--current, currentColor));
                    padding: 0.333rem;
                    transition: background-color 0.12s linear;
                    aspect-ratio: auto;

                    place-content: center;
                    place-items: center;
                }

                span {
                    display: block;
                    font-size: 0.8rem;
                    font-weight: 400;
                    color: --c2-on-surface(0.0, var(--current, currentColor));
                    padding-inline-end: 0.333rem;
                }

                &:hover {
                    background-color: --c2-surface(0.04, var(--current, currentColor));
                }
            }

            @container (max-inline-size: 800px) {
                button {
                    span {
                        display: none;
                    }
                }
            }
        }

        @container (max-inline-size: 800px) {
            & > nav[slot="sidebar"] {
                position: static;
                max-block-size: none;
                order: 2;
                inline-size: calc(100cqi - 0.5rem);
            }

            & nav {
                padding: 0.5rem 0.25rem;
                inline-size: 100cqi;
            }

            & nav ul {
                //flex-direction: row;
                gap: 0px;
                overflow-x: auto;
                padding-inline: 0px;
                inline-size: stretch;
                -webkit-overflow-scrolling: touch;
            }

            & nav ul li {
                flex: 0 0 auto;
                white-space: nowrap;
                border-radius: 0.375rem;
            }

            & > ui-tabbed-box {
                order: 3;
                grid-column: 1 / -1;
            }
        }
    }
}
