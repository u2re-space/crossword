@layer rs-layout {

    // Task timeline card variables
    :root {
        --card-radius: 0.75rem;
        --card-padding: 0.75rem;
        --card-shadow: 0 6px 18px rgba(0,0,0,0.12);
        --card-avatar-size: 40px;
    }

    .tab {
        display: flex;
        border-radius: 0.5rem;
        flex-direction: column;
        gap: 0.5rem;
        padding: 0.5rem;
        background-color: --c2-surface(0.0, var(--current, currentColor));
        color: --c2-on-surface(0.0, var(--current, currentColor));
        box-shadow: 0 1px 2px rgba(0,0,0,0.04);
        transition: box-shadow 160ms ease, transform 160ms ease, background-color 160ms ease;
        touch-action: manipulation;
        user-select: none;
        inline-size: stretch;
        block-size: stretch;
    }

    .view {
        display: block;
        padding: 0.75rem;
        border-radius: 0.5rem;
    }

    .view > h2 {
        margin: 0 0 0.5rem 0;
        font-weight: 700;
        font-size: 1.125rem;
        letter-spacing: 0.01em;
    }

    .cards-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
        gap: 0.5rem;
    }

    nav {
        display: flex;
        flex-direction: column;
        gap: 0.125rem;
        padding: 0.25rem;
        border-radius: 0.25rem;
        background-color: var(--c2-surface);
        box-shadow: 0 0 0.125rem 0 rgba(0, 0, 0, 0.1);
        user-select: none;

        ul {
            display: flex;
            flex-direction: column;
            gap: 0.125rem;
            padding: 0px;
            border-radius: 0.25rem;
            background-color: var(--c2-surface);
            inline-size: stretch;
            user-select: none;
        }

        li {
            display: flex;
            flex-direction: column;
            gap: 0.125rem;
            padding: 0px;
            border-radius: 0.25rem;
            inline-size: stretch;
            user-select: none;
        }

        a {
            display: flex;
            flex-direction: column;
            gap: 0.125rem;
            padding: 0.25rem;
            border-radius: 0.25rem;
            color: --c2-on-surface(0.0, var(--current, currentColor));
            background-color: --c2-surface(0.0, var(--current, currentColor));
            inline-size: stretch;
            user-select: none;
        }

        a:visited {
            background-color: --c2-surface(0.0, var(--current, currentColor));
        }

        a:link {
            background-color: --c2-surface(0.0, var(--current, currentColor));
        }

        a:focus {
            background-color: --c2-surface(0.02, var(--current, currentColor));
        }

        a:hover {
            background-color: --c2-surface(0.05, var(--current, currentColor));
        }

        a:active {
            background-color: --c2-surface(0.08, var(--current, currentColor));
        }
    }

    //
    ui-box-with-sidebar {
        & {
            display: grid;
            box-sizing: border-box;

            inline-size: stretch;
            block-size: stretch;

            place-content: center;
            place-items: center;
            justify-content: start;
        }

        & > [slot="bar"] {
            grid-column: 1 / -1;
            margin: 0;
            padding: 0.25rem 0.5rem;
            background-color: --c2-surface(0.02, var(--current, currentColor));
        }

        & > ui-tabbed-box {
            grid-column: 2 / -1;
            grid-row: 2 / 3;
            inline-size: stretch;
            block-size: stretch;
        }

        & section {
            display: grid;
            grid-template-columns: minmax(0px, 1fr);
            grid-template-rows: minmax(0px, 1fr) minmax(0px, max-content);
            grid-template-areas: "content" "toolbar";
            border-radius: 0.5rem;
            inline-size: stretch;
            block-size: stretch;
            gap: 0.25rem;
            background-color: transparent;
        }

        & > .toolbar {
            & {
                grid-column: 1 / -1;
                margin: 0;
                flex-direction: row;
                gap: 0.25rem;
                block-size: max-content;
                inline-size: stretch;
                display: flex;
                background-color: transparent;
                justify-content: start;
                padding: 0.25rem 0.5rem;
                padding-block-start: 0.5rem;
                position: sticky;
                inset-block-start: 0;
                z-index: 10;
                backdrop-filter: blur(6px) saturate(120%);
            }

            button {
                & {
                    display: flex;
                    flex-direction: row;
                    gap: 0.25rem;
                    block-size: max-content;
                    inline-size: max-content;
                    max-block-size: 3rem;
                    border-radius: 0.5rem;
                    border: 0px none transparent;
                    outline: 0px none transparent;
                    cursor: pointer;
                    background-color: --c2-surface(0.02, var(--current, currentColor));
                    padding: 0.333rem;
                    transition: background-color 0.12s linear;
                    aspect-ratio: auto;

                    place-content: center;
                    place-items: center;
                }

                span {
                    display: block;
                    font-size: 0.8rem;
                    font-weight: 400;
                    color: --c2-on-surface(0.0, var(--current, currentColor));
                    padding-inline-end: 0.333rem;
                }

                &:hover {
                    background-color: --c2-surface(0.04, var(--current, currentColor));
                }
            }

            @container (max-inline-size: 800px) {
                button {
                    span {
                        display: none;
                    }
                }
            }
        }

        nav {
            & {
                display: flex;
                flex-direction: column;
                justify-content: flex-start;
                align-items: stretch;
                max-inline-size: stretch;
                min-inline-size: max-content;
                text-align: start;
                padding: 0.25rem;
                inline-size: min(160px, 100cqi);
                box-sizing: border-box;
            }

            &[slot="sidebar"] {
                grid-column: 1 / 2;
                grid-row: 2 / 3;
                position: sticky;
                inset-block-start: 0.5rem;
                align-self: start;
                max-block-size: calc(100dvb - 1rem);
                overflow: auto;
            }

            // Navigation list container
            ul {
                display: flex;
                flex-direction: column;
                gap: 0.25rem;
                //padding: 0.375rem; /* inset padding */
                padding: 0rem;
                margin: 0;
                border-radius: 0.5rem;
                inline-size: stretch;
                user-select: none;
                list-style: none;
                overflow: hidden;
                background-color: --c2-surface(0.08, var(--current, transparent));
                box-shadow: inset 0 6px 14px rgba(0,0,0,0.04), inset 0 -6px 10px rgba(255,255,255,0.02);
                box-sizing: border-box;

                &::focus {
                    border: none 0px transparent;
                    outline: none 0px transparent;
                }

                // list items are simple rows inside the inset box
                li {
                    display: flex;
                    flex-direction: row;
                    align-items: center;
                    gap: 0.5rem;
                    inline-size: stretch;
                    box-sizing: border-box;
                    margin: 0;
                    border-radius: 0.25rem;
                    background: transparent;
                    transition: background-color .12s linear, color .12s linear;
                    pointer-events: none;

                    * {
                        pointer-events: none;
                    }

                    &:hover,
                    &:focus-within {
                        background-color: --c2-surface(0.12, var(--current, transparent));
                    }

                    a {
                        display: grid;
                        grid-template-columns: minmax(0px, max-content) minmax(0px, 1fr);
                        align-items: center;
                        justify-items: start;
                        gap: 0.25rem;
                        padding: 0.5rem 0.5rem;
                        inline-size: 100%;
                        text-decoration: none;
                        color: inherit;
                        background: transparent;
                        block-size: stretch;
                        border: none 0px transparent;
                        outline: none 0px transparent;

                        pointer-events: auto;

                        * {
                            pointer-events: none;
                        }

                        &::focus {
                            border: none 0px transparent;
                            outline: none 0px transparent;
                        }

                        ui-icon {
                            justify-self: start;
                            inline-size: 1.5rem;
                            block-size: 1.5rem;

                            --icon-color: --c2-on-surface(0.0, var(--current, currentColor));
                        }

                        span {
                            display: block;
                            justify-self: start;
                            text-align: start;
                            inline-size: 100%;
                        }
                    }

                    &::focus {
                        border: none 0px transparent;
                        outline: none 0px transparent;
                    }
                }
            }

            // enforce left/start alignment for all nested text elements
            &, ul, ul li, ul li a, ul li a span {
                text-align: start;
                direction: ltr;
                justify-items: start;
                justify-self: start;
            }
        }

        @container (max-inline-size: 800px) {
            & > nav[slot="sidebar"] {
                position: static;
                max-block-size: none;
                order: 2;
                inline-size: calc(100cqi - 0.5rem);
            }

            & nav {
                padding: 0.5rem 0.25rem;
                inline-size: 100cqi;
            }

            & nav ul {
                //flex-direction: row;
                gap: 0.5rem;
                overflow-x: auto;
                padding-inline: 0.25rem;
                inline-size: stretch;
                -webkit-overflow-scrolling: touch;
            }

            & nav ul li {
                flex: 0 0 auto;
                white-space: nowrap;
                border-radius: 0.375rem;
            }

            & > ui-tabbed-box {
                order: 3;
                grid-column: 1 / -1;
            }
        }

    }
}
