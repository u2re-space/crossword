/* ai-refactor: optimized/refactored at 2026-02-13T02:51:29Z */
@use "../lib/config" as config;
@use "../lib/mixins" as mixins;
@use "../lib/tokens" as tokens;

@mixin print-sizing {
    inline-size: 100%;
    box-sizing: border-box;
}

@mixin print-grayscale {
    filter: grayscale(100%);
}

@mixin print-font-smoothing($mode: auto) {
    @if $mode == never {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    } @else {
        -webkit-font-smoothing: auto;
        -moz-osx-font-smoothing: auto;
    }
}

@mixin print-page-break($before: auto, $after: auto, $inside: auto) {
    @if $before != auto {
        page-break-before: $before;
        break-before: $before;
    }
    @if $after != auto {
        page-break-after: $after;
        break-after: $after;
    }
    @if $inside != auto {
        page-break-inside: $inside;
        break-inside: $inside;
    }
}

$selectors: "#markdown, .markdown-body, #raw-md, .markdown-viewer, .print-view";

@import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap");

@layer tokens, base, layout, components, utilities, overrides;

@layer tokens {
    :root:has(.print-view),
    .print-view {
        --print-font-family: "Times New Roman", "Times", "Liberation Serif", "Noto Serif", serif;
        --print-font-family-sans: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        --print-font-mono: "Monaco", "Menlo", "Ubuntu Mono", "Liberation Mono", "Noto Mono", monospace;
        --print-text-color: #1a1a1a;
        --print-bg: #ffffff;
        --print-border-color: #d1d5db;
        --print-link-color: #2563eb;
    }
}


@page {
    size: A4;
    margin: config("page", "margin");

    @bottom-center {
        content: counter(page);
        font-family: config("typography", "font-family", "sans");
        font-size: config("typography", "font-size", "base");
        line-height: tokens.$line-height-base;
    }

    @top-right {
        content: "UC";
        font-family: config("typography", "font-family", "sans");
        font-size: config("typography", "font-size", "base");
    }
}

@page :first {
    margin-top: 4cm;
    margin-bottom: 2.5cm;
    margin-left: 2cm;
    margin-right: 2cm;
}

@page :left {
    margin-right: 3cm;
    margin-left: 2cm;
}

@page :right {
    margin-left: 3cm;
    margin-right: 2cm;
}

@page narrow {
    size: A5 portrait;
    margin: 1.5cm 1.5cm 1.5cm 1.5cm;
}

@page wide {
    size: A4 landscape;
    margin: 2cm 2cm 2cm 2cm;
}

@page letter {
    size: letter portrait;
    margin: 2.5cm 2cm 2.5cm 2cm;
}

@page legal {
    size: legal portrait;
    margin: 2.5cm 2cm 2.5cm 2cm;
}

@page professional {
    size: A4 portrait;
    margin: 2.5cm 2cm 2.5cm 2cm;
    marks: crop cross;
    bleed: 0.25cm;
}

@page booklet {
    size: A5 portrait;
    margin: 1.5cm 1.5cm 1.5cm 1.5cm;
    marks: none;
    bleed: 0;
}

@page draft {
    size: A4 portrait;
    margin: 2cm 1.5cm 2cm 1.5cm;
    marks: none;
    bleed: 0;
}


@layer base {
    * {
        box-sizing: border-box;
    }

    :where(html, body):has(:where(#{$selectors}):not([hidden])) {
        @include print-sizing;
        margin: 0;
        padding: 0;
        background: var(--print-bg);
        color: var(--print-text-color);
        font-family: var(--print-font-family);
        line-height: 1.6;
        font-size: 16px;
        min-height: 100vh;
    }
}

@layer layout {
    .print-view {
        max-width: none;
        min-height: 100vh;
        padding: 0;
        margin: 0;
        inline-size: 100vw;
        block-size: 100vh;
        overflow-x: hidden;
    }

    .print-content {
        padding: 2rem;
        margin: 0;
        min-height: 100vh;
        font-size: 14px;
        line-height: 1.6;
        text-align: justify;
        hyphens: auto;
        word-wrap: break-word;
        overflow-wrap: break-word;
        @include print-sizing;
    }
}

@layer components {
    .markdown-body {
        @include print-sizing;

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            color: var(--print-text-color);
            margin-top: 1.5em;
            margin-bottom: 0.5em;
            line-height: 1.2;
            page-break-after: avoid;
        }

        h1 {
            font-size: 2rem;
            border-bottom: 2px solid var(--print-border-color);
            padding-bottom: 0.5rem;
        }

        h2 {
            font-size: 1.5rem;
            border-bottom: 1px solid var(--print-border-color);
            padding-bottom: 0.25rem;
        }

        h3 {
            font-size: 1.25rem;
        }

        h4 {
            font-size: 1.125rem;
        }

        h5 {
            font-size: 1rem;
        }

        h6 {
            font-size: 0.875rem;
        }

        p,
        ul,
        ol,
        blockquote {
            margin-bottom: 1rem;
            orphans: 3;
            widows: 3;
            text-align: justify;
            hyphens: auto;
        }

        ul,
        ol {
            padding-left: 1.5rem;
        }

        li {
            margin-bottom: 0.25rem;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        code {
            background: #f3f4f6;
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-family: var(--print-font-mono);
            font-size: 0.875em;
            word-wrap: break-word;
            overflow-wrap: break-word;
            max-inline-size: 100%;
        }

        pre {
            background: #f3f4f6;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin: 1rem 0;
            page-break-inside: avoid;
            word-wrap: break-word;
            overflow-wrap: break-word;
            @include print-sizing;

            code {
                background: none;
                padding: 0;
                border-radius: 0;
                white-space: pre-wrap;
                word-wrap: break-word;
                overflow-wrap: break-word;
            }
        }

        blockquote {
            border-left: 4px solid var(--print-border-color);
            padding-left: 1rem;
            color: #6b7280;
            font-style: italic;
            margin: 1rem 0;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        table {
            width: 100%;
            max-width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            page-break-inside: avoid;
            table-layout: fixed;
            word-wrap: break-word;
            overflow-wrap: break-word;
            @include print-sizing;
        }

        th,
        td {
            border: 1px solid var(--print-border-color);
            padding: 0.5rem;
            text-align: left;
            vertical-align: top;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        th {
            background: #f9fafb;
            font-weight: 600;
        }

        hr {
            border: none;
            border-top: 1px solid var(--print-border-color);
            margin: 2rem 0;
            page-break-after: avoid;
            @include print-sizing;
        }

        img {
            max-width: 100%;
            max-inline-size: 100%;
            height: auto;
            page-break-inside: avoid;
            display: block;
        }

        a {
            color: var(--print-link-color);
            text-decoration: underline;
            word-wrap: break-word;
            overflow-wrap: break-word;
            max-inline-size: 100%;
        }

        strong,
        b {
            font-weight: 600;
        }

        em,
        i {
            font-style: italic;
        }

        div,
        section,
        article,
        aside,
        header,
        footer,
        main,
        nav {
            @include print-sizing;
        }

        * {
            max-inline-size: 100%;
            @include print-sizing;
        }
    }
}

@layer utilities {
    @media print {
        :where(h1:first-child, h2) {
            break-before: auto;
        }

        h2:has(+h3) {
            break-before: recto;
        }

        h1:not(:first-child) {
            @include mixins.md-break(recto, auto, auto);
        }

        *:has(+h1) {
            break-after: auto;
        }

        h1 ~ h2:first-of-type {
            break-before: auto;
        }

        :where(table) + h2 {
            break-before: recto;
        }

        hr:has(+h1, +h2, +h3, +h4, +h5, +h6) {
            break-after: verso;
        }

        :where(table, pre, code, p, ul, ol, li) {
            @include mixins.md-break(auto, avoid-page, auto);
        }

        :where(hr, p, ol, li, table, blockquote, pre, code, strong) {
            & + :where(h1, h2, h3, h4, h5, h6) {
                break-before: recto;
            }

            &:has(+h1, +h2, +h3, +h4, +h5, +h6) {
                break-after: auto;
            }

            &:not(hr):has(+h2) {
                break-after: recto;
            }

            &:has(+p, +pre, +code, +ol, +li, +table, +blockquote, +strong) {
                break-after: avoid-page;
            }

            & + :where(p, ol, li, table, blockquote, strong) {
                break-before: avoid-page;
            }

            & + hr + :where(h1, h2):has(+:where(p, ol, ul, blockquote)) {
                break-before: recto;
            }
        }

        :where(.pb, .np, .pagebreak, .newpage, .page-break, .new-page) {
            background-color: transparent;
            page-break-after: always;
            @include mixins.md-break(auto, auto, page);
        }

        :where(h1, h2, h3, h4, h5, h6) {
            &:has(+:where(hr, p, ul, ol, li, table, blockquote, pre, code)) {
                break-before: auto;
                break-after: avoid-page;
            }
        }

        :where(h1, h2) {
            &:has(+:where(p, table, hr)) {
                break-before: recto;
            }
        }
    }
}

//
@layer overrides {
        
    @media print {
        :where(body, html, :root) {
            background-color: initial !important;
            font-family: var(--print-font-family);
            color: initial;
        }

        :where(html, body):has(:where(#{$selectors}):not([hidden])) {
            @include print-sizing;
            font-family: var(--print-font-family);
            font-size: 16px;
            line-height: 1.4;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
            font-variant-emoji: text;
            scrollbar-width: none;
            -ms-overflow-style: none;
            margin: 0;
            padding: 0;
        }

        html::-webkit-scrollbar,
        body::-webkit-scrollbar {
            display: none;
        }

        .print-view {
            padding: 0;
            margin: 0;
            @include print-sizing;
        }

        .print-content {
            padding: 0;
            margin: 0;
            @include print-sizing;
        }

        .markdown-body {
            font-family: var(--print-font-family);
            font-variant-emoji: text;
            @include print-sizing;

            *,
            *::before,
            *::after {
                max-inline-size: 100%;
                @include print-sizing;
            }

            code,
            pre,
            pre code {
                font-family: var(--print-font-mono);
            }

            table {
                width: 100% !important;
                table-layout: fixed;
            }

            img {
                max-width: 100% !important;
                height: auto !important;
            }

            pre {
                overflow-x: auto;
                white-space: pre-wrap;
                word-wrap: break-word;
            }
        }


        .print-narrow {
            page: narrow;
        }

        .print-wide {
            page: wide;
        }

        .print-letter {
            page: letter;
        }

        .print-legal {
            page: legal;
        }

        .print-professional {
            page: professional;
        }

        .print-booklet {
            page: booklet;
        }

        .print-draft {
            page: draft;
        }

        .print-chapter {
            page-break-before: always;
            break-before: page;
        }

        .print-section {
            page-break-before: avoid;
            break-before: avoid;
        }

        .markdown-body {
            h1,
            h2,
            h3,
            h4,
            h5,
            h6 {
                color: black !important;
                @include print-font-smoothing(never);
            }

            p,
            li,
            blockquote {
                color: black !important;
                @include print-grayscale;
                @include print-font-smoothing(never);
            }

            a {
                color: #333 !important;
                text-decoration: underline !important;
                @include print-grayscale;
                @include print-font-smoothing(never);
            }

            code,
            pre {
                background: #f5f5f5 !important;
                color: #333 !important;
                @include print-grayscale;
                @include print-font-smoothing(never);
            }

            table {
                border-color: #666 !important;
                @include print-grayscale;
            }

            th,
            td {
                border-color: #999 !important;
                @include print-grayscale;
            }

            th {
                background: #e5e5e5 !important;
                color: #333 !important;
                @include print-grayscale;
            }

            blockquote {
                background: #fafafa !important;
                border-left-color: #666 !important;
                @include print-grayscale;
            }

            hr {
                border-color: #999 !important;
                @include print-grayscale;
            }

            img {
                @include print-grayscale;
                image-rendering: -webkit-optimize-contrast;
                image-rendering: optimize-contrast;
            }

            * {
                background-color: transparent !important;
                box-shadow: none !important;
                border-color: #666 !important;
            }

            *,
            *::before,
            *::after {
                color: inherit !important;
                @include print-font-smoothing(never);
                text-shadow: none !important;
                font-variant-emoji: text !important;
            }

            strong,
            b {
                font-weight: bold !important;
                color: black !important;
                filter: none;
            }

            em,
            i {
                font-style: italic !important;
                color: black !important;
                filter: none;
            }

            ul,
            ol {
                list-style-position: outside;
            }

            li::marker {
                color: #666 !important;
            }

            pre[class*="language-"] {
                background: #f8f8f8 !important;
                @include print-grayscale;
            }

            pre[class*="language-"] * {
                @include print-grayscale;
            }

            .katex {
                @include print-grayscale;
                color: black !important;
            }

            svg {
                @include print-grayscale;
            }

            svg * {
                fill: currentColor !important;
                stroke: currentColor !important;
            }

            input,
            textarea,
            select {
                border: 1px solid #999 !important;
                background: white !important;
                color: black !important;
                @include print-grayscale;
            }

            .highlight,
            .mark {
                background: #e6e6e6 !important;
                @include print-grayscale;
            }

            .footnote,
            .reference {
                border-top: 1px solid #ccc !important;
                background: transparent !important;
                @include print-grayscale;
            }
        }

        a[href]::after {
            content: none !important;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            page-break-after: avoid;
            break-after: avoid;
            page-break-before: avoid;
            break-before: avoid;
            orphans: 2;
            widows: 2;
            margin-top: 1.5em;
            margin-bottom: 0.8em;
        }

        h1 {
            page-break-before: always;
            break-before: page;
            margin-top: 0;
            margin-bottom: 1.2em;
        }

        h2 {
            page-break-before: avoid;
            break-before: avoid;
            margin-top: 1.8em;
            margin-bottom: 1em;
        }

        p {
            orphans: 3;
            widows: 3;
            margin-bottom: 1em;
            text-align: justify;
            hyphens: auto;
            page-break-inside: auto;
            break-inside: auto;
        }

        ul,
        ol {
            orphans: 2;
            widows: 2;
            margin-bottom: 1em;
            page-break-inside: auto;
            break-inside: auto;
        }

        li {
            orphans: 1;
            widows: 1;
            margin-bottom: 0.3em;
            page-break-inside: avoid;
            break-inside: avoid;
        }

        blockquote {
            orphans: 2;
            widows: 2;
            margin: 1.2em 0;
            padding: 0.8em 1.2em;
            page-break-inside: avoid;
            break-inside: avoid;
            border-left: 4px solid #ccc;
        }

        pre {
            orphans: 1;
            widows: 1;
            margin: 1.2em 0;
            page-break-inside: avoid;
            break-inside: avoid;
            page-break-before: avoid;
            break-before: avoid;
            page-break-after: avoid;
            break-after: avoid;
        }

        code {
            word-break: break-word;
            overflow-wrap: break-word;
            hyphens: none;
        }

        table {
            orphans: 1;
            widows: 1;
            margin: 1.2em 0;
            page-break-inside: avoid;
            break-inside: avoid;
            page-break-before: avoid;
            break-before: avoid;
            page-break-after: avoid;
            break-after: avoid;
        }

        tr {
            page-break-inside: avoid;
            break-inside: avoid;
        }

        img {
            page-break-inside: avoid;
            break-inside: avoid;
            page-break-before: avoid;
            break-before: avoid;
            page-break-after: avoid;
            break-after: avoid;
            margin: 1em auto;
            display: block;
        }

        hr {
            page-break-after: avoid;
            break-after: avoid;
            page-break-before: avoid;
            break-before: avoid;
            margin: 2em auto;
            border: none;
            border-top: 1px solid #ccc;
            height: 0;
        }

        a,
        strong,
        b,
        em,
        i {
            word-break: break-word;
            overflow-wrap: break-word;
        }

        .markdown-body > * {
            page-break-inside: auto;
            break-inside: auto;
        }

        .markdown-body > *:not(h1):not(h2):not(pre):not(table):not(img) {
            page-break-after: auto;
            break-after: auto;
        }

        .markdown-body > h1:not(:first-child) {
            page-break-before: always;
            break-before: page;
            margin-top: 0;
        }

        .markdown-body > *:first-child {
            margin-top: 0;
        }

        .markdown-body > *:last-child {
            margin-bottom: 0;
        }
    }

    @media screen {
        :where(html, body):has(:where(#{$selectors}):not([hidden])) {
            height: 100vh;
            overflow: auto;
            inline-size: 100vw;
            margin: 0;
            padding: 0;
        }

        .print-view {
            min-height: 100vh;
            margin: 0;
            padding: 0;
            @include print-sizing;
        }

        .print-content {
            padding: 2rem;
            margin: 0;
            max-inline-size: none;
            line-height: 1.7;
            text-rendering: optimizeLegibility;
            @include print-sizing;
        }

        .markdown-body {
            font-family: var(--print-font-family-sans);
            @include print-sizing;

            h1,
            h2,
            h3,
            h4,
            h5,
            h6 {
                line-height: 1.2;
                margin-top: 2em;
                margin-bottom: 1em;
                break-inside: avoid;
                break-after: avoid;
            }

            h1 {
                margin-top: 0;
                font-size: 2.5em;
            }

            h2 {
                font-size: 2em;
            }

            h3 {
                font-size: 1.6em;
            }

            p {
                margin-bottom: 1.2em;
                line-height: 1.7;
                text-align: justify;
                hyphens: auto;
            }

            ul,
            ol {
                margin-bottom: 1.2em;
                padding-left: 2em;
            }

            li {
                margin-bottom: 0.5em;
                line-height: 1.6;
            }

            blockquote {
                margin: 1.5em 0;
                padding: 1em 1.5em;
                border-left: 4px solid #007acc;
                background: #f8f9fa;
                font-style: italic;
                font-family: var(--print-font-family-sans);
                break-inside: avoid;
            }

            pre {
                margin: 1.5em 0;
                padding: 1.2em;
                background: #f6f8fa;
                border-radius: 6px;
                overflow-x: auto;
                line-height: 1.4;
                break-inside: avoid;
            }

            code {
                background: #f1f3f4;
                padding: 0.2em 0.4em;
                border-radius: 3px;
                font-family: var(--print-font-mono);
                font-size: 0.9em;
            }

            pre code {
                font-family: var(--print-font-mono);
            }

            table {
                width: 100%;
                table-layout: auto;
                overflow-x: auto;
                display: block;
                max-inline-size: 100%;
                margin: 1.5em 0;
                border-collapse: collapse;
                break-inside: avoid;
                @include print-sizing;
            }

            th,
            td {
                padding: 0.75em;
                border: 1px solid #ddd;
                text-align: left;
            }

            th {
                background: #f8f9fa;
                font-weight: 600;
            }

            img {
                max-width: 100%;
                width: auto;
                height: auto;
                margin: 1.5em auto;
                display: block;
                break-inside: avoid;
            }

            a {
                color: #007acc;
                text-decoration: none;
                transition: color 0.2s ease;

                &:hover {
                    color: #0056b3;
                    text-decoration: underline;
                }
            }

            hr {
                margin: 2.5em auto;
                border: none;
                border-top: 1px solid #eee;
                break-before: avoid;
                break-after: avoid;
            }

            & > *:first-child {
                margin-top: 0;
            }

            & > *:last-child {
                margin-bottom: 0;
            }
        }
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --print-text-color: #f3f4f6;
            --print-bg: #111827;
            --print-border-color: #374151;
            --print-link-color: #60a5fa;
        }

        .markdown-body {
            code,
            pre {
                background: #1f2937;
                color: #f3f4f6;
            }

            th {
                background: #374151;
            }
        }
    }
}