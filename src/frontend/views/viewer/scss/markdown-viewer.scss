/* ai-refactor: optimized/refactored at 2026-02-13T02:51:13Z */
@use "./lib/mixins" as mixins;
@use "./lib/tokens" as tokens;
@use "./lib/config" as config;

@import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap");

@layer tokens, base, layout, utilities, shells, shell, views, view, viewer, components, ux-layer, markdown, essentials, print, print-breaks, overrides;

/* ===========================
   Meta / Mixins
   =========================== */
@mixin print-sizing {
    inline-size: 100%;
    box-sizing: border-box;
}

@mixin print-grayscale {
    filter: grayscale(100%);
}

@mixin print-font-smoothing($mode: auto) {
    @if $mode == never {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    } @else {
        -webkit-font-smoothing: auto;
        -moz-osx-font-smoothing: auto;
    }
}

@mixin print-page-break($before: auto, $after: auto, $inside: auto) {
    @if $before != auto {
        break-before: $before;
    }

    @if $after != auto {
        break-after: $after;
    }

    @if $inside != auto {
        break-inside: $inside;
    }
}

@mixin md-vars($mode: auto) {
    @if $mode == auto {
        --md-fg-default: #{config.md-light-dark("text")};
        --md-fg-muted: #{config.md-light-dark("text-muted")};
        --md-fg-accent: #{config.md-light-dark("accent")};
        --md-bg-default: #{config.md-light-dark("bg")};
        --md-bg-subtle: #{config.md-light-dark("bg-subtle")};
        --md-bg-code: #{config.md-light-dark("code-bg")};
        --md-border-default: #{config.md-light-dark("border")};
        --md-border-subtle: #{config.md-light-dark("border-subtle")};
    } @else {
        --md-fg-default: #{config.md-color("text", $mode)};
        --md-fg-muted: #{config.md-color("text-muted", $mode)};
        --md-fg-accent: #{config.md-color("accent", $mode)};
        --md-bg-default: #{config.md-color("bg", $mode)};
        --md-bg-subtle: #{config.md-color("bg-subtle", $mode)};
        --md-bg-code: #{config.md-color("code-bg", $mode)};
        --md-border-default: #{config.md-color("border", $mode)};
        --md-border-subtle: #{config.md-color("border-subtle", $mode)};
    }

    --md-font-body: #{config.md-config("font", "body")};
    --md-font-mono: #{config.md-config("font", "mono")};
    --md-radius: #{config.md-config("shape", "border-radius")};
}

/* ===========================
   Animations
   =========================== */
@keyframes spin {
    0% {
        transform: rotate(0deg);
    }

    100% {
        transform: rotate(360deg);
    }
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ===========================
   Tokens
   =========================== */
@layer tokens {
    :root,
    :host,
    :scope {
        --print-font-family: var(--font-family-serif, "Times New Roman", "Times", "Liberation Serif", "Noto Serif", serif);
        --print-font-family-sans: var(--font-family-sans, "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif);
        --print-font-mono: var(--font-family-mono, "Monaco", "Menlo", "Ubuntu Mono", "Liberation Mono", "Noto Mono", monospace);
        --print-text-color: #1a1a1a;
        --print-bg: #ffffff;
        --print-border-color: #d1d5db;
        --print-link-color: #2563eb;
    }

    @media (prefers-color-scheme: dark) {
        :root,
        :host,
        :scope {
            --print-text-color: #f3f4f6;
            --print-bg: #111827;
            --print-border-color: #374151;
            --print-link-color: #60a5fa;
        }
    }
}

/* ===========================
   Page
   =========================== */
@page {
    size: A4;
    margin: config("page", "margin");

    @bottom-center {
        content: counter(page);
        font-family: config("typography", "font-family", "sans");
        font-size: config("typography", "font-size", "base");
        line-height: tokens.$line-height-base;
    }

    @top-right {
        content: "UC";
        font-family: config("typography", "font-family", "sans");
        font-size: config("typography", "font-size", "base");
    }
}

@page :first {
    margin-top: 2cm;
    margin-bottom: 2.5cm;
    margin-left: 2cm;
    margin-right: 2cm;
}

@page :left {
    margin-right: 2cm;
    margin-left: 2cm;
}

@page :right {
    margin-left: 2cm;
    margin-right: 2cm;
}

@page narrow {
    size: A5 portrait;
    margin: 1.5cm 1.5cm 1.5cm 1.5cm;
}

@page wide {
    size: A4 landscape;
    margin: 2cm 2cm 2cm 2cm;
}

@page letter {
    size: letter portrait;
    margin: 2.5cm 2cm 2.5cm 2cm;
}

@page legal {
    size: legal portrait;
    margin: 2.5cm 2cm 2.5cm 2cm;
}

@page professional {
    size: A4 portrait;
    margin: 2.5cm 2cm 2.5cm 2cm;
    marks: crop cross;
    bleed: 0.25cm;
}

@page booklet {
    size: A5 portrait;
    margin: 1.5cm 1.5cm 1.5cm 1.5cm;
    marks: none;
    bleed: 0;
}

@page draft {
    size: A4 portrait;
    margin: 2cm 1.5cm 2cm 1.5cm;
    marks: none;
    bleed: 0;
}

/* ===========================
   Markdown
   =========================== */
@layer markdown {
    @include tokens.markdown-root-props();

    :where(body):has(:where(#{tokens.$selectors}):not([hidden])) {
        @include md-vars(auto);
        @include mixins.md-interactive-area();
        @include mixins.md-font-smoothing(always);

        margin: 0;
        background-color: transparent;
        color: var(--md-fg-default);
        word-wrap: break-word;
        color-scheme: inherit;
        -ms-text-size-adjust: 100%;
        -webkit-text-size-adjust: 100%;

        container-type: normal;
        contain: none;
        display: block;
        inline-size: 100%;
        block-size: fit-content;
        min-block-size: 100%;
        max-block-size: none;
        overflow: hidden;
        text-align: start;
    }

    :where(html, body):has(:where(#{tokens.$selectors}):not([hidden])) {
        @include print-sizing;

        &,
        * {
            box-sizing: border-box;
        }

        & {
            margin: 0;
            padding: 0;
            min-block-size: 100vh;

            background-color: transparent;
            inline-size: 100%;
            min-block-size: 100%;
            block-size: 100%;
            max-block-size: min(100dvb, 100cqb);
            display: block;
            flex-direction: column;
            content-visibility: visible;
            overflow: auto;
            container-type: inline-size;
            contain: none;
            touch-action: manipulation;
            pointer-events: auto;
            user-select: text;
            text-align: start;
        }
    }

    :where(#{tokens.$selectors}):not(.katex, .footnote-ref, .footnote-backref) {
        font-family: var(--md-font-body, var(--font-family-system));
        font-size: #{config.md-config("font", "size-base")};
        line-height: #{config.md-config("layout", "line-height")};
        font-weight: #{config.md-config("font", "weight-normal")};

        position: relative;
        display: flex;
        flex: 1;
        flex-direction: column;
        block-size: stretch;
        max-block-size: stretch;
        overflow: auto;
        padding: var(--space-2xl) var(--space-xl);
        background: var(--color-surface);
        color: var(--color-on-surface);
        font-size: var(--text-base, 16px);
        font-weight: var(--font-weight-normal);
        line-height: var(--leading-relaxed);
        box-shadow: var(--elev-1);
        transition: all var(--motion-normal);
        overflow-wrap: break-word;
        word-wrap: break-word;
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        scrollbar-width: thin;
        scrollbar-color: var(--color-outline-variant) transparent;

        touch-action: manipulation;
        pointer-events: auto;
        text-align: start;

        contain: inline-size layout paint style;

        @include mixins.md-surface-root(start);
        @include mixins.md-scrollbars();

        @container (max-width: 768px) {
            border-radius: var(--radius-lg);
            box-shadow: none;
        }

        &:hover {
            box-shadow: var(--elev-2);
        }

        &:focus-within {
            outline: none;
            box-shadow: var(--focus-ring), var(--elev-2);
        }

        &::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        &::-webkit-scrollbar-track {
            background: transparent;
        }

        &::-webkit-scrollbar-thumb {
            background: var(--color-outline-variant);
            border-radius: 4px;

            &:hover {
                background: var(--color-outline);
            }
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            margin: var(--space-2xl) 0 var(--space-lg);
            color: var(--color-on-surface);
            font-weight: var(--font-weight-semibold);
            line-height: var(--leading-tight);
            letter-spacing: -0.025em;

            &:first-child {
                margin-top: 0;
            }

            @container (max-width: 768px) {
                margin: var(--space-xl) 0 var(--space-md);
            }
        }

        h1 {
            font-size: var(--text-3xl);
        }

        h2 {
            font-size: var(--text-2xl);
        }

        h3 {
            font-size: var(--text-xl);
        }

        h4 {
            font-size: var(--text-lg);
        }

        h5 {
            font-size: var(--text-base);
        }

        h6 {
            font-size: var(--text-sm);
        }

        p {
            margin: 0 0 var(--space-lg);
            color: var(--color-on-surface);

            &:last-child {
                margin-bottom: 0;
            }
        }

        a {
            color: var(--color-primary);
            text-decoration: underline;
            text-decoration-thickness: 1px;
            text-underline-offset: 2px;
            transition: all var(--motion-fast);

            &:hover {
                color: var(--color-primary);
                text-decoration-thickness: 2px;
            }

            &:focus-visible {
                outline: none;
                border-radius: var(--radius-sm);
                box-shadow: var(--focus-ring);
            }
        }

        ul,
        ol {
            margin: var(--space-lg) 0;
            padding-left: var(--space-2xl);
            color: var(--color-on-surface);

            @container (max-width: 480px) {
                padding-left: var(--space-xl);
            }

            li {
                margin-bottom: var(--space-sm);

                &:last-child {
                    margin-bottom: 0;
                }
            }
        }

        blockquote {
            position: relative;
            margin: var(--space-xl) 0;
            padding: var(--space-lg) var(--space-xl);
            border-left: 4px solid var(--color-primary);
            border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
            background: var(--color-surface-container-low);
            color: var(--color-on-surface);
            font-style: italic;

            @container (max-width: 768px) {
                margin: var(--space-lg) 0;
                padding: var(--space-md) var(--space-lg);
            }

            &::before {
                content: '"';
                position: absolute;
                top: var(--space-sm);
                left: var(--space-sm);
                color: var(--color-primary);
                font-size: var(--text-2xl);
                opacity: 0.3;
            }
        }

        pre {
            margin: var(--space-xl) 0;
            padding: var(--space-lg);
            overflow-x: auto;
            border: none;
            border-radius: var(--radius-lg);
            background: var(--color-surface-container-high);
            color: var(--color-on-surface);
            font-family: var(--font-family-mono);
            font-size: var(--text-sm);
            line-height: var(--leading-normal);
            scrollbar-width: thin;
            scrollbar-color: var(--color-outline) transparent;

            @container (max-width: 768px) {
                margin: var(--space-lg) 0;
                padding: var(--space-md);
            }

            &::-webkit-scrollbar {
                height: 6px;
            }

            &::-webkit-scrollbar-thumb {
                background: var(--color-outline);
                border-radius: 3px;
            }

            code {
                padding: 0;
                border-radius: 0;
                background: none;
                color: inherit;
                font-family: inherit;
                font-size: inherit;
            }
        }

        code:not(pre code) {
            padding: 0.125rem 0.375rem;
            border: none;
            border-radius: var(--radius-sm);
            background: var(--color-surface-container-high);
            color: var(--color-on-surface);
            font-family: var(--font-family-mono);
            font-size: 0.875em;
            font-weight: var(--font-weight-medium);
        }

        table {
            display: table;
            inline-size: stretch;
            max-inline-size: stretch;
            margin: var(--space-xl) 0;
            border-collapse: collapse;
            border: 0.5px solid color-mix(in oklab, var(--print-border-color) 30%, transparent);
            border-radius: var(--radius-lg);
            font-size: var(--text-sm);
            contain: inline-size layout paint style;
            container-type: inline-size;
            block-size: max-content;
            max-block-size: max-content;
            overflow: hidden;

            @container (max-width: 768px) {
                margin: var(--space-lg) 0;
                font-size: var(--text-xs);
            }

            tr,
            thead,
            tbody,
            tfoot {
                inline-size: stretch;
                max-inline-size: stretch;
                block-size: max-content;
                max-block-size: max-content;
            }

            th,
            td {
                padding: var(--space-md) var(--space-lg);
                border-bottom: 0.5px solid color-mix(in oklab, var(--print-border-color) 30%, transparent);
                color: var(--color-on-surface);
                text-align: left;
                block-size: max-content;
                max-block-size: max-content;

                @container (max-width: 768px) {
                    padding: var(--space-sm) var(--space-md);
                }
            }

            th {
                background: var(--color-surface-container-high);
                color: var(--color-on-surface);
                font-weight: var(--font-weight-semibold);
            }

            tbody tr {
                &:hover {
                    background: var(--color-surface-container-low);
                }

                &:last-child td {
                    border-bottom: none;
                }
            }
        }

        hr {
            position: relative;
            margin: var(--space-2xl) 0;
            border: none;
            border-top: 0.5px solid color-mix(in oklab, var(--print-border-color) 30%, transparent);

            &::before {
                content: "";
                position: absolute;
                top: -1px;
                left: 50%;
                width: 60px;
                height: 1px;
                transform: translateX(-50%);
                background: var(--color-primary);
            }
        }

        img {
            max-width: 100%;
            height: auto;
            margin: var(--space-lg) 0;
            border-radius: var(--radius-md);
            box-shadow: var(--elev-1);

            @container (max-width: 768px) {
                margin: var(--space-md) 0;
            }
        }

        input[type="checkbox"] {
            margin-right: var(--space-sm);
            accent-color: var(--color-primary);
        }

        .katex {
            color: var(--color-on-surface);
            font-size: 1.1em;
        }

        .footnote-ref a {
            color: var(--color-primary);
            font-size: 0.8em;
            vertical-align: super;
        }

        dl {
            margin: var(--space-lg) 0;

            dt {
                margin-bottom: var(--space-xs);
                color: var(--color-on-surface);
                font-weight: var(--font-weight-semibold);
            }

            dd {
                margin: 0 0 var(--space-md) var(--space-xl);
                color: var(--color-on-surface-variant);
            }
        }

        math {
            math-style: compact;
            math-shift: compact;
            math-depth: auto-add;
            inline-size: fit-content;
            max-inline-size: stretch;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            margin-block-start: 1.5em;
            margin-block-end: 1rem;
            font-weight: 600;
            line-height: 1.25;
            color: var(--md-fg-default);

            &:first-child {
                margin-block-start: 0;
            }

            tt,
            code {
                font-size: inherit;
                font-family: var(--md-font-mono);
            }
        }

        h1 {
            font-size: 2em;
            padding-block-end: 0.3em;
            border-block-end: 1px solid var(--md-border-subtle);
        }

        h2 {
            font-size: 1.5em;
            padding-block-end: 0.3em;
            border-block-end: 1px solid var(--md-border-subtle);
        }

        h3 {
            font-size: 1.25em;
        }

        h4 {
            font-size: 1em;
        }

        h5 {
            font-size: 0.875em;
        }

        h6 {
            font-size: 0.85em;
            color: var(--md-fg-muted);
        }

        p {
            margin-block-start: 0;
            margin-block-end: 1rem;
        }

        blockquote {
            margin: 0 0 1rem;
            padding: 0 1em;
            color: var(--md-fg-muted);
            border-inline-start: 0.25em solid var(--md-border-default);

            > :first-child {
                margin-block-start: 0;
            }

            > :last-child {
                margin-block-end: 0;
            }
        }

        a {
            color: var(--md-fg-accent);
            text-decoration: none;
            background-color: transparent;

            &:hover {
                text-decoration: underline;
            }

            &:not([href]) {
                color: inherit;
                text-decoration: none;
            }
        }

        ul,
        ol {
            margin-block-start: 0;
            margin-block-end: 1rem;
            padding-inline-start: 2em;

            ol,
            ul {
                margin-block-end: 0;
            }
        }

        li {
            word-break: normal;
            overflow-wrap: break-word;
            word-wrap: break-word;

            > p {
                margin-block-start: 1rem;
            }

            & + li {
                margin-block-start: 0.25em;
            }
        }

        ol {
            list-style-type: decimal;

            &[type="a"] {
                list-style-type: lower-alpha;
            }

            &[type="A"] {
                list-style-type: upper-alpha;
            }

            &[type="i"] {
                list-style-type: lower-roman;
            }

            &[type="I"] {
                list-style-type: upper-roman;
            }

            &[type="1"] {
                list-style-type: decimal;
            }
        }

        ul {
            list-style-type: disc;

            ul {
                list-style-type: circle;
            }

            ul ul {
                list-style-type: square;
            }
        }

        dl {
            padding: 0;

            dt {
                padding: 0;
                margin-block-start: 1rem;
                font-size: 1em;
                font-style: italic;
                font-weight: 600;
            }

            dd {
                padding: 0 1rem;
                margin-block-end: 1rem;
                margin-inline-start: 0;
            }
        }

        table {
            display: table;
            overflow: auto;
            margin-block-end: 1rem;
            border-spacing: 0;
            border-collapse: collapse;
            min-inline-size: 0;
            inline-size: fit-content;
            max-inline-size: stretch;
            contain: inline-size layout paint style;
            container-type: inline-size;

            tbody,
            thead {
                inline-size: fit-content;
                max-inline-size: stretch;
            }

            th,
            td {
                padding: 6px 13px;
                border: 1px solid var(--md-border-default);
                inline-size: fit-content;
                max-inline-size: stretch;
            }

            th {
                font-weight: 600;
                background-color: var(--md-bg-subtle);
            }

            tr {
                background-color: var(--md-bg-default);
                border-block-start: 1px solid var(--md-border-subtle);

                &:nth-child(2n) {
                    background-color: var(--md-bg-subtle);
                }
            }

            img {
                background-color: transparent;
            }
        }

        code,
        kbd,
        pre,
        samp,
        tt {
            font-family: var(--md-font-mono);
            font-size: 1em;
        }

        code,
        tt,
        samp {
            padding: 0.2em 0.4em;
            margin: 0;
            font-size: 85%;
            background-color: var(--md-bg-code);
            border-radius: 6px;
        }

        pre {
            margin-block: 0 1rem;
            padding: 1rem;
            overflow: auto;
            font-size: 85%;
            line-height: 1.45;
            background-color: var(--md-bg-code);
            border-radius: 6px;

            code,
            tt {
                display: inline;
                padding: 0;
                margin: 0;
                overflow: visible;
                line-height: inherit;
                word-wrap: normal;
                white-space: pre;
                background-color: transparent;
                border: 0;
                font-size: 100%;
            }
        }

        span {
            inline-size: fit-content;
            max-inline-size: stretch;
        }

        svg {
            width: fit-content !important;
            inline-size: fit-content !important;
            max-inline-size: stretch !important;
            contain: strict;
        }

        .footnotes {
            margin-block-start: 2rem;
            font-size: 0.75em;
            color: var(--md-fg-muted);
            border-block-start: 1px solid var(--md-border-default);

            ol {
                padding-inline-start: 1.5em;
            }

            li {
                position: relative;

                &:target {
                    color: var(--md-fg-default);
                }

                &:target::before {
                    position: absolute;
                    inset: -8px -8px -8px -24px;
                    border: 2px solid var(--md-fg-accent);
                    border-radius: 6px;
                    content: "";
                    pointer-events: none;
                }
            }
        }

        .markdown-alert {
            margin-block-end: 1rem;
            padding: 0.5rem 1rem;
            color: inherit;
            border-inline-start: 0.25em solid var(--md-border-default);

            &.markdown-alert-note {
                border-color: var(--md-fg-accent);
            }

            &.markdown-alert-important {
                border-color: #8250df;
            }

            &.markdown-alert-warning {
                border-color: #bf8700;
            }

            &.markdown-alert-tip {
                border-color: #1a7f37;
            }

            &.markdown-alert-caution {
                border-color: #d1242f;
            }

            .markdown-alert-title {
                display: flex;
                align-items: center;
                margin-block-end: 0.5rem;
                font-weight: 600;
                line-height: 1;

                .octicon {
                    margin-inline-end: 0.5rem;
                }
            }
        }

        .octicon {
            display: inline-block;
            fill: currentColor;
            vertical-align: text-bottom;
        }

        g-emoji {
            display: inline-block;
            min-inline-size: 1ch;
            font-family: "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            font-size: 1em;
            font-style: normal;
            font-weight: 400;
            line-height: 1;
            vertical-align: -0.075em;

            img {
                inline-size: 1em;
                block-size: 1em;
            }
        }

        .anchor {
            float: inline-start;
            padding-inline-end: 4px;
            margin-inline-start: -20px;
            line-height: 1;

            &:focus {
                outline: none;
            }
        }

        .octicon-link {
            visibility: hidden;
            color: var(--md-fg-muted);
            opacity: 0.5;

            &:hover {
                opacity: 1;
            }
        }

        h1:hover .anchor .octicon-link,
        h2:hover .anchor .octicon-link,
        h3:hover .anchor .octicon-link,
        h4:hover .anchor .octicon-link,
        h5:hover .anchor .octicon-link,
        h6:hover .anchor .octicon-link {
            visibility: visible;
        }

        hr {
            box-sizing: content-box;
            overflow: hidden;
            margin: 24px 0;
            block-size: 0.25em;
            padding: 0;
            border: 0;
            background-color: var(--md-border-default);

            &::before {
                display: table;
                content: "";
            }

            &::after {
                display: table;
                clear: both;
                content: "";
            }
        }

        img {
            max-inline-size: 100%;
            box-sizing: content-box;
            background-color: transparent;
            border-style: none;

            &[align="right"] {
                padding-inline-start: 20px;
            }

            &[align="left"] {
                padding-inline-end: 20px;
            }
        }

        kbd {
            display: inline-block;
            padding: 3px 5px;
            font-size: 11px;
            line-height: 10px;
            color: var(--md-fg-default);
            vertical-align: middle;
            background-color: var(--md-bg-subtle);
            border: 1px solid var(--md-border-default);
            border-radius: 6px;
            box-shadow: inset 0 -1px 0 var(--md-border-default);
        }

        details {
            display: block;

            summary {
                display: list-item;
                cursor: pointer;

                h1,
                h2,
                h3,
                h4,
                h5,
                h6 {
                    display: inline-block;
                    vertical-align: middle;
                    margin: 0;
                    padding-block-end: 0;
                    border-block-end: 0;
                }
            }
        }

        .task-list-item {
            list-style-type: none;

            input[type="checkbox"] {
                margin: 0 0.2em 0.25em -1.6em;
                vertical-align: middle;
            }
        }

        .pl-c {
            color: #6e7781;
        }

        .pl-c1 {
            color: #0550ae;
        }

        .pl-k {
            color: #cf222e;
        }

        .pl-s {
            color: #0a3069;
        }

        .pl-v {
            color: #953800;
        }

        .pl-en {
            color: #8250df;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            margin-top: 1.5em;
            margin-bottom: 0.5em;
            line-height: 1.2;
        }

        h1 {
            font-size: 2rem;
            border-bottom: 0.5px solid color-mix(in oklab, var(--print-border-color) 30%, transparent);
            padding-bottom: 0.5rem;
        }

        h2 {
            font-size: 1.5rem;
            border-bottom: 0.5px solid color-mix(in oklab, var(--print-border-color) 30%, transparent);
            padding-bottom: 0.25rem;
        }

        h3 {
            font-size: 1.25rem;
        }

        h4 {
            font-size: 1.125rem;
        }

        h5 {
            font-size: 1rem;
        }

        h6 {
            font-size: 0.875rem;
        }

        p,
        ul,
        ol,
        blockquote {
            margin-bottom: 1rem;
            orphans: 3;
            widows: 3;
            text-align: justify;
            hyphens: auto;
        }

        ul,
        ol {
            padding-left: 1.5rem;
        }

        li {
            margin-bottom: 0.25rem;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        code {
            background: #f3f4f6;
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-family: var(--print-font-mono);
            font-size: 0.875em;
            word-wrap: break-word;
            overflow-wrap: break-word;
            max-inline-size: 100%;
        }

        pre {
            @include print-sizing;

            background: #f3f4f6;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin: 1rem 0;
            word-wrap: break-word;
            overflow-wrap: break-word;

            code {
                background: none;
                padding: 0;
                border-radius: 0;
                white-space: pre-wrap;
                word-wrap: break-word;
                overflow-wrap: break-word;
            }
        }

        blockquote {
            border-left: 4px solid var(--print-border-color);
            padding-left: 1rem;
            color: #6b7280;
            font-style: italic;
            margin: 1rem 0;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        table {
            @include print-sizing;

            display: table;
            inline-size: stretch;
            max-inline-size: stretch;
            border-collapse: collapse;
            margin: 1rem 0;
            table-layout: fixed;
            word-wrap: break-word;
            overflow-wrap: break-word;

            contain: inline-size layout paint style;
            container-type: inline-size;
        }

        th,
        td {
            border: 1px solid var(--print-border-color);
            padding: 0.5rem;
            text-align: left;
            vertical-align: top;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        th {
            background: #f9fafb;
            font-weight: 600;
        }

        hr {
            @include print-sizing;

            border: none;
            border-top: 1px solid var(--print-border-color);
            margin: 2rem 0;
        }

        img {
            max-width: 100%;
            max-inline-size: 100%;
            height: auto;
            display: block;
        }

        a {
            color: var(--print-link-color);
            text-decoration: underline;
            word-wrap: break-word;
            overflow-wrap: break-word;
            max-inline-size: 100%;
        }

        strong,
        b {
            font-weight: 600;
        }

        em,
        i {
            font-style: italic;
        }

        div,
        section,
        article,
        aside,
        header,
        footer,
        main,
        nav {
            @include print-sizing;
        }

        * {
            max-inline-size: 100%;
            @include print-sizing;
        }
    }

    .print-view {
        max-width: none;
        min-height: 100vh;
        padding: 0;
        margin: 0;
        inline-size: 100vw;
        block-size: 100vh;
        overflow-x: hidden;
    }

    .print-content {
        @include print-sizing;

        padding: 2rem;
        margin: 0;
        min-height: 100vh;
        font-size: 14px;
        line-height: 1.6;
        text-align: justify;
        hyphens: auto;
        word-wrap: break-word;
        overflow-wrap: break-word;
    }

    .markdown-viewer-content {
        animation: fadeIn 0.3s ease-out;
    }

    .markdown-viewer-raw {
        margin: 0;
        padding: var(--space-xl);
        overflow: auto;
        background: var(--color-surface);
        color: var(--color-on-surface);
        font-family: var(--font-family-mono);
        font-size: var(--text-sm);
        line-height: var(--leading-normal);
        white-space: pre;
        tab-size: 2;
    }

    .viewer-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-shrink: 0;
        gap: var(--space-lg);
        padding: var(--space-lg) var(--space-xl);
        background: var(--color-surface-container-high);

        @container (max-width: 768px) {
            gap: var(--space-md);
            padding: var(--space-md) var(--space-lg);
        }

        @container (max-width: 480px) {
            flex-direction: column;
            align-items: stretch;
            gap: var(--space-sm);
        }

        h3 {
            margin: 0;
            color: var(--color-on-surface);
            font-size: var(--text-xl);
            font-weight: var(--font-weight-semibold);
            line-height: var(--leading-tight);
            letter-spacing: -0.025em;

            @container (max-width: 768px) {
                font-size: var(--text-lg);
            }
        }

        .viewer-actions {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            flex-wrap: wrap;

            @container (max-width: 640px) {
                gap: var(--space-xs);
            }

            @container (max-width: 480px) {
                justify-content: center;
                gap: var(--space-sm);
            }

            @container (max-width: 360px) {
                overflow-x: auto;
                overflow-y: hidden;
                padding-bottom: var(--space-xs);
                flex-wrap: nowrap;
                scrollbar-width: none;
                -webkit-overflow-scrolling: touch;

                &::-webkit-scrollbar {
                    display: none;
                }
            }
        }
    }

    .viewer-actions .viewer-btn {
        position: relative;
        display: inline-flex;
        align-items: center;
        gap: var(--space-xs);
        min-block-size: 44px;
        padding: var(--space-sm) var(--space-lg);
        border: none;
        border-radius: var(--radius-lg);
        background: var(--color-surface-container);
        color: var(--color-on-surface);
        font-size: var(--text-sm);
        font-weight: var(--font-weight-medium);
        white-space: nowrap;
        cursor: pointer;
        transition: all var(--motion-fast);

        @container (max-width: 640px) {
            min-block-size: 40px;
            padding: var(--space-xs) var(--space-md);
            font-size: var(--text-xs);
        }

        @container (max-width: 480px) {
            min-block-size: 44px;
            padding: var(--space-sm) var(--space-md);
        }

        &:hover {
            background: var(--color-surface-container-highest);
            transform: translateY(-1px);
            box-shadow: var(--elev-1);
        }

        &:active {
            transform: translateY(0);
            box-shadow: none;
        }

        &:focus-visible {
            outline: none;
            box-shadow: var(--focus-ring);
        }

        &.btn-icon {
            padding: var(--space-sm);

            @container (max-width: 640px) {
                padding: var(--space-xs);
            }

            ui-icon {
                flex-shrink: 0;
                transition: color var(--motion-fast);
            }

            .btn-text {
                @container (max-width: 640px) {
                    display: none;
                }
            }

            &:hover ui-icon {
                color: var(--color-primary);
            }
        }

        &.loading {
            opacity: 0.7;
            pointer-events: none;

            &::after {
                content: "";
                width: 16px;
                height: 16px;
                margin-left: var(--space-xs);
                border: 2px solid transparent;
                border-top: 2px solid currentColor;
                border-radius: 50%;
                animation: spin 1s linear infinite;
            }
        }

        @container (max-width: 1024px) {
            padding: var(--space-xl) var(--space-lg);
        }

        @container (max-width: 768px) {
            padding: var(--space-lg) var(--space-md);
        }

        @container (max-width: 480px) {
            padding: var(--space-md) var(--space-sm);
        }

        &::selection {
            background: color-mix(in oklab, var(--color-primary) 20%, transparent);
            color: var(--color-on-primary);
        }
    }

    @media (prefers-color-scheme: dark) {
        .pl-c {
            color: #8b949e;
        }

        .pl-c1 {
            color: #79c0ff;
        }

        .pl-k {
            color: #ff7b72;
        }

        .pl-s {
            color: #a5d6ff;
        }

        .pl-v {
            color: #ffa657;
        }

        .pl-en {
            color: #d2a8ff;
        }
    }

    @media screen {
        :where(html, body):has(:where(#{tokens.$selectors}):not([hidden])) {
            block-size: 100vh;
            overflow: auto;
            inline-size: 100vw;
            margin: 0;
            padding: 0;
        }

        .print-view {
            min-block-size: 100vh;
            margin: 0;
            padding: 0;
            @include print-sizing;
        }

        .print-content {
            padding: 2rem;
            margin: 0;
            max-inline-size: none;
            line-height: 1.7;
            text-rendering: optimizeLegibility;
            @include print-sizing;
        }

        :where(#{tokens.$selectors}):not(.katex, .footnote-ref, .footnote-backref) {
            font-family: var(--print-font-family-sans);
            @include print-sizing;

            h1,
            h2,
            h3,
            h4,
            h5,
            h6 {
                margin-block-start: 1.5em;
                margin-block-end: 0.5em;
                font-weight: 600;
                line-height: 1.25;

                &:first-child {
                    margin-block-start: 0;
                }
            }

            h1 {
                font-size: 2rem;
            }

            h2 {
                font-size: 1.5rem;
                border-block-end: 1px solid var(--view-border);
                padding-block-end: 0.3em;
            }

            h3 {
                font-size: 1.25rem;
            }

            h4 {
                font-size: 1rem;
            }

            p {
                margin-block: 1em;
                line-height: 1.6;
            }

            ul,
            ol {
                margin-block: 1em;
                padding-inline-start: 2em;

                & > li {
                    margin-block: 0.25em;
                }
            }

            code {
                font-family: "SF Mono", "Fira Code", "JetBrains Mono", monospace;
                font-size: 0.875em;
                padding: 0.2em 0.4em;
                background-color: light-dark(rgba(0, 0, 0, 0.05), rgba(255, 255, 255, 0.08));
                border-radius: 4px;
            }

            pre {
                margin-block: 1em;
                padding: 1rem;
                background-color: light-dark(rgba(0, 0, 0, 0.03), rgba(255, 255, 255, 0.05));
                border-radius: 8px;
                overflow-x: auto;

                code {
                    padding: 0;
                    background: none;
                }
            }

            blockquote {
                margin-block: 1em;
                margin-inline: 0;
                padding-inline-start: 1rem;
                border-inline-start: 4px solid rgba(0, 122, 204, 0.4);
                color: var(--view-fg);
                opacity: 0.8;
                font-style: italic;
            }

            table {
                display: table;
                inline-size: stretch;
                max-inline-size: stretch;
                border-collapse: collapse;
                margin-block: 1em;

                contain: inline-size layout paint style;
                container-type: inline-size;

                th,
                td {
                    padding: 0.5rem 0.75rem;
                    border: 1px solid var(--view-border);
                    text-align: start;
                }

                th {
                    background-color: light-dark(rgba(0, 0, 0, 0.03), rgba(255, 255, 255, 0.05));
                    font-weight: 600;
                }

                tr:nth-child(even) {
                    background-color: light-dark(rgba(0, 0, 0, 0.02), rgba(255, 255, 255, 0.02));
                }
            }

            a {
                color: var(--view-link-color);
                text-decoration: none;

                &:hover {
                    text-decoration: underline;
                    color: var(--view-link-hover);
                }
            }

            img {
                max-inline-size: 100%;
                block-size: auto;
                border-radius: 8px;
            }

            hr {
                margin-block: 2em;
                border: none;
                border-block-start: 1px solid var(--view-border);
            }

            h1,
            h2,
            h3,
            h4,
            h5,
            h6 {
                line-height: 1.2;
                margin-block-start: 1em;
                margin-block-end: 0.5em;
            }

            h1 {
                margin-block-start: 0;
                font-size: 2.5em;
            }

            h2 {
                font-size: 2em;
            }

            h3 {
                font-size: 1.6em;
            }

            p {
                margin-block-end: 1.2em;
                line-height: 1.7;
                text-align: justify;
                hyphens: auto;
            }

            ul,
            ol {
                margin-block-end: 1.2em;
                padding-inline-start: 2em;
            }

            li {
                margin-block-end: 0.5em;
                line-height: 1.6;
            }

            blockquote {
                margin-block: 1.5em;
                padding: 1em 1.5em;
                border-inline-start: 4px solid var(--view-blockquote-border);
                background: var(--view-blockquote-bg);
                color: var(--view-fg);
                font-style: italic;
                font-family: var(--print-font-family-sans);
            }

            pre {
                margin-block: 1.5em;
                padding: 1.2em;
                background: #f6f8fa;
                border-radius: 6px;
                overflow-x: auto;
                line-height: 1.4;
            }

            code {
                background: #f1f3f4;
                padding: 0.2em 0.4em;
                border-radius: 3px;
                font-family: var(--print-font-mono);
                font-size: 0.9em;
            }

            pre code {
                font-family: var(--print-font-mono);
            }

            table {
                display: table;
                inline-size: stretch;
                max-inline-size: stretch;
                table-layout: auto;
                overflow: hidden;
                margin: 1.5em 0;
                border-collapse: collapse;
                block-size: max-content;
                max-block-size: max-content;

                contain: inline-size layout paint style;
                container-type: inline-size;
                @include print-sizing;
            }

            th,
            td {
                padding: 0.75em;
                border: 1px solid #ddd;
                text-align: start;
            }

            th {
                background-color: #f8f9fa;
                font-weight: 600;
            }

            img {
                max-inline-size: 100%;
                inline-size: auto;
                block-size: auto;
                margin-block: 1.5em;
                margin-inline: auto;
                display: block;
            }

            a {
                color: #007acc;
                text-decoration: none;
                transition: color 0.2s ease;

                &:hover {
                    color: #0056b3;
                    text-decoration: underline;
                }
            }

            hr {
                margin-block: 2.5em;
                margin-inline: auto;
                border: none;
                border-block-start: 1px solid #eee;
            }

            & > *:first-child {
                margin-block-start: 0;
            }

            & > *:last-child {
                margin-block-end: 0;
            }
        }
    }

    @media print {

        :where(:root, html) {
            container-type: normal;
            contain: none;
        }

        :where(body, html, :root) {
            background-color: initial !important;
            font-family: var(--print-font-family);
            color: initial;
            font-variant-emoji: text;
            margin: 0;
            padding: 0;
            border: none;
        }

        :where(html, body):has(:where(#{tokens.$selectors}):not([hidden])) {
            @include print-sizing;

            font-variant-emoji: text;
            font-family: var(--print-font-family);
            font-size: 12pt;
            line-height: 1.4;
            color: black;
            -webkit-print-color-adjust: economy;
            print-color-adjust: economy;
            scrollbar-width: none;
            -ms-overflow-style: none;
            margin: 0;
            padding: 0;
            border: none;
            box-shadow: none;
            background: #fff;

            &::-webkit-scrollbar {
                display: none;
            }
        }

        body {
            block-size: max-content !important;
            max-block-size: max-content !important;
            contain: none;
            container-type: normal;
            background-color: #fff !important;
            overflow: visible !important;
            scrollbar-width: none;
            -ms-overflow-style: none;
            text-align: center;
            @include print-sizing;
            inline-size: auto !important;
            max-inline-size: 100% !important;
            zoom: 1 !important;
            scale: 1 !important;
            transform: none !important;
        }

        .katex,
        .katex * {
            font-variant: normal !important;
            font-variant-caps: normal !important;
            font-variant-ligatures: normal !important;
            text-transform: none !important;
            font-style: oblique 5deg;
        }
    
        .katex .mathnormal,
        .katex .mathit {
            font-style: oblique 5deg !important;
        }

        :where(#{tokens.$selectors}):not(.katex, .footnote-ref, .footnote-backref) {
            line-height: var(--leading-relaxed);
            color: #111 !important;
            background: #fff !important;
            font-family: var(--print-font-family);
            font-variant-emoji: text;
            display: block !important;
            flex: none !important;
            block-size: auto !important;
            min-block-size: 0 !important;
            max-block-size: none !important;
            contain: none;
            container-type: normal;
            overflow: visible !important;
            scrollbar-width: none;
            -ms-overflow-style: none;
            margin: 0;
            padding: 0;
            border: none;

            @include md-vars(light);

            * {
                border-color: transparent;
                background-color: transparent !important;
                box-shadow: none !important;
                font-variant-emoji: text;
            }

            :heading,
            :where(h1, h2, h3, h4, h5, h6),
            span,
            a,
            p {
                font-family: var(--print-font-family);
                font-variant-emoji: text;
            }

            code,
            pre {
                background: #f5f5f5;
                color: #111;
            }

            th {
                background: #f3f4f6;
            }

            h3 {
                color: var(--color-on-surface);
            }

            .btn,
            .viewer-btn {
                background: var(--color-surface-container-low);
                border-color: var(--color-outline);
                color: var(--color-on-surface);
                display: none !important;

                &:hover {
                    background: var(--color-surface-container);
                    border-color: var(--color-primary);
                }
            }

            h1,
            h2,
            h3,
            h4,
            h5,
            h6 {
                margin: var(--space-lg) 0 var(--space-md) 0;
                font-weight: var(--font-weight-bold);
                line-height: var(--leading-tight);
                color: var(--color-on-surface);

                &:first-child {
                    margin-top: 0;
                }
            }

            h1 {
                font-size: var(--text-3xl);
            }

            h2 {
                font-size: var(--text-2xl);
            }

            h3 {
                font-size: var(--text-xl);
            }

            h4 {
                font-size: var(--text-lg);
            }

            h5 {
                font-size: var(--text-base);
            }

            h6 {
                font-size: var(--text-sm);
            }

            p {
                margin: var(--space-md) 0;

                &:first-child {
                    margin-top: 0;
                }

                &:last-child {
                    margin-bottom: 0;
                }
            }

            ul,
            ol {
                margin: var(--space-md) 0;
                padding-inline-start: var(--space-xl);

                li {
                    margin: var(--space-xs) 0;
                    line-height: var(--leading-relaxed);

                    p {
                        margin: var(--space-xs) 0;
                    }
                }
            }

            a {
                color: var(--color-primary);
                text-decoration: underline;
                text-underline-offset: 0.1em;

                &:hover {
                    color: color-mix(in oklab, var(--color-primary) 85%, black);
                    text-decoration-thickness: 2px;
                }

                &:focus-visible {
                    outline: 2px solid var(--color-primary);
                    outline-offset: 2px;
                    border-radius: var(--radius-sm);
                }
            }

            pre {
                margin: var(--space-lg) 0;
                padding: var(--space-lg);
                overflow-x: auto;
                font-family: var(--font-family-mono);
                font-size: var(--text-sm);
                line-height: var(--leading-normal);
                color: var(--color-on-surface);
                background: var(--color-surface-container);
                border-radius: var(--radius-md);
                border: none;

                code {
                    background: transparent;
                    padding: 0;
                    font-size: inherit;
                    color: inherit;
                    border: none;
                }
            }

            code {
                padding: 0.125rem 0.25rem;
                font-family: var(--font-family-mono);
                font-size: 0.9em;
                font-weight: var(--font-weight-medium);
                color: var(--color-on-surface-variant);
                background: var(--color-surface-container-high);
                border-radius: var(--radius-sm);
                border: none;
            }

            blockquote {
                margin: var(--space-lg) 0;
                padding: var(--space-md) var(--space-lg);
                border-inline-start: 4px solid var(--color-primary);
                background: color-mix(in oklab, var(--color-primary) 5%, var(--color-surface-container));
                border-radius: 0 var(--radius-md) var(--radius-md) 0;
                font-style: italic;
                color: var(--color-on-surface-variant);

                p {
                    margin: 0;
                }
            }

            table {
                display: table;
                inline-size: stretch;
                max-inline-size: stretch;
                margin: var(--space-lg) 0;
                border-collapse: collapse;
                background: var(--color-surface-container);
                border-radius: var(--radius-md);
                overflow: hidden;

                contain: inline-size layout paint style;
                container-type: inline-size;

                th,
                td {
                    padding: var(--space-sm) var(--space-md);
                    text-align: start;
                    border-bottom: 0.5px solid color-mix(in oklab, var(--print-border-color) 30%, transparent);
                }

                th {
                    background: var(--color-surface-container-high);
                    font-weight: var(--font-weight-semibold);
                    color: var(--color-on-surface);
                }

                tbody tr:last-child td {
                    border-bottom: none;
                }

                tbody tr:hover {
                    background: color-mix(in oklab, var(--color-surface-container) 95%, var(--color-primary) 5%);
                }
            }

            hr {
                margin: var(--space-xl) 0;
                border: none;
                border-top: 0.5px solid color-mix(in oklab, var(--print-border-color) 30%, transparent);
            }

            strong,
            b {
                font-weight: var(--font-weight-bold);
                color: var(--color-on-surface);
            }

            em,
            i {
                font-style: italic;
                color: var(--color-on-surface-variant);
            }

            @container (max-width: 768px) {
                h1 {
                    font-size: var(--text-2xl);
                }

                h2 {
                    font-size: var(--text-xl);
                }

                h3 {
                    font-size: var(--text-lg);
                }

                pre {
                    padding: var(--space-md);
                    font-size: var(--text-xs);
                }

                code {
                    font-size: 0.85em;
                }
            }

            .viewer-header {
                display: none;
            }

            h1,
            h2,
            h3,
            h4,
            h5,
            h6 {
                color: black;
            }

            p,
            li {
                color: black;
                orphans: 3;
                widows: 3;
            }

            blockquote {
                background: #f9f9f9;
                border-left-color: #666;
                color: black;
            }

            pre {
                background: #f5f5f5;
                border: 1px solid #ccc;
                color: black;
            }

            code:not(pre code) {
                background: #f0f0f0;
                border: 1px solid #ddd;
                color: black;
            }

            table {
                display: table;
                inline-size: stretch;
                max-inline-size: stretch;
                border: 1px solid #666;

                contain: inline-size layout paint style;
                container-type: inline-size;
                border-radius: 0.5rem;

                th,
                td {
                    border: 1px solid #666;
                    color: black;
                }

                th {
                    background: #f0f0f0;
                }
            }

            hr {
                border-color: #666;
            }

            img {
                max-width: 100%;
            }

            a {
                color: black;
                text-decoration: underline;
            }

            .katex {
                color: black;
            }

            &[data-raw] {
                .viewer-content {
                    background: var(--color-surface);
                }
            }

            .print-view,
            .print-content {
                margin: 0;
                padding: 0;
                @include print-sizing;
            }

            *,
            *::before,
            *::after {
                max-inline-size: 100%;
                @include print-sizing;
            }

            code,
            pre,
            pre code {
                font-family: var(--print-font-mono);
            }

            table {
                width: 100% !important;
                table-layout: fixed;
            }

            img {
                max-width: 100% !important;
                height: auto !important;
            }

            pre {
                overflow-x: auto;
                white-space: pre-wrap;
                word-wrap: break-word;
            }

            h1,
            h2,
            h3,
            h4,
            h5,
            h6 {
                color: black !important;
                @include print-font-smoothing(never);
            }

            p,
            li,
            blockquote {
                color: black !important;
                @include print-grayscale;
                @include print-font-smoothing(never);
            }

            a {
                color: #333 !important;
                text-decoration: underline !important;
                @include print-grayscale;
                @include print-font-smoothing(never);
            }

            code,
            pre {
                background: #f5f5f5 !important;
                color: #333 !important;
                @include print-grayscale;
                @include print-font-smoothing(never);
            }

            table {
                border-color: #666 !important;
                @include print-grayscale;
            }

            th,
            td {
                border-color: #999 !important;
                @include print-grayscale;
            }

            th {
                background: #e5e5e5 !important;
                color: #333 !important;
                @include print-grayscale;
            }

            blockquote {
                background: #fafafa !important;
                border-left-color: #666 !important;
                @include print-grayscale;
            }

            hr {
                border-color: #999 !important;
                @include print-grayscale;
            }

            img {
                @include print-grayscale;
                image-rendering: -webkit-optimize-contrast;
                image-rendering: optimize-contrast;
            }

            *,
            *::before,
            *::after {
                color: inherit !important;
                @include print-font-smoothing(never);
                text-shadow: none !important;
                font-variant-emoji: text !important;
            }

            strong,
            b {
                font-weight: bold !important;
                color: black !important;
                filter: none;
            }

            em,
            i {
                font-style: italic !important;
                color: black !important;
                filter: none;
            }

            ul,
            ol {
                list-style-position: outside;
            }

            li::marker {
                color: #666 !important;
            }

            pre[class*="language-"] {
                background: #f8f8f8 !important;
                @include print-grayscale;
            }

            pre[class*="language-"] * {
                @include print-grayscale;
            }

            .katex {
                @include print-grayscale;
                color: black !important;
            }

            svg {
                @include print-grayscale;
            }

            svg * {
                fill: currentColor !important;
                stroke: currentColor !important;
            }

            input,
            textarea,
            select {
                border: 1px solid #999 !important;
                background: white !important;
                color: black !important;
                @include print-grayscale;
            }

            .highlight,
            .mark {
                background: #e6e6e6 !important;
                @include print-grayscale;
            }

            .footnote,
            .reference {
                border-top: 1px solid #ccc !important;
                background: transparent !important;
                @include print-grayscale;
            }

            a[href]::after {
                content: none !important;
            }

            h1,
            h2,
            h3,
            h4,
            h5,
            h6 {
                orphans: 2;
                widows: 2;
                margin-top: 1.5em;
                margin-bottom: 0.8em;
            }

            h1:not(:first-of-type) {
                margin-top: 0;
                margin-bottom: 1.2em;
            }

            h2:not(:first-of-type) {
                margin-top: 1.8em;
                margin-bottom: 1em;
            }

            p {
                orphans: 3;
                widows: 3;
                margin-bottom: 1em;
                text-align: justify;
                hyphens: auto;
            }

            ul,
            ol {
                orphans: 2;
                widows: 2;
                margin-bottom: 1em;
            }

            li {
                orphans: 1;
                widows: 1;
                margin-bottom: 0.3em;
            }

            blockquote {
                orphans: 2;
                widows: 2;
                margin: 1.2em 0;
                padding: 0.8em 1.2em;
                border-left: 4px solid #ccc;
            }

            pre {
                orphans: 1;
                widows: 1;
                margin: 1.2em 0;
            }

            code {
                word-break: break-word;
                overflow-wrap: break-word;
                hyphens: none;
            }

            table {
                orphans: 1;
                widows: 1;
                margin: 1.2em 0;
            }

            img {
                margin: 1em auto;
                display: block;
            }

            hr {
                margin: 2em auto;
                border: none;
                border-top: 1px solid #ccc;
                height: 0;
            }

            a,
            strong,
            b,
            em,
            i {
                word-break: break-word;
                overflow-wrap: break-word;
            }

            & > h1:not(:first-of-type) {
                margin-top: 0;
            }

            & > *:first-child {
                margin-top: 0;
            }

            & > *:last-child {
                margin-bottom: 0;
            }

            .print-narrow {
                page: narrow;
            }

            .print-wide {
                page: wide;
            }

            .print-letter {
                page: letter;
            }

            .print-legal {
                page: legal;
            }

            .print-professional {
                page: professional;
            }

            .print-booklet {
                page: booklet;
            }

            .print-draft {
                page: draft;
            }

            pre,
            code {
                white-space: pre-wrap !important;
                word-break: break-word !important;
            }
        }

    }

    @include mixins.md-children-inherit(":where(#{tokens.$selectors}):not(.katex, .footnote-ref, .footnote-backref) *");

    [data-hidden] :where(#{tokens.$selectors}) {
        color-scheme: inherit;
        content-visibility: auto !important;
    }

    :where([data-hidden], [data-dragging]):where(#{tokens.$selectors}) {
        content-visibility: auto !important;
    }

    [data-dragging] :where(#{tokens.$selectors}) {
        color-scheme: inherit;
        content-visibility: auto !important;

        :where(*) {
            content-visibility: auto !important;
        }
    }

    .katex {
        inline-size: fit-content;
        max-inline-size: stretch;
        block-size: fit-content;
        max-block-size: stretch;
        font-variant: normal;
        font-kerning: normal;
        text-transform: none;
        text-align: start;

        * {
            text-align: start;
            inline-size: fit-content;
            max-inline-size: stretch;
            block-size: fit-content;
            max-block-size: stretch;
            font-variant: normal;
            font-kerning: normal;
            text-transform: none;
        }
    }

    .footnote-ref,
    .footnote-backref {
        font-variant-emoji: text;
        inline-size: fit-content;
        max-inline-size: stretch;
        block-size: fit-content;
        max-block-size: stretch;
        font-variant-numeric: tabular-nums;
        font-variant-east-asian: jis78;
        font-variant-ligatures: common-ligatures;
        font-variant-caps: normal;
        font-variant-alternates: normal;
        text-align: start;

        * {
            text-align: start;
            inline-size: fit-content;
            max-inline-size: stretch;
            block-size: fit-content;
            max-block-size: stretch;
        }
    }
}


@layer overrides {
    .katex,
    .katex * {
        font-variant: normal !important;
        font-variant-caps: normal !important;
        font-variant-ligatures: normal !important;
        text-transform: none !important;
        font-style: oblique 5deg;
    }

    .katex .mathnormal,
    .katex .mathit {
        font-style: oblique 5deg !important;
    }

    @media screen {
        :where(#{tokens.$selectors}):not(.katex, .footnote-ref, .footnote-backref) {
            --md-code-inline-bg: color-mix(in oklab, var(--md-bg-code) 88%, var(--md-bg-default));
            --md-code-inline-fg: var(--md-fg-default);
            --md-code-block-bg: var(--md-bg-code);
            --md-code-block-fg: var(--md-fg-default);
            --md-code-block-border: color-mix(in oklab, var(--md-border-default) 60%, transparent);
            text-rendering: auto;
            -webkit-font-smoothing: auto;
            -moz-osx-font-smoothing: auto;

            p,
            li,
            blockquote,
            td,
            th {
                text-align: start;
                hyphens: manual;
            }

            code:not(pre code),
            tt:not(pre tt),
            samp:not(pre samp) {
                background: var(--md-code-inline-bg);
                color: var(--md-code-inline-fg);
                border: 0;
                box-shadow: none;
            }

            pre {
                background: var(--md-code-block-bg);
                color: var(--md-code-block-fg);
                border: 1px solid var(--md-code-block-border);
                box-shadow: none;

                code,
                tt,
                samp {
                    background: transparent;
                    border: 0;
                    box-shadow: none;
                    color: inherit;
                }
            }
        }
    }

    @media print {
        :where(#{tokens.$selectors}):not(.katex, .footnote-ref, .footnote-backref) {
            --md-print-code-inline-bg: #f3f4f6;
            --md-print-code-inline-fg: #111827;
            --md-print-code-block-bg: #f5f5f5;
            --md-print-code-block-fg: #111827;
            --md-print-code-border: #d1d5db;

            pre {
                background: var(--md-print-code-block-bg) !important;
                color: var(--md-print-code-block-fg) !important;
                border: 0 !important;
                box-shadow: none !important;

                code,
                tt,
                samp {
                    background: transparent !important;
                    color: inherit !important;
                    border: 0 !important;
                    box-shadow: none !important;
                    padding: 0 !important;
                    border-radius: 0 !important;
                }
            }

            code:not(pre code),
            tt:not(pre tt),
            samp:not(pre samp) {
                background: var(--md-print-code-inline-bg) !important;
                color: var(--md-print-code-inline-fg) !important;
                border: 0 !important;
                box-shadow: none !important;
                text-decoration: none !important;
            }
        }

    }
}

@layer print-breaks {
    @media print {
        :where(:heading, hr, h1, h2, h3, h4, h5, h6, p, pre, table, img, blockquote, hr) {
            break-before: auto;
            break-after: auto;
            break-inside: avoid;
            break-inside: avoid-page;
        }

        :where(table, ul, ol, p, pre, code, blockquote, :heading) + :where(hr, h1) {
            break-before: auto;
            break-after: auto;
            break-after: page;
            //break-after: always;
        }

        :where(hr, h1):has(+ :is(:heading, h1, h2, h3, h4, h5, h6, pre, table, img, blockquote)) {
            break-after: auto;
            break-after: page;
            //break-after: always;
        }

        :where(:heading, h1, h2, h3, h4, h5, h6, pre, table, img, blockquote) + :where(hr, h1) {
            break-before: auto;
            break-before: page;
            //break-before: always;
        }

        h1:not(:first-of-type) {
            break-before: auto;
        }

        h2:not(:first-of-type) {
            break-before: auto;
        }

        li,
        tr {
            break-inside: avoid;
            break-inside: avoid-page;
        }

        .print-chapter {
            break-before: auto;
            break-before: page;
            //break-before: always;
        }

        .print-section {
            break-before: avoid;
            break-before: avoid-page;
        }

        :where(h1:first-child, h2, h2:has(+ h3), h1 ~ h2:first-of-type, table + h2) {
            break-before: auto;
        }

        h1:not(:first-child) {
            @include mixins.md-break(auto, auto, auto);
        }

        *:has(+ h1),
        hr:has(+ h1, + h2, + h3, + h4, + h5, + h6) {
            break-after: auto;
        }
        
        :where(p, ol, li, table, blockquote, pre, code, strong) {
            & + :where(h1, h2, h3, h4, h5, h6) {
                break-before: auto;
            }

            &:has(+ h1, + h2, + h3, + h4, + h5, + h6) {
                break-after: auto;
            }

            &:has(+ p, + pre, + code, + ol, + li, + table, + blockquote, + strong) {
                break-after: avoid;
                break-after: avoid-page;
            }

            & + :where(p, ol, li, table, blockquote, strong) {
                break-before: avoid;
                break-before: avoid-page;
            }

            & + hr + :where(h1, h2):has(+ :where(p, ol, ul, blockquote)) {
                break-before: auto;
            }
        }

        :where(.pb, .np, .pagebreak, .newpage, .page-break, .new-page) {
            background-color: transparent;
            @include mixins.md-break(auto, auto, page);
        }

        :where(h1, h2, h3, h4, h5, h6) {
            &:has(+ :where(p, ul, ol, li, table, blockquote, pre, code)) {
                break-before: auto;
                break-after: avoid;
                break-after: avoid-page;
            }
        }

        :where(h1, h2) {
            &:has(+ :where(p, table, hr)) {
                break-before: auto;
            }
        }

        h1:first-of-type {
            break-before: avoid;
            break-before: avoid-page;
        }


        h1 {
            break-after: auto !important;
        }

        hr {
            break-after: auto !important;

            &:has(+ :where(:heading, hr, h1, h2, h3, h4, h5, h6, p, pre, table, img, blockquote)) {
                break-after: auto !important;
                break-after: page !important;
                //break-after: always !important;
            }
        }

        * + :where(hr, h1) {
            break-before: auto !important;
        }
    }
}
