@use "veela-lib" as *;
@use "../../library/mixins" as ui;

//
@layer layer.shell.faint {

    // Speed Dial (Home) Styles
    .speed-dial-root {
        display: grid;
        grid-template-columns: minmax(0px, 1fr);
        grid-template-rows: minmax(0px, 1fr);
        pointer-events: auto;
        min-inline-size: 0px;
        min-block-size: 0px;
        max-inline-size: stretch;
        max-block-size: stretch;
        inline-size: stretch;
        block-size: stretch;
        box-sizing: border-box;
        inset: 0;
        position: fixed;
        background-color: transparent;
        overflow: hidden;
        border-radius: 0px;
    }

    .speed-dial-grid {
        // Grid layout from data attributes - using CSS custom properties set by attr()
        // Modern approach: use registered @property with attr() fallback
        --grid-cols: 4;
        --grid-rows: 8;

        display: grid;
        gap: 0;
        padding: var(--padding-lg);

        // Grid columns via data attribute
        &[data-grid-columns="4"] { --grid-cols: 4; }
        &[data-grid-columns="5"] { --grid-cols: 5; }
        &[data-grid-columns="6"] { --grid-cols: 6; }

        // Grid rows via data attribute
        &[data-grid-rows="6"] { --grid-rows: 6; }
        &[data-grid-rows="7"] { --grid-rows: 7; }
        &[data-grid-rows="8"] { --grid-rows: 8; }
        &[data-grid-rows="9"] { --grid-rows: 9; }
        &[data-grid-rows="10"] { --grid-rows: 10; }
        &[data-grid-rows="11"] { --grid-rows: 11; }
        &[data-grid-rows="12"] { --grid-rows: 12; }

        //
        --layout-c: var(--grid-cols, 4);
        --layout-r: var(--grid-rows, 8);

        grid-template-columns: repeat(var(--cs-layout-c, 4), minmax(0px, 1fr));
        grid-template-rows: repeat(var(--cs-layout-r, 8), minmax(0px, 1fr));

        min-inline-size: 0px;
        min-block-size: 0px;
        max-inline-size: stretch;
        max-block-size: stretch;
        inline-size: stretch;
        block-size: stretch;
        box-sizing: border-box;
        pointer-events: none; // Background click should go through if needed, but items are auto

        place-content: center;
        place-items: center;
        border-radius: 0px;

        // Items
        .ui-ws-item {
            background-color: transparent;
            pointer-events: none;
            display: grid;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            aspect-ratio: 1 / 1;
            position: relative;

            text-align: center;
            place-content: center;
            place-items: center;
            place-self: center;

            grid-template-columns: minmax(0px, 1fr);
            grid-template-rows: minmax(0px, 1fr);

            box-shadow: none;
            filter: drop-shadow(0px 0px 0.25rem #0004) !important;

            // Visuals
            transition: transform var(--transition-fast) var(--ease-out);
            contain: none;
            overflow: visible;
            user-select: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;

            &:hover {
                transform: scale(1.05);

                .ui-ws-item-icon {
                    @include ui.tonal-surface(surface-container-high, var(--surface-opacity-default), var(--radius-lg), null, 2);
                }
            }

            &:active {
                transform: scale(0.95);
            }

            .ui-ws-item-icon {
                display: grid;
                /*border-radius: var(--radius-lg);*/
                transition: background-color var(--transition-colors), box-shadow var(--transition-colors), clip-path var(--transition-fast); /*, border-radius var(--transition-fast);*/
                grid-column: 1 / -1;
                grid-row: 1 / -1;
                aspect-ratio: 1 / 1;

                pointer-events: auto;
                position: relative;
                text-align: center;
                place-content: center;
                place-items: center;
                line-height: 0;
                overflow: hidden;
                contain: strict;
                cursor: pointer;

                inline-size: stretch;
                block-size: stretch;
                min-inline-size: fit-content;
                min-block-size: fit-content;
                max-inline-size: stretch;
                max-block-size: stretch;
                padding: 1rem;

                box-shadow: none;
                filter: none;

                // Default tonal surface background
                @include ui.tonal-surface(surface-container, var(--surface-opacity-default), var(--border-radius), null, 1);

                &, &:hover, &:active {
                    border-radius: var(--border-radius);
                }

                ui-icon {
                    --icon-size: clamp(2rem, 100%, 3rem);
                    color: var(--on-surface-variant, var(--on-surface-color, currentColor));
                    aspect-ratio: 1 / 1;
                    max-inline-size: var(--icon-size, 2rem);
                    max-block-size: var(--icon-size, 2rem);
                    min-inline-size: fit-content;
                    min-block-size: fit-content;
                    inline-size: var(--icon-size, 2rem);
                    block-size: var(--icon-size, 2rem);
                    object-fit: contain;
                    object-position: center;
                    line-height: 0;
                    z-index: 2;
                    pointer-events: none;

                    filter: drop-shadow(0px 0px 0.25rem oklch(from var(--on-surface-variant, var(--on-surface-color, currentColor)) l c h / 0.4));
                }
            }

            .ui-ws-item-label {
                @include solid-colorize("&");

                position: absolute;
                inset: 0;
                pointer-events: none;
                text-align: center;
                place-content: center;
                place-items: center;
                grid-column: 1 / -1;
                grid-row: 1 / -1;
                perspective: 1000;
                backface-visibility: hidden;
                transform: translateY(calc(50% + 0.75rem)) translateZ(0px);
                color: var(--on-surface-color, currentColor);
                background-color: transparent;
                background-image: none;
                white-space: nowrap;
                aspect-ratio: auto;

                inline-size: 100%;
                min-inline-size: 0px;
                min-block-size: 1px;
                block-size: 100%;
                line-height: 0;
                overflow: visible;
                display: grid;
                filter: none;

                span {
                    display: flex;
                    place-content: center;
                    place-items: center;

                    @include ui.text-label("label-medium");
                    color: var(--on-surface-color, currentColor);
                    background-color: transparent;
                    background-image: none;

                    // Truncate
                    white-space: nowrap;
                    text-overflow: ellipsis;
                    padding-inline: var(--padding-xs);
                    background: rgba(0,0,0,0.2); // Subtle backdrop for readability
                    border-radius: var(--radius-sm);
                    pointer-events: none;
                    text-align: center;
                    line-height: 0;
                    inline-size: stretch;

                    min-block-size: 1px;
                    block-size: fit-content;
                    max-block-size: fit-content;
                    overflow: visible;
                    max-inline-size: stretch;
                    min-inline-size: 1px;

                    text-shadow: 0px 0px 0.25rem #0004;
                }
            }

            &:active {
                will-change: transform;
            }

            &[data-dragging] {
                will-change: transform;
                cursor: grabbing;

                .ui-ws-item-label {
                    opacity: 0.0;
                    pointer-events: none;
                }
            }

            &[data-layer="labels"] {
                z-index: 0;
                filter: none;
            }

            &[data-layer="icons"] {
                z-index: 99;
                filter: none;
            }
        }
    }
}