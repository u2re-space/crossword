const t=()=>(globalThis?.location)?.origin,n=(n,e)=>{const s=n?.trim?.()||"";if(!s)return!1;const a=t();if("function"==typeof URL?.canParse)return URL.canParse(s,a);try{return new URL(s,a),!0}catch{return!1}},e={containerId:"rs-toast-layer",position:"bottom",maxToasts:5,zIndex:2147483647},s=3e3,a=new WeakSet,o=new Map,r=(t,n=document)=>{const e=`${t.containerId}-${t.position}`;if(o.has(e)){const t=o.get(e);if(t.isConnected)return t;o.delete(e)}((t=document)=>{if(a.has(t))return;const n=t.createElement("style");n.id="__rs-toast-styles__",n.textContent='\n.rs-toast-layer {\n    position: fixed;\n    z-index: var(--shell-toast-z, 2147483647);\n    pointer-events: none;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 1rem;\n    gap: 0.5rem;\n    max-block-size: 80dvb;\n    overflow: hidden;\n    box-sizing: border-box;\n}\n\n.rs-toast-layer[data-position="bottom"],\n.rs-toast-layer:not([data-position]) {\n    inset-block-end: 10dvb;\n    inset-inline: 0;\n    justify-content: flex-end;\n}\n\n.rs-toast-layer[data-position="top"] {\n    inset-block-start: 10dvb;\n    inset-inline: 0;\n    justify-content: flex-start;\n}\n\n.rs-toast-layer[data-position="top-left"] {\n    inset-block-start: 10dvb;\n    inset-inline-start: 0;\n    align-items: flex-start;\n}\n\n.rs-toast-layer[data-position="top-right"] {\n    inset-block-start: 10dvb;\n    inset-inline-end: 0;\n    align-items: flex-end;\n}\n\n.rs-toast-layer[data-position="bottom-left"] {\n    inset-block-end: 10dvb;\n    inset-inline-start: 0;\n    align-items: flex-start;\n}\n\n.rs-toast-layer[data-position="bottom-right"] {\n    inset-block-end: 10dvb;\n    inset-inline-end: 0;\n    align-items: flex-end;\n}\n\n.rs-toast {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    gap: 0.5rem;\n    padding: 0.5rem 1rem;\n    max-inline-size: min(90vw, 32rem);\n    inline-size: fit-content;\n\n    border-radius: var(--toast-radius, 0.5rem);\n    background-color: var(--toast-bg, light-dark(#fafbfc, #1e293b));\n    box-shadow: var(--toast-shadow, 0 4px 6px rgba(0, 0, 0, 0.1));\n    backdrop-filter: blur(12px) saturate(140%);\n    color: var(--toast-text, light-dark(#000000, #ffffff));\n\n    font-family: var(--toast-font-family, system-ui, -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, sans-serif);\n    font-size: var(--toast-font-size, 0.875rem);\n    font-weight: var(--toast-font-weight, 500);\n    letter-spacing: 0.01em;\n    line-height: 1.4;\n    white-space: pre-wrap;\n    overflow-wrap: anywhere;\n    word-break: break-word;\n\n    pointer-events: auto;\n    user-select: none;\n    cursor: default;\n\n    opacity: 0;\n    transform: translateY(100%) scale(0.9);\n    transition:\n        opacity 160ms ease-out,\n        transform 160ms cubic-bezier(0.16, 1, 0.3, 1),\n        background-color 100ms ease;\n}\n\n.rs-toast[data-visible] {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n}\n\n.rs-toast:active {\n    transform: scale(0.98);\n}\n\n.rs-toast[data-kind="success"] {\n    --toast-bg: var(--color-success, var(--color-success, #22c55e));\n}\n\n.rs-toast[data-kind="warning"] {\n    --toast-bg: var(--color-warning, var(--color-warning, #f59e0b));\n}\n\n.rs-toast[data-kind="error"] {\n    --toast-bg: var(--color-error, var(--color-error, #ef4444));\n}\n\n@media (prefers-reduced-motion: reduce) {\n    .rs-toast,\n    .rs-toast[data-visible] {\n        transition-duration: 0ms;\n        transform: none;\n    }\n}\n',(t.head||t.documentElement).appendChild(n),a.add(t)})(n);let s=n.getElementById(t.containerId);return s||(s=n.createElement("div"),s.id=t.containerId,s.className="rs-toast-layer",s.setAttribute("aria-live","polite"),s.setAttribute("aria-atomic","true"),n.body.appendChild(s)),s.setAttribute("data-position",t.position),s.style.setProperty("--shell-toast-z",String(t.zIndex)),o.set(e,s),s},i=t=>{const n="string"==typeof t?{message:t}:t,{message:a,kind:i="info",duration:l=s,persistent:d=!1,position:c=e.position,onClick:m}=n;if(!a)return null;if("undefined"==typeof document)return(t=>{try{const n=new BroadcastChannel("rs-toast");n.postMessage({type:"show-toast",options:t}),n.close()}catch(n){console.warn("[Toast] Broadcast failed:",n)}})(n),null;const u={...e,position:c},f=r(u);for(;f.children.length>=u.maxToasts;)f.firstChild?.remove();const p=document.createElement("div");var b;p.className="rs-toast",p.setAttribute("data-kind",i),p.setAttribute("role","error"===i||"warning"===i?"alert":"status"),p.setAttribute("aria-live","error"===i?"assertive":"polite"),p.textContent=a,f.appendChild(p),b=()=>{p.setAttribute("data-visible","")},"function"!=typeof globalThis?.requestAnimationFrame?globalThis.setTimeout(b,0):globalThis.requestAnimationFrame(b);let g=null;const v=()=>{null!==g&&(globalThis.clearTimeout(g),g=null),p.removeAttribute("data-visible"),setTimeout(()=>{if(p.remove(),!f.childElementCount){const t=`${u.containerId}-${u.position}`;o.delete(t)}},200)};return d||(g=globalThis.setTimeout(v,l)),p.addEventListener("click",()=>{m?.(),v()}),p.addEventListener("pointerdown",()=>{null!==g&&(globalThis.clearTimeout(g),g=null),v()},{once:!0}),p},l=(t,n)=>i({message:t,kind:"success",duration:n}),d=(t,n)=>i({message:t,kind:"error",duration:n}),c=()=>(()=>{if("undefined"==typeof BroadcastChannel)return()=>{};const t=new BroadcastChannel("rs-toast"),n=t=>{"show-toast"===t.data?.type&&t.data?.options&&i(t.data.options)};return t.addEventListener("message",n),()=>{t.removeEventListener("message",n),t.close()}})();export{n as canParseURL,c as initToastReceiver,d as showError,l as showSuccess,i as showToast};
