{"version":3,"file":"auto-render.js","sources":["../../../../node_modules/katex/dist/contrib/auto-render.mjs"],"sourcesContent":["import katex from '../katex.mjs';\n\n/* eslint no-constant-condition:0 */\nvar findEndOfMath = function findEndOfMath(delimiter, text, startIndex) {\n  // Adapted from\n  // https://github.com/Khan/perseus/blob/master/src/perseus-markdown.jsx\n  var index = startIndex;\n  var braceLevel = 0;\n  var delimLength = delimiter.length;\n\n  while (index < text.length) {\n    var character = text[index];\n\n    if (braceLevel <= 0 && text.slice(index, index + delimLength) === delimiter) {\n      return index;\n    } else if (character === \"\\\\\") {\n      index++;\n    } else if (character === \"{\") {\n      braceLevel++;\n    } else if (character === \"}\") {\n      braceLevel--;\n    }\n\n    index++;\n  }\n\n  return -1;\n};\n\nvar escapeRegex = function escapeRegex(string) {\n  return string.replace(/[-/\\\\^$*+?.()|[\\]{}]/g, \"\\\\$&\");\n};\n\nvar amsRegex = /^\\\\begin{/;\n\nvar splitAtDelimiters = function splitAtDelimiters(text, delimiters) {\n  var index;\n  var data = [];\n  var regexLeft = new RegExp(\"(\" + delimiters.map(x => escapeRegex(x.left)).join(\"|\") + \")\");\n\n  while (true) {\n    index = text.search(regexLeft);\n\n    if (index === -1) {\n      break;\n    }\n\n    if (index > 0) {\n      data.push({\n        type: \"text\",\n        data: text.slice(0, index)\n      });\n      text = text.slice(index); // now text starts with delimiter\n    } // ... so this always succeeds:\n\n\n    var i = delimiters.findIndex(delim => text.startsWith(delim.left));\n    index = findEndOfMath(delimiters[i].right, text, delimiters[i].left.length);\n\n    if (index === -1) {\n      break;\n    }\n\n    var rawData = text.slice(0, index + delimiters[i].right.length);\n    var math = amsRegex.test(rawData) ? rawData : text.slice(delimiters[i].left.length, index);\n    data.push({\n      type: \"math\",\n      data: math,\n      rawData,\n      display: delimiters[i].display\n    });\n    text = text.slice(index + delimiters[i].right.length);\n  }\n\n  if (text !== \"\") {\n    data.push({\n      type: \"text\",\n      data: text\n    });\n  }\n\n  return data;\n};\n\n/* eslint no-console:0 */\n/* Note: optionsCopy is mutated by this method. If it is ever exposed in the\n * API, we should copy it before mutating.\n */\n\nvar renderMathInText = function renderMathInText(text, optionsCopy) {\n  var data = splitAtDelimiters(text, optionsCopy.delimiters);\n\n  if (data.length === 1 && data[0].type === 'text') {\n    // There is no formula in the text.\n    // Let's return null which means there is no need to replace\n    // the current text node with a new one.\n    return null;\n  }\n\n  var fragment = document.createDocumentFragment();\n\n  for (var i = 0; i < data.length; i++) {\n    if (data[i].type === \"text\") {\n      fragment.appendChild(document.createTextNode(data[i].data));\n    } else {\n      var span = document.createElement(\"span\");\n      var math = data[i].data; // Override any display mode defined in the settings with that\n      // defined by the text itself\n\n      optionsCopy.displayMode = data[i].display;\n\n      try {\n        if (optionsCopy.preProcess) {\n          math = optionsCopy.preProcess(math);\n        }\n\n        katex.render(math, span, optionsCopy);\n      } catch (e) {\n        if (!(e instanceof katex.ParseError)) {\n          throw e;\n        }\n\n        optionsCopy.errorCallback(\"KaTeX auto-render: Failed to parse `\" + data[i].data + \"` with \", e);\n        fragment.appendChild(document.createTextNode(data[i].rawData));\n        continue;\n      }\n\n      fragment.appendChild(span);\n    }\n  }\n\n  return fragment;\n};\n\nvar renderElem = function renderElem(elem, optionsCopy) {\n  for (var i = 0; i < elem.childNodes.length; i++) {\n    var childNode = elem.childNodes[i];\n\n    if (childNode.nodeType === 3) {\n      // Text node\n      // Concatenate all sibling text nodes.\n      // Webkit browsers split very large text nodes into smaller ones,\n      // so the delimiters may be split across different nodes.\n      var textContentConcat = childNode.textContent;\n      var sibling = childNode.nextSibling;\n      var nSiblings = 0;\n\n      while (sibling && sibling.nodeType === Node.TEXT_NODE) {\n        textContentConcat += sibling.textContent;\n        sibling = sibling.nextSibling;\n        nSiblings++;\n      }\n\n      var frag = renderMathInText(textContentConcat, optionsCopy);\n\n      if (frag) {\n        // Remove extra text nodes\n        for (var j = 0; j < nSiblings; j++) {\n          childNode.nextSibling.remove();\n        }\n\n        i += frag.childNodes.length - 1;\n        elem.replaceChild(frag, childNode);\n      } else {\n        // If the concatenated text does not contain math\n        // the siblings will not either\n        i += nSiblings;\n      }\n    } else if (childNode.nodeType === 1) {\n      (function () {\n        // Element node\n        var className = ' ' + childNode.className + ' ';\n        var shouldRender = optionsCopy.ignoredTags.indexOf(childNode.nodeName.toLowerCase()) === -1 && optionsCopy.ignoredClasses.every(x => className.indexOf(' ' + x + ' ') === -1);\n\n        if (shouldRender) {\n          renderElem(childNode, optionsCopy);\n        }\n      })();\n    } // Otherwise, it's something else, and ignore it.\n\n  }\n};\n\nvar renderMathInElement = function renderMathInElement(elem, options) {\n  if (!elem) {\n    throw new Error(\"No element provided to render\");\n  }\n\n  var optionsCopy = {}; // Object.assign(optionsCopy, option)\n\n  for (var option in options) {\n    if (options.hasOwnProperty(option)) {\n      optionsCopy[option] = options[option];\n    }\n  } // default options\n\n\n  optionsCopy.delimiters = optionsCopy.delimiters || [{\n    left: \"$$\",\n    right: \"$$\",\n    display: true\n  }, {\n    left: \"\\\\(\",\n    right: \"\\\\)\",\n    display: false\n  }, // LaTeX uses $…$, but it ruins the display of normal `$` in text:\n  // {left: \"$\", right: \"$\", display: false},\n  // $ must come after $$\n  // Render AMS environments even if outside $$…$$ delimiters.\n  {\n    left: \"\\\\begin{equation}\",\n    right: \"\\\\end{equation}\",\n    display: true\n  }, {\n    left: \"\\\\begin{align}\",\n    right: \"\\\\end{align}\",\n    display: true\n  }, {\n    left: \"\\\\begin{alignat}\",\n    right: \"\\\\end{alignat}\",\n    display: true\n  }, {\n    left: \"\\\\begin{gather}\",\n    right: \"\\\\end{gather}\",\n    display: true\n  }, {\n    left: \"\\\\begin{CD}\",\n    right: \"\\\\end{CD}\",\n    display: true\n  }, {\n    left: \"\\\\[\",\n    right: \"\\\\]\",\n    display: true\n  }];\n  optionsCopy.ignoredTags = optionsCopy.ignoredTags || [\"script\", \"noscript\", \"style\", \"textarea\", \"pre\", \"code\", \"option\"];\n  optionsCopy.ignoredClasses = optionsCopy.ignoredClasses || [];\n  optionsCopy.errorCallback = optionsCopy.errorCallback || console.error; // Enable sharing of global macros defined via `\\gdef` between different\n  // math elements within a single call to `renderMathInElement`.\n\n  optionsCopy.macros = optionsCopy.macros || {};\n  renderElem(elem, optionsCopy);\n};\n\nexport { renderMathInElement as default };\n"],"names":[],"mappings":"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","x_google_ignoreList":[0]}