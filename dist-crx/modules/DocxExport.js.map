{"version":3,"file":"DocxExport.js","sources":["../../src/core/document/DocxExport.ts"],"sourcesContent":["import {\n    AlignmentType,\n    BorderStyle,\n    Document,\n    ExternalHyperlink,\n    HeadingLevel,\n    ImageRun,\n    MathAngledBrackets,\n    Math as MathNode,\n    type MathComponent,\n    MathCurlyBrackets,\n    MathFraction,\n    MathRadical,\n    MathRoundBrackets,\n    MathRun,\n    MathSquareBrackets,\n    MathSubScript,\n    MathSubSuperScript,\n    MathSuperScript,\n    LevelFormat,\n    Packer,\n    Paragraph,\n    ShadingType,\n    Table,\n    TableBorders,\n    TableCell,\n    TableRow,\n    TextRun,\n    UnderlineType,\n    WidthType,\n} from \"docx\";\nimport { marked, type MarkedExtension } from \"marked\";\nimport markedKatex from \"marked-katex-extension\";\nimport renderMathInElement from \"katex/dist/contrib/auto-render.mjs\";\n\nexport type DocxExportOptions = {\n    title?: string;\n    filename?: string;\n    creator?: string;\n};\n\nlet markedConfigured = false;\n\nconst ORDERED_LIST_REF = \"cw-ordered-list\";\nconst COLORS = {\n    text: \"1A1A1A\",\n    border: \"D1D5DB\",\n    borderDark: \"666666\",\n    link: \"333333\",\n    codeBg: \"F5F5F5\",\n    quoteBg: \"FAFAFA\",\n    thBg: \"E5E5E5\",\n} as const;\n\nconst FONTS = {\n    serif: \"Times New Roman\",\n    mono: \"Consolas\",\n    math: \"Cambria Math\",\n} as const;\n\nconst SIZES = {\n    // docx uses half-points; 24 = 12pt\n    body: 24,\n    code: 20,\n    h1: 40,\n    h2: 32,\n    h3: 28,\n    h4: 26,\n    h5: 24,\n    h6: 22,\n} as const;\n\nfunction ensureMarkedConfigured(): void {\n    if (markedConfigured) return;\n    markedConfigured = true;\n\n    marked?.use?.(\n        markedKatex({\n            throwOnError: false,\n            nonStandard: true,\n            output: \"mathml\",\n            strict: false,\n        }) as unknown as MarkedExtension,\n        {\n            hooks: {\n                preprocess: (markdown: string): string => {\n                    if (/\\\\(.*\\\\)|\\\\[.*\\\\]/.test(markdown)) {\n                        const katexNode = document.createElement(\"div\");\n                        katexNode.innerHTML = markdown;\n                        renderMathInElement(katexNode, {\n                            throwOnError: false,\n                            nonStandard: true,\n                            output: \"mathml\",\n                            strict: false,\n                            delimiters: [\n                                { left: \"$$\", right: \"$$\", display: true },\n                                { left: \"\\\\[\", right: \"\\\\]\", display: true },\n                                { left: \"$\", right: \"$\", display: false },\n                                { left: \"\\\\(\", right: \"\\\\)\", display: false },\n                            ],\n                        });\n                        return katexNode.innerHTML;\n                    }\n                    return markdown;\n                },\n            },\n        }\n    );\n}\n\nfunction safeFilename(name: string): string {\n    const trimmed = (name || \"\").trim() || \"document\";\n    return trimmed.replace(/[\\\\/:*?\"<>|\\u0000-\\u001F]+/g, \"-\").slice(0, 180);\n}\n\nfunction downloadBlob(blob: Blob, filename: string): void {\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = filename;\n    a.rel = \"noopener\";\n    a.style.display = \"none\";\n    document.body.appendChild(a);\n    a.click();\n    a.remove();\n    setTimeout(() => URL.revokeObjectURL(url), 250);\n}\n\nasync function markdownToHtml(markdown: string): Promise<string> {\n    ensureMarkedConfigured();\n    return await marked.parse(markdown ?? \"\", { gfm: true, breaks: true });\n}\n\nfunction htmlToBody(html: string): HTMLElement {\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(html ?? \"\", \"text/html\");\n    return doc.body;\n}\n\ntype InlineStyle = {\n    bold?: boolean;\n    italic?: boolean;\n    code?: boolean;\n};\n\ntype InlineChild = TextRun | ExternalHyperlink | MathNode;\ntype BlockChild = Paragraph | Table;\n\ntype ConvertContext = {\n    blockIndex: number;\n    /** If true, prefer page breaks before H1-like sections */\n    chapterByH1: boolean;\n};\n\nfunction textRun(text: string, style: InlineStyle): TextRun {\n    return new TextRun({\n        text,\n        bold: !!style.bold,\n        italics: !!style.italic,\n        // Keep font/color controlled by doc defaults + paragraph styles.\n        // Only override for inline code.\n        font: style.code ? FONTS.mono : undefined,\n    });\n}\n\nfunction textRunHyperlink(text: string): TextRun {\n    return new TextRun({\n        text,\n        style: \"Hyperlink\",\n    });\n}\n\nfunction breakRun(): TextRun {\n    return new TextRun({ break: 1 });\n}\n\nfunction normalizeMathText(s: string): string {\n    return (s ?? \"\").replace(/\\s+/g, \" \").trim();\n}\n\nfunction mathComponentsFromMathNode(node: Element): MathComponent[] {\n    const tag = node.tagName.toLowerCase();\n\n    // Containers\n    if (tag === \"math\" || tag === \"mrow\" || tag === \"mstyle\" || tag === \"semantics\") {\n        const kids: MathComponent[] = [];\n        for (const c of Array.from(node.children)) {\n            kids.push(...mathComponentsFromMathNode(c));\n        }\n        if (!kids.length) {\n            const t = normalizeMathText(node.textContent || \"\");\n            return t ? [new MathRun(t)] : [];\n        }\n        return kids;\n    }\n\n    // KaTeX often includes <annotation> text; ignore it\n    if (tag === \"annotation\") return [];\n\n    // Runs\n    if (tag === \"mi\" || tag === \"mn\" || tag === \"mtext\") {\n        const t = normalizeMathText(node.textContent || \"\");\n        return t ? [new MathRun(t)] : [];\n    }\n    if (tag === \"mo\") {\n        const t = normalizeMathText(node.textContent || \"\");\n        return t ? [new MathRun(t)] : [];\n    }\n\n    // Fraction: <mfrac><num/><den/></mfrac>\n    if (tag === \"mfrac\") {\n        const [num, den] = Array.from(node.children);\n        return [\n            new MathFraction({\n                numerator: num ? mathComponentsFromMathNode(num) : [],\n                denominator: den ? mathComponentsFromMathNode(den) : [],\n            }),\n        ];\n    }\n\n    // Roots\n    if (tag === \"msqrt\") {\n        const children: MathComponent[] = [];\n        for (const c of Array.from(node.children)) children.push(...mathComponentsFromMathNode(c));\n        return [new MathRadical({ children })];\n    }\n    if (tag === \"mroot\") {\n        const [base, degree] = Array.from(node.children);\n        const children = base ? mathComponentsFromMathNode(base) : [];\n        const deg = degree ? mathComponentsFromMathNode(degree) : [];\n        return [new MathRadical({ children, degree: deg })];\n    }\n\n    // Sub/Sup\n    if (tag === \"msup\") {\n        const [base, sup] = Array.from(node.children);\n        return [\n            new MathSuperScript({\n                children: base ? mathComponentsFromMathNode(base) : [],\n                superScript: sup ? mathComponentsFromMathNode(sup) : [],\n            }),\n        ];\n    }\n    if (tag === \"msub\") {\n        const [base, sub] = Array.from(node.children);\n        return [\n            new MathSubScript({\n                children: base ? mathComponentsFromMathNode(base) : [],\n                subScript: sub ? mathComponentsFromMathNode(sub) : [],\n            }),\n        ];\n    }\n    if (tag === \"msubsup\") {\n        const [base, sub, sup] = Array.from(node.children);\n        return [\n            new MathSubSuperScript({\n                children: base ? mathComponentsFromMathNode(base) : [],\n                subScript: sub ? mathComponentsFromMathNode(sub) : [],\n                superScript: sup ? mathComponentsFromMathNode(sup) : [],\n            }),\n        ];\n    }\n\n    // Fenced: brackets\n    if (tag === \"mfenced\") {\n        const open = (node.getAttribute(\"open\") || \"(\").trim();\n        const close = (node.getAttribute(\"close\") || \")\").trim();\n        const children: MathComponent[] = [];\n        for (const c of Array.from(node.children)) children.push(...mathComponentsFromMathNode(c));\n\n        const wrap = (() => {\n            if (open === \"(\" && close === \")\") return MathRoundBrackets;\n            if (open === \"[\" && close === \"]\") return MathSquareBrackets;\n            if (open === \"{\" && close === \"}\") return MathCurlyBrackets;\n            if (open === \"⟨\" && close === \"⟩\") return MathAngledBrackets;\n            return MathRoundBrackets;\n        })();\n\n        return [new wrap({ children })];\n    }\n\n    // Fallback: flatten to a run\n    const t = normalizeMathText(node.textContent || \"\");\n    return t ? [new MathRun(t)] : [];\n}\n\nfunction mathFromElement(el: Element): MathNode | null {\n    const components = mathComponentsFromMathNode(el);\n    if (!components.length) return null;\n    return new MathNode({ children: components });\n}\n\nfunction collectInline(node: Node, style: InlineStyle, out: InlineChild[]): void {\n    if (node.nodeType === Node.TEXT_NODE) {\n        const text = node.nodeValue ?? \"\";\n        if (!text) return;\n        out.push(textRun(text, style));\n        return;\n    }\n\n    if (node.nodeType !== Node.ELEMENT_NODE) return;\n    const el = node as HTMLElement;\n    const tag = el.tagName.toLowerCase();\n\n    if (tag === \"br\") {\n        out.push(new TextRun({ break: 1 }));\n        return;\n    }\n\n    if (tag === \"strong\" || tag === \"b\") {\n        for (const child of Array.from(el.childNodes)) collectInline(child, { ...style, bold: true }, out);\n        return;\n    }\n\n    if (tag === \"em\" || tag === \"i\") {\n        for (const child of Array.from(el.childNodes)) collectInline(child, { ...style, italic: true }, out);\n        return;\n    }\n\n    // Inline code (block code handled by <pre>)\n    if (tag === \"code\" && el.parentElement?.tagName.toLowerCase() !== \"pre\") {\n        const text = el.textContent ?? \"\";\n        if (text) out.push(textRun(text, { ...style, code: true }));\n        return;\n    }\n\n    if (tag === \"a\") {\n        const href = (el.getAttribute(\"href\") || \"\").trim();\n        const children: TextRun[] = [];\n        const tmp: InlineChild[] = [];\n        for (const child of Array.from(el.childNodes)) collectInline(child, style, tmp);\n        for (const c of tmp) {\n            if (c instanceof TextRun) children.push(c);\n            else children.push(textRunHyperlink((el.textContent || href || \"\").trim() || href));\n        }\n\n        out.push(\n            new ExternalHyperlink({\n                link: href || (el.textContent || \"\").trim() || \"\",\n                children: children.length ? children : [textRunHyperlink(href || \"link\")],\n            })\n        );\n        return;\n    }\n\n    // MathML (KaTeX output: <span class=\"katex-mathml\"><math>...</math></span>)\n    if (tag === \"math\") {\n        const m = mathFromElement(el);\n        if (m) out.push(m);\n        else {\n            const text = (el.textContent || \"\").trim();\n            if (text) out.push(textRun(text, style));\n        }\n        return;\n    }\n    if (tag === \"span\" && (el.classList.contains(\"katex\") || el.classList.contains(\"katex-mathml\"))) {\n        const mathEl = el.querySelector(\"math\");\n        if (mathEl) {\n            const m = mathFromElement(mathEl);\n            if (m) {\n                out.push(m);\n                return;\n            }\n        }\n    }\n\n    // Keep SVG etc as plain text fallback\n    if (tag === \"svg\") {\n        const text = (el.textContent || \"\").trim();\n        if (text) out.push(textRun(text, style));\n        return;\n    }\n\n    for (const child of Array.from(el.childNodes)) collectInline(child, style, out);\n}\n\nfunction paragraphFromInlineNodes(nodes: ArrayLike<Node>, options?: any): Paragraph {\n    const children: InlineChild[] = [];\n    for (const n of Array.from(nodes)) collectInline(n, {}, children);\n\n    return new Paragraph({\n        widowControl: true,\n        ...(options || {}),\n        children: children.length ? children : [new TextRun({ text: \"\" })],\n    });\n}\n\ntype HeadingLevelType = (typeof HeadingLevel)[keyof typeof HeadingLevel];\n\nfunction headingLevelFromTag(tag: string): HeadingLevelType | undefined {\n    if (tag === \"h1\") return HeadingLevel.HEADING_1;\n    if (tag === \"h2\") return HeadingLevel.HEADING_2;\n    if (tag === \"h3\") return HeadingLevel.HEADING_3;\n    if (tag === \"h4\") return HeadingLevel.HEADING_4;\n    if (tag === \"h5\") return HeadingLevel.HEADING_5;\n    if (tag === \"h6\") return HeadingLevel.HEADING_6;\n    return undefined;\n}\n\nfunction convertList(listEl: HTMLElement, ordered: boolean, level: number): BlockChild[] {\n    const out: BlockChild[] = [];\n    const items = Array.from(listEl.children).filter((c) => c.tagName.toLowerCase() === \"li\") as HTMLElement[];\n\n    for (const li of items) {\n        const nestedLists = Array.from(li.children).filter((c) => {\n            const t = c.tagName.toLowerCase();\n            return t === \"ul\" || t === \"ol\";\n        }) as HTMLElement[];\n\n        const inlineNodes: Node[] = [];\n        for (const child of Array.from(li.childNodes)) {\n            if (child.nodeType === Node.ELEMENT_NODE) {\n                const t = (child as HTMLElement).tagName.toLowerCase();\n                if (t === \"ul\" || t === \"ol\") continue;\n            }\n            inlineNodes.push(child);\n        }\n\n        const left = 720 * Math.max(1, level + 1);\n        const hanging = 360;\n        out.push(\n            paragraphFromInlineNodes(inlineNodes, {\n                style: \"ListParagraph\",\n                bullet: ordered ? undefined : { level },\n                numbering: ordered ? { reference: ORDERED_LIST_REF, level } : undefined,\n                indent: { left, hanging },\n                spacing: { after: 180 },\n            })\n        );\n\n        for (const nested of nestedLists) {\n            const t = nested.tagName.toLowerCase();\n            out.push(...convertList(nested, t === \"ol\", level + 1));\n        }\n    }\n\n    return out;\n}\n\nasync function convertTable(tableEl: HTMLElement, ctx: ConvertContext): Promise<Table> {\n    const rows = await Promise.all(\n        Array.from(tableEl.querySelectorAll(\"tr\")).map(async (tr) => {\n            const cells = Array.from(tr.children).filter((c) => {\n                const t = c.tagName.toLowerCase();\n                return t === \"td\" || t === \"th\";\n            }) as HTMLElement[];\n\n            const cellRuns = await Promise.all(\n                cells.map(async (cellEl) => {\n                    const children: BlockChild[] = [];\n                    const isHeader = cellEl.tagName.toLowerCase() === \"th\";\n                    // Prefer block-level children inside a cell; fallback to a single paragraph.\n                    const hasBlock = Array.from(cellEl.children).some((c) => {\n                        const t = c.tagName.toLowerCase();\n                        return t === \"p\" || t === \"ul\" || t === \"ol\" || t === \"pre\" || t === \"blockquote\" || t === \"div\";\n                    });\n\n                    if (hasBlock) {\n                        for (const c of Array.from(cellEl.childNodes)) children.push(...(await convertBlockNode(c, 0, ctx)));\n                    } else {\n                        children.push(paragraphFromInlineNodes(cellEl.childNodes));\n                    }\n\n                    return new TableCell({\n                        width: { size: 1, type: WidthType.AUTO },\n                        shading: isHeader ? { type: ShadingType.CLEAR, fill: COLORS.thBg, color: \"auto\" } : undefined,\n                        children,\n                    });\n                })\n            );\n\n            return new TableRow({ children: cellRuns });\n        })\n    );\n\n    return new Table({\n        width: { size: 100, type: WidthType.PERCENTAGE },\n        borders: ({\n            top: { style: BorderStyle.SINGLE, size: 2, color: COLORS.borderDark },\n            bottom: { style: BorderStyle.SINGLE, size: 2, color: COLORS.borderDark },\n            left: { style: BorderStyle.SINGLE, size: 2, color: COLORS.borderDark },\n            right: { style: BorderStyle.SINGLE, size: 2, color: COLORS.borderDark },\n            insideHorizontal: { style: BorderStyle.SINGLE, size: 2, color: COLORS.border },\n            insideVertical: { style: BorderStyle.SINGLE, size: 2, color: COLORS.border },\n        } as any) satisfies TableBorders,\n        rows,\n    });\n}\n\nfunction convertPre(preEl: HTMLElement): Paragraph[] {\n    const codeEl = preEl.querySelector(\"code\");\n    const text = (codeEl?.textContent ?? preEl.textContent ?? \"\").replace(/\\r\\n/g, \"\\n\");\n    const lines = text.split(\"\\n\");\n\n    const children: TextRun[] = [];\n    for (let i = 0; i < lines.length; i++) {\n        children.push(new TextRun({ text: lines[i] }));\n        if (i !== lines.length - 1) children.push(breakRun());\n    }\n\n    return [\n        new Paragraph({\n            style: \"CodeBlock\",\n            widowControl: true,\n            keepLines: true,\n            children,\n            spacing: { before: 0, after: 0 },\n            border: {\n                top: { style: BorderStyle.SINGLE, size: 2, color: COLORS.border },\n                bottom: { style: BorderStyle.SINGLE, size: 2, color: COLORS.border },\n                left: { style: BorderStyle.SINGLE, size: 2, color: COLORS.border },\n                right: { style: BorderStyle.SINGLE, size: 2, color: COLORS.border },\n            },\n            shading: { type: ShadingType.CLEAR, fill: COLORS.codeBg, color: \"auto\" },\n            alignment: AlignmentType.LEFT,\n        }),\n    ];\n}\n\ntype DataUrlParts = { mimeType: string; isBase64: boolean; data: string };\n\nfunction parseDataUrl(src: string): DataUrlParts | null {\n    const s = (src || \"\").trim();\n    if (!s.toLowerCase().startsWith(\"data:\")) return null;\n    const m = s.match(/^data:(?<mime>[^;,]+)?(?<params>(?:;[^,]*)*?),(?<data>[\\s\\S]*)$/i);\n    if (!m?.groups) return null;\n    const mimeType = (m.groups.mime || \"application/octet-stream\").trim() || \"application/octet-stream\";\n    const params = (m.groups.params || \"\").toLowerCase();\n    const isBase64 = params.includes(\";base64\");\n    const data = m.groups.data ?? \"\";\n    return { mimeType, isBase64, data };\n}\n\nfunction decodeBase64ToBytes(base64: string): Uint8Array {\n    const s = (base64 || \"\").trim();\n    if (typeof (Uint8Array as any).fromBase64 === \"function\") {\n        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array/fromBase64\n        return (Uint8Array as any).fromBase64(s, { alphabet: \"base64\", lastChunkHandling: \"loose\" });\n    }\n    const padLen = (4 - (s.length % 4)) % 4;\n    const padded = s + \"=\".repeat(padLen);\n    const bin = typeof atob === \"function\" ? atob(padded) : \"\";\n    const out = new Uint8Array(bin.length);\n    for (let i = 0; i < bin.length; i++) out[i] = bin.charCodeAt(i);\n    return out;\n}\n\nfunction bytesFromDataUrl(dataUrl: string): { bytes: Uint8Array; mimeType: string } | null {\n    const p = parseDataUrl(dataUrl);\n    if (!p) return null;\n    if (!p.isBase64) return null;\n    return { bytes: decodeBase64ToBytes(p.data), mimeType: p.mimeType };\n}\n\nfunction imageTypeFromMime(mime: string): \"png\" | \"jpg\" | \"gif\" | \"bmp\" | undefined {\n    const m = (mime || \"\").toLowerCase();\n    if (m.includes(\"png\")) return \"png\";\n    if (m.includes(\"jpeg\")) return \"jpg\";\n    if (m.includes(\"jpg\")) return \"jpg\";\n    if (m.includes(\"gif\")) return \"gif\";\n    if (m.includes(\"bmp\")) return \"bmp\";\n    return undefined;\n}\n\nfunction bytesToArrayBuffer(bytes: Uint8Array): ArrayBuffer {\n    const buf: ArrayBufferLike = bytes.buffer;\n    if (buf instanceof ArrayBuffer) return buf.slice(bytes.byteOffset, bytes.byteOffset + bytes.byteLength);\n    const ab = new ArrayBuffer(bytes.byteLength);\n    new Uint8Array(ab).set(bytes);\n    return ab;\n}\n\nasync function imageRunFromSrc(src: string, alt: string): Promise<ImageRun | null> {\n    const s = (src || \"\").trim();\n    if (!s) return null;\n\n    // Try data URL first\n    const data = bytesFromDataUrl(s);\n    if (data) {\n        const type = imageTypeFromMime(data.mimeType);\n        if (!type) return null;\n        const { width, height } = await getImageSize(data.bytes, data.mimeType);\n        return new ImageRun({\n            type,\n            data: data.bytes,\n            transformation: fitImageToWidth(width, height, 600),\n            altText: alt ? { title: alt, description: alt, name: alt } : undefined,\n        });\n    }\n\n    // Fetch external URL / blob URL\n    try {\n        const res = await fetch(s);\n        if (!res.ok) return null;\n        const blob = await res.blob();\n        const mimeType = blob.type || \"application/octet-stream\";\n        const type = imageTypeFromMime(mimeType);\n        if (!type) return null;\n        const bytes = new Uint8Array(await blob.arrayBuffer());\n        const { width, height } = await getImageSize(bytes, mimeType);\n        return new ImageRun({\n            type,\n            data: bytes,\n            transformation: fitImageToWidth(width, height, 600),\n            altText: alt ? { title: alt, description: alt, name: alt } : undefined,\n        });\n    } catch {\n        return null;\n    }\n}\n\nasync function getImageSize(bytes: Uint8Array, mimeType: string): Promise<{ width: number; height: number }> {\n    try {\n        if (typeof createImageBitmap !== \"function\") return { width: 600, height: 400 };\n        const blob = new Blob([bytesToArrayBuffer(bytes)], { type: mimeType });\n        const bmp: any = await createImageBitmap(blob);\n        const width = Number(bmp?.width || 600);\n        const height = Number(bmp?.height || 400);\n        try { bmp?.close?.(); } catch { /* ignore */ }\n        return { width, height };\n    } catch {\n        return { width: 600, height: 400 };\n    }\n}\n\nfunction fitImageToWidth(width: number, height: number, maxWidth: number): { width: number; height: number } {\n    const w = Math.max(1, width || 1);\n    const h = Math.max(1, height || 1);\n    if (w <= maxWidth) return { width: w, height: h };\n    const ratio = maxWidth / w;\n    return { width: Math.round(w * ratio), height: Math.round(h * ratio) };\n}\n\nasync function convertBlockNode(node: Node, listLevel: number, ctx: ConvertContext): Promise<BlockChild[]> {\n    if (node.nodeType === Node.TEXT_NODE) {\n        const text = (node.nodeValue ?? \"\").trim();\n        if (!text) return [];\n        return [new Paragraph({ children: [textRun(text, {})] })];\n    }\n\n    if (node.nodeType !== Node.ELEMENT_NODE) return [];\n    const el = node as HTMLElement;\n    const tag = el.tagName.toLowerCase();\n\n    if (tag === \"p\") {\n        const imgs = Array.from(el.children).filter((c) => c.tagName.toLowerCase() === \"img\") as HTMLElement[];\n        const hasOnlyImg =\n            imgs.length === 1 &&\n            el.childNodes.length === 1 &&\n            el.firstElementChild?.tagName.toLowerCase() === \"img\";\n        if (hasOnlyImg) {\n            return await convertBlockNode(imgs[0], listLevel, ctx);\n        }\n        return [paragraphFromInlineNodes(el.childNodes)];\n    }\n\n    const heading = headingLevelFromTag(tag);\n    if (heading) {\n        const isH1 = heading === HeadingLevel.HEADING_1;\n        const wantsPageBreakBefore =\n            (ctx.chapterByH1 && isH1 && ctx.blockIndex > 0) ||\n            el.classList.contains(\"print-chapter\") ||\n            el.classList.contains(\"print-break-before\");\n        const withBorder =\n            heading === HeadingLevel.HEADING_1 || heading === HeadingLevel.HEADING_2\n                ? {\n                      border: { bottom: { style: BorderStyle.SINGLE, size: 4, color: COLORS.border } },\n                  }\n                : undefined;\n        return [\n            paragraphFromInlineNodes(el.childNodes, {\n                heading,\n                spacing: { before: 200, after: 120 },\n                keepNext: true,\n                keepLines: true,\n                pageBreakBefore: wantsPageBreakBefore || undefined,\n                ...withBorder,\n            }),\n        ];\n    }\n\n    if (tag === \"hr\") {\n        return [\n            new Paragraph({\n                thematicBreak: true,\n                border: { bottom: { style: BorderStyle.SINGLE, size: 2, color: COLORS.border } },\n                spacing: { before: 200, after: 200 },\n            }),\n        ];\n    }\n\n    if (tag === \"blockquote\") {\n        const out: BlockChild[] = [];\n        const quoteDecor = {\n            style: \"Quote\",\n            indent: { left: 720 },\n            border: { left: { style: BorderStyle.SINGLE, size: 6, color: COLORS.borderDark } },\n            shading: { type: ShadingType.CLEAR, fill: COLORS.quoteBg, color: \"auto\" },\n            spacing: { after: 240 },\n        } as const;\n\n        for (const child of Array.from(el.childNodes)) {\n            if (child.nodeType === Node.TEXT_NODE) {\n                const t = (child.nodeValue ?? \"\").trim();\n                if (t) out.push(new Paragraph({ ...quoteDecor, children: [textRun(t, {})] }));\n                continue;\n            }\n\n            if (child.nodeType !== Node.ELEMENT_NODE) continue;\n            const ce = child as HTMLElement;\n            const ct = ce.tagName.toLowerCase();\n\n            if (ct === \"p\") {\n                out.push(paragraphFromInlineNodes(ce.childNodes, quoteDecor));\n                continue;\n            }\n\n            const heading = headingLevelFromTag(ct);\n            if (heading) {\n                out.push(\n                    paragraphFromInlineNodes(ce.childNodes, {\n                        ...quoteDecor,\n                        heading,\n                        spacing: { before: 200, after: 120 },\n                    })\n                );\n                continue;\n            }\n\n            if (ct === \"ul\" || ct === \"ol\") {\n                out.push(...convertList(ce, ct === \"ol\", listLevel));\n                continue;\n            }\n\n            if (ct === \"pre\") {\n                const codeEl = ce.querySelector(\"code\");\n                const text = (codeEl?.textContent ?? ce.textContent ?? \"\").replace(/\\r\\n/g, \"\\n\");\n                const lines = text.split(\"\\n\");\n                const children: TextRun[] = [];\n                for (let i = 0; i < lines.length; i++) {\n                    children.push(new TextRun({ text: lines[i] }));\n                    if (i !== lines.length - 1) children.push(breakRun());\n                }\n                out.push(\n                    new Paragraph({\n                        ...quoteDecor,\n                        style: \"CodeBlock\",\n                        keepLines: true,\n                        children,\n                        spacing: { before: 0, after: 0 },\n                        shading: { type: ShadingType.CLEAR, fill: COLORS.codeBg, color: \"auto\" },\n                        alignment: AlignmentType.LEFT,\n                    })\n                );\n                continue;\n            }\n\n            const t = (ce.textContent ?? \"\").trim();\n            if (t) out.push(new Paragraph({ ...quoteDecor, children: [textRun(t, {})] }));\n        }\n\n        return out.length ? out : [new Paragraph({ ...quoteDecor, children: [textRun((el.textContent || \"\").trim(), {})] })];\n    }\n\n    if (tag === \"pre\") return convertPre(el);\n\n    if (tag === \"ul\") return convertList(el, false, listLevel);\n    if (tag === \"ol\") return convertList(el, true, listLevel);\n\n    if (tag === \"table\") return [await convertTable(el, ctx)];\n\n    if (tag === \"img\") {\n        const alt = (el.getAttribute(\"alt\") || \"\").trim();\n        const src = (el.getAttribute(\"src\") || \"\").trim();\n        const img = await imageRunFromSrc(src, alt);\n        if (!img) {\n            return [\n                new Paragraph({\n                    children: [textRun(`[image${alt ? `: ${alt}` : \"\"}] ${src ? `(${src})` : \"\"}`.trim(), {})],\n                }),\n            ];\n        }\n        const blocks: BlockChild[] = [\n            new Paragraph({\n                alignment: AlignmentType.CENTER,\n                keepLines: true,\n                children: [img],\n            }),\n        ];\n        if (alt) {\n            blocks.push(\n                new Paragraph({\n                    style: \"Caption\",\n                    alignment: AlignmentType.CENTER,\n                    spacing: { before: 80, after: 200 },\n                    children: [new TextRun({ text: alt, italics: true })],\n                })\n            );\n        }\n        return blocks;\n    }\n\n    // Common wrappers like div/section/article: recurse, but keep structure\n    if (tag === \"div\" || tag === \"section\" || tag === \"article\" || tag === \"main\") {\n        const out: BlockChild[] = [];\n        for (const child of Array.from(el.childNodes)) out.push(...(await convertBlockNode(child, listLevel, ctx)));\n        return out;\n    }\n\n    return [paragraphFromInlineNodes(el.childNodes)];\n}\n\nexport async function createDocxBlobFromHtml(html: string, options: DocxExportOptions = {}): Promise<Blob> {\n    const title = options.title || \"Document\";\n    const body = htmlToBody(html);\n    const children: BlockChild[] = [];\n    const ctx: ConvertContext = { blockIndex: 0, chapterByH1: true };\n\n    for (const node of Array.from(body.childNodes)) {\n        children.push(...(await convertBlockNode(node, 0, ctx)));\n        ctx.blockIndex++;\n    }\n\n    const doc = new Document({\n        creator: options.creator || \"CrossWord\",\n        title,\n        styles: {\n            default: {\n                document: {\n                    run: {\n                        font: FONTS.serif,\n                        size: SIZES.body,\n                        color: COLORS.text,\n                    },\n                    paragraph: {\n                        // Slightly tighter + smaller than print view; visually closer to DOCX norms.\n                        spacing: { line: 320, before: 0, after: 200 },\n                        alignment: AlignmentType.JUSTIFIED,\n                    },\n                },\n            },\n            characterStyles: [\n                {\n                    id: \"Hyperlink\",\n                    name: \"Hyperlink\",\n                    basedOn: \"DefaultParagraphFont\",\n                    quickFormat: true,\n                    run: {\n                        color: COLORS.link,\n                        underline: { type: UnderlineType.SINGLE, color: COLORS.link },\n                    },\n                },\n            ],\n            paragraphStyles: [\n                {\n                    id: \"ListParagraph\",\n                    name: \"List Paragraph\",\n                    basedOn: \"Normal\",\n                    next: \"Normal\",\n                    quickFormat: true,\n                    paragraph: {\n                        spacing: { after: 180 },\n                    },\n                    run: { font: FONTS.serif, color: COLORS.text, size: SIZES.body },\n                },\n                {\n                    id: \"Quote\",\n                    name: \"Quote\",\n                    basedOn: \"Normal\",\n                    next: \"Normal\",\n                    quickFormat: true,\n                    paragraph: {\n                        spacing: { after: 240 },\n                        indent: { left: 720 },\n                    },\n                    run: { font: FONTS.serif, color: COLORS.text, italics: true, size: SIZES.body },\n                },\n                {\n                    id: \"CodeBlock\",\n                    name: \"Code Block\",\n                    basedOn: \"Normal\",\n                    next: \"Normal\",\n                    quickFormat: true,\n                    paragraph: {\n                        spacing: { before: 120, after: 120 },\n                        alignment: AlignmentType.LEFT,\n                    },\n                    run: { font: FONTS.mono, color: COLORS.link, size: SIZES.code },\n                },\n                {\n                    id: \"Caption\",\n                    name: \"Caption\",\n                    basedOn: \"Normal\",\n                    next: \"Normal\",\n                    quickFormat: true,\n                    paragraph: { spacing: { before: 80, after: 160 } },\n                    run: { font: FONTS.serif, color: COLORS.link, size: 20, italics: true },\n                },\n                {\n                    id: \"Heading1\",\n                    name: \"Heading 1\",\n                    basedOn: \"Normal\",\n                    next: \"Normal\",\n                    quickFormat: true,\n                    run: { font: FONTS.serif, bold: true, color: COLORS.text, size: SIZES.h1 },\n                    paragraph: { spacing: { before: 320, after: 160 } },\n                },\n                {\n                    id: \"Heading2\",\n                    name: \"Heading 2\",\n                    basedOn: \"Normal\",\n                    next: \"Normal\",\n                    quickFormat: true,\n                    run: { font: FONTS.serif, bold: true, color: COLORS.text, size: SIZES.h2 },\n                    paragraph: { spacing: { before: 280, after: 140 } },\n                },\n                {\n                    id: \"Heading3\",\n                    name: \"Heading 3\",\n                    basedOn: \"Normal\",\n                    next: \"Normal\",\n                    quickFormat: true,\n                    run: { font: FONTS.serif, bold: true, color: COLORS.text, size: SIZES.h3 },\n                    paragraph: { spacing: { before: 240, after: 120 } },\n                },\n                {\n                    id: \"Heading4\",\n                    name: \"Heading 4\",\n                    basedOn: \"Normal\",\n                    next: \"Normal\",\n                    quickFormat: true,\n                    run: { font: FONTS.serif, bold: true, color: COLORS.text, size: SIZES.h4 },\n                    paragraph: { spacing: { before: 220, after: 120 } },\n                },\n                {\n                    id: \"Heading5\",\n                    name: \"Heading 5\",\n                    basedOn: \"Normal\",\n                    next: \"Normal\",\n                    quickFormat: true,\n                    run: { font: FONTS.serif, bold: true, color: COLORS.text, size: SIZES.h5 },\n                    paragraph: { spacing: { before: 200, after: 100 } },\n                },\n                {\n                    id: \"Heading6\",\n                    name: \"Heading 6\",\n                    basedOn: \"Normal\",\n                    next: \"Normal\",\n                    quickFormat: true,\n                    run: { font: FONTS.serif, bold: true, color: COLORS.text, size: SIZES.h6 },\n                    paragraph: { spacing: { before: 180, after: 100 } },\n                },\n            ],\n        },\n        numbering: {\n            config: [\n                {\n                    reference: ORDERED_LIST_REF,\n                    levels: [\n                        {\n                            level: 0,\n                            format: LevelFormat.DECIMAL,\n                            text: \"%1.\",\n                            alignment: AlignmentType.LEFT,\n                        },\n                        {\n                            level: 1,\n                            format: LevelFormat.LOWER_LETTER,\n                            text: \"%2.\",\n                            alignment: AlignmentType.LEFT,\n                        },\n                        {\n                            level: 2,\n                            format: LevelFormat.LOWER_ROMAN,\n                            text: \"%3.\",\n                            alignment: AlignmentType.LEFT,\n                        },\n                    ],\n                },\n            ],\n        },\n        sections: [{ children }],\n    });\n\n    // Improve justified text handling for soft line breaks (Shift+Enter equivalents)\n    // https://raw.githubusercontent.com/dolanmiu/docx/master/docs/usage/paragraph.md\n    try {\n        (doc as any).Settings?.addCompatibility?.()?.doNotExpandShiftReturn?.();\n    } catch {\n        // ignore\n    }\n\n    return await Packer.toBlob(doc);\n}\n\nexport async function createDocxBlobFromMarkdown(markdown: string, options: DocxExportOptions = {}): Promise<Blob> {\n    const html = await markdownToHtml(markdown ?? \"\");\n    return await createDocxBlobFromHtml(html, options);\n}\n\nexport async function downloadMarkdownAsDocx(markdown: string, options: DocxExportOptions = {}): Promise<void> {\n    const title = options.title || \"Document\";\n    const filename = options.filename || `${safeFilename(title)}.docx`;\n    const blob = await createDocxBlobFromMarkdown(markdown ?? \"\", options);\n    downloadBlob(blob, filename);\n}\n\nexport async function downloadHtmlAsDocx(html: string, options: DocxExportOptions = {}): Promise<void> {\n    const title = options.title || \"Document\";\n    const filename = options.filename || `${safeFilename(title)}.docx`;\n    const blob = await createDocxBlobFromHtml(html ?? \"\", options);\n    downloadBlob(blob, filename);\n}\n\n"],"names":["t","MathNode","heading","Document"],"mappings":"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"}