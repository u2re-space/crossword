{"version":3,"file":"UnifiedMessaging.js","sources":["../../src/com/config/Names.ts","../../src/com/core/UnifiedAIConfig.ts","../../src/com/core/ContentAssociations.ts","../../src/com/core/UnifiedMessaging.ts"],"sourcesContent":["/**\n * Centralized naming system for CrossWord application\n * Consolidates component names, channel names, route names, etc.\n */\n\n// ============================================================================\n// BROADCAST CHANNELS\n// ============================================================================\n\n/**\n * Broadcast channel names used throughout the application\n */\nexport const BROADCAST_CHANNELS = {\n    // Service Worker Channels (matching SW implementation)\n    SHARE_TARGET: 'rs-share-target',\n    TOAST: 'rs-toast',\n    CLIPBOARD: 'rs-clipboard',\n\n    // App Component Channels (for AppCommunicator)\n    WORK_CENTER: 'rs-workcenter',\n    MARKDOWN_VIEWER: 'rs-markdown-viewer',\n    SETTINGS: 'rs-settings',\n    GENERAL: 'rs-app-general',\n\n    // Unified Messaging Channels\n    MINIMAL_APP: 'minimal-app',\n    MAIN_APP: 'main-app',\n    FILE_EXPLORER: 'file-explorer',\n    PRINT_VIEWER: 'print-viewer',\n    SETTINGS_VIEWER: 'settings-viewer',\n    HISTORY_VIEWER: 'history-viewer',\n\n    // Additional channels used in routing\n    MARKDOWN_VIEWER_CHANNEL: 'markdown-viewer',\n    FILE_EXPLORER_CHANNEL: 'file-explorer',\n    SETTINGS_CHANNEL: 'settings',\n    HISTORY_CHANNEL: 'history',\n    PRINT_CHANNEL: 'print',\n\n    // Service Channels (new architecture)\n    SERVICE_WORKCENTER: 'rs-service-workcenter',\n    SERVICE_SETTINGS: 'rs-service-settings',\n    SERVICE_VIEWER: 'rs-service-viewer',\n    SERVICE_EXPLORER: 'rs-service-explorer',\n    SERVICE_AIRPAD: 'rs-service-airpad',\n    SERVICE_PRINT: 'rs-service-print',\n    SERVICE_HISTORY: 'rs-service-history',\n    SERVICE_EDITOR: 'rs-service-editor',\n    SERVICE_HOME: 'rs-service-home'\n} as const;\n\n// ============================================================================\n// COMPONENT/MODULE NAMES\n// ============================================================================\n\n/**\n * Component and module identifiers\n */\nexport const COMPONENTS = {\n    // Core Components\n    WORK_CENTER: 'workcenter',\n    MARKDOWN_VIEWER: 'markdown-viewer',\n    MARKDOWN_EDITOR: 'markdown-editor',\n    RICH_EDITOR: 'rich-editor',\n    SETTINGS: 'settings',\n    HISTORY: 'history',\n    FILE_PICKER: 'file-picker',\n    FILE_EXPLORER: 'file-explorer',\n\n    // Sub-components\n    WORKCENTER_CORE: 'workcenter-core',\n    BASIC_WORKCENTER: 'basic-workcenter',\n    BASIC_VIEWER: 'basic-viewer',\n    BASIC_EXPLORER: 'basic-explorer',\n    BASIC_SETTINGS: 'basic-settings',\n    BASIC_HISTORY: 'basic-history',\n    BASIC_PRINT: 'basic-print',\n\n    // New architecture views\n    AIRPAD: 'airpad',\n    HOME: 'home',\n    EDITOR: 'editor',\n    VIEWER: 'viewer',\n    EXPLORER: 'explorer',\n    PRINT: 'print'\n} as const;\n\n// ============================================================================\n// SHELL IDENTIFIERS\n// ============================================================================\n\n/**\n * Shell identifiers for boot/layout selection\n */\nexport const SHELLS = {\n    BASIC: 'basic',\n    FAINT: 'faint',\n    RAW: 'raw'\n} as const;\n\n/**\n * Style system identifiers\n */\nexport const STYLE_SYSTEMS = {\n    VEELA: 'veela',\n    BASIC: 'basic',\n    RAW: 'raw'\n} as const;\n\n// ============================================================================\n// API ENDPOINTS\n// ============================================================================\n\n/**\n * API endpoint paths\n */\nexport const API_ENDPOINTS = {\n    // Processing APIs\n    PROCESSING: '/api/processing',\n    ANALYZE: '/api/analyze',\n    TEST: '/api/test',\n    HEALTH: '/health',\n\n    // Asset proxies\n    PHOSPHOR_ICONS: '/assets/icons/phosphor',\n    ICON_PROXY: '/api/icon-proxy',\n\n    // Content APIs\n    SHARE_TARGET: '/share-target',\n    SHARE_TARGET_ALT: '/share_target',\n    LAUNCH_QUEUE: '/launch-queue',\n\n    // Internal SW APIs\n    SW_CONTENT: '/sw-content',\n    SW_CONTENT_AVAILABLE: '/sw-content/available',\n    CLIPBOARD_PENDING: '/clipboard/pending',\n    CLIPBOARD_CLEAR: '/clipboard/clear'\n} as const;\n\n// ============================================================================\n// ROUTE/HASH IDENTIFIERS\n// ============================================================================\n\n/**\n * Location hash identifiers for app navigation\n */\nexport const ROUTE_HASHES = {\n    // Basic app views\n    MARKDOWN_VIEWER: '#markdown-viewer',\n    MARKDOWN_EDITOR: '#markdown-editor',\n    RICH_EDITOR: '#rich-editor',\n    SETTINGS: '#settings',\n    HISTORY: '#history',\n    WORKCENTER: '#workcenter',\n    FILE_PICKER: '#file-picker',\n    FILE_EXPLORER: '#file-explorer',\n    PRINT: '#print',\n\n    // Work center specific hashes\n    WORKCENTER_FILES: '#workcenter-files',\n    WORKCENTER_TEXT: '#workcenter-text',\n    WORKCENTER_IMAGES: '#workcenter-images',\n    WORKCENTER_PROCESSING: '#workcenter-processing',\n\n    // Share target specific hashes\n    SHARE_TARGET_TEXT: '#share-target-text',\n    SHARE_TARGET_FILES: '#share-target-files',\n    SHARE_TARGET_URL: '#share-target-url',\n    SHARE_TARGET_IMAGE: '#share-target-image'\n} as const;\n\n// ============================================================================\n// DATABASE/STORAGE KEYS\n// ============================================================================\n\n/**\n * IndexedDB and LocalStorage key names\n */\nexport const STORAGE_KEYS = {\n    // Service Worker\n    SW_CACHE_KEYS: 'sw-cache-keys',\n    SW_CONTENT_CACHE: 'sw-content-cache',\n    SHARE_TARGET_DATA: 'share-target-data',\n    SHARE_TARGET_FILES: 'share-target-files',\n    CLIPBOARD_OPERATIONS: 'clipboard-operations',\n\n    // Frontend\n    WORKCENTER_STATE: 'rs-workcenter-state',\n    WORKCENTER_TEMPLATES: 'rs-workcenter-templates',\n    SETTINGS: 'rs-settings',\n    HISTORY: 'rs-history',\n\n    // Theme and UI\n    THEME_PREFERENCES: 'theme-preferences',\n    UI_STATE: 'ui-state'\n} as const;\n\n// ============================================================================\n// MESSAGE TYPES\n// ============================================================================\n\n/**\n * Message types used in broadcast channels and unified messaging\n */\nexport const MESSAGE_TYPES = {\n    // Service Worker Messages\n    SHARE_RECEIVED: 'share-received',\n    SHARE_RESULT: 'share-result',\n    AI_RESULT: 'ai-result',\n    CONTENT_CACHED: 'content-cached',\n    CONTENT_RECEIVED: 'content-received',\n\n    // Clipboard Messages\n    COPY: 'copy',\n    CLIPBOARD_READY: 'clipboard-ready',\n\n    // Work Center Messages\n    SHARE_TARGET_INPUT: 'share-target-input',\n    SHARE_TARGET_RESULT: 'share-target-result',\n    FILES_CHANGED: 'files-changed',\n\n    // Toast Messages\n    SHOW_TOAST: 'show-toast',\n\n    // Ping/Pong\n    PING: 'ping',\n    PONG: 'pong',\n\n    // Content Sharing\n    CONTENT_SHARE: 'content-share',\n    CONTENT_REQUEST: 'content-request'\n} as const;\n\n// ============================================================================\n// CONTENT TYPES AND CONTEXTS\n// ============================================================================\n\n/**\n * Content type identifiers\n */\nexport const CONTENT_TYPES = {\n    TEXT: 'text',\n    URL: 'url',\n    FILE: 'file',\n    IMAGE: 'image',\n    MARKDOWN: 'markdown',\n    HTML: 'html',\n    JSON: 'json',\n    PDF: 'pdf',\n    AUDIO: 'audio',\n    VIDEO: 'video',\n    OTHER: 'other'\n} as const;\n\n/**\n * Content context identifiers\n */\nexport const CONTENT_CONTEXTS = {\n    SHARE_TARGET: 'share-target',\n    LAUNCH_QUEUE: 'launch-queue',\n    PUSH_MESSAGE: 'push-message',\n    BACKGROUND_SYNC: 'background-sync',\n    CLIPBOARD: 'clipboard',\n    DRAG_DROP: 'drag-drop',\n    PASTE: 'paste'\n} as const;\n\n// ============================================================================\n// DESTINATION NAMES\n// ============================================================================\n\n/**\n * Destination identifiers for unified messaging\n */\nexport const DESTINATIONS = {\n    WORKCENTER: 'workcenter',\n    CLIPBOARD: 'clipboard',\n    MARKDOWN_VIEWER: 'markdown-viewer',\n    SETTINGS: 'settings',\n    HISTORY: 'history',\n    FILE_EXPLORER: 'file-explorer',\n    PRINT_VIEWER: 'print-viewer',\n    BASIC_APP: 'basic-app',\n    MAIN_APP: 'main-app'\n} as const;\n\n// ============================================================================\n// UTILITY FUNCTIONS\n// ============================================================================\n\n/**\n * Get broadcast channel name by component\n */\nexport function getChannelForComponent(component: string): string {\n    const channelMap: Record<string, string> = {\n        [COMPONENTS.WORK_CENTER]: BROADCAST_CHANNELS.WORK_CENTER,\n        [COMPONENTS.MARKDOWN_VIEWER]: BROADCAST_CHANNELS.MARKDOWN_VIEWER,\n        [COMPONENTS.SETTINGS]: BROADCAST_CHANNELS.SETTINGS,\n        [COMPONENTS.FILE_EXPLORER]: BROADCAST_CHANNELS.FILE_EXPLORER,\n        [COMPONENTS.WORKCENTER_CORE]: BROADCAST_CHANNELS.SHARE_TARGET,\n        [COMPONENTS.BASIC_WORKCENTER]: BROADCAST_CHANNELS.SHARE_TARGET,\n        'minimal-app': BROADCAST_CHANNELS.MINIMAL_APP,\n        'main-app': BROADCAST_CHANNELS.MAIN_APP\n    };\n\n    return channelMap[component] || BROADCAST_CHANNELS.GENERAL;\n}\n\n/**\n * Get route hash for component\n */\nexport function getHashForComponent(component: string): string {\n    const hashMap: Record<string, string> = {\n        [COMPONENTS.WORK_CENTER]: ROUTE_HASHES.WORKCENTER,\n        [COMPONENTS.MARKDOWN_VIEWER]: ROUTE_HASHES.MARKDOWN_VIEWER,\n        [COMPONENTS.MARKDOWN_EDITOR]: ROUTE_HASHES.MARKDOWN_EDITOR,\n        [COMPONENTS.RICH_EDITOR]: ROUTE_HASHES.RICH_EDITOR,\n        [COMPONENTS.SETTINGS]: ROUTE_HASHES.SETTINGS,\n        [COMPONENTS.HISTORY]: ROUTE_HASHES.HISTORY,\n        [COMPONENTS.FILE_PICKER]: ROUTE_HASHES.FILE_PICKER,\n        [COMPONENTS.FILE_EXPLORER]: ROUTE_HASHES.FILE_EXPLORER\n    };\n\n    return hashMap[component] || '#';\n}\n\n/**\n * Get storage key for component data\n */\nexport function getStorageKeyForComponent(component: string, dataType: string): string {\n    const keyMap: Record<string, Record<string, string>> = {\n        [COMPONENTS.WORK_CENTER]: {\n            state: STORAGE_KEYS.WORKCENTER_STATE,\n            templates: STORAGE_KEYS.WORKCENTER_TEMPLATES\n        },\n        [COMPONENTS.SETTINGS]: {\n            data: STORAGE_KEYS.SETTINGS\n        },\n        [COMPONENTS.HISTORY]: {\n            data: STORAGE_KEYS.HISTORY\n        }\n    };\n\n    return keyMap[component]?.[dataType] || `${component}-${dataType}`;\n}\n\n// ============================================================================\n// TYPE EXPORTS\n// ============================================================================\n\nexport type BroadcastChannelName = typeof BROADCAST_CHANNELS[keyof typeof BROADCAST_CHANNELS];\nexport type ComponentName = typeof COMPONENTS[keyof typeof COMPONENTS];\nexport type RouteHash = typeof ROUTE_HASHES[keyof typeof ROUTE_HASHES];\nexport type StorageKey = typeof STORAGE_KEYS[keyof typeof STORAGE_KEYS];\nexport type MessageType = typeof MESSAGE_TYPES[keyof typeof MESSAGE_TYPES];\nexport type ContentType = typeof CONTENT_TYPES[keyof typeof CONTENT_TYPES];\nexport type ContentContext = typeof CONTENT_CONTEXTS[keyof typeof CONTENT_CONTEXTS];\nexport type Destination = typeof DESTINATIONS[keyof typeof DESTINATIONS];\nexport type ShellName = typeof SHELLS[keyof typeof SHELLS];\nexport type StyleSystemName = typeof STYLE_SYSTEMS[keyof typeof STYLE_SYSTEMS];\nexport type ApiEndpoint = typeof API_ENDPOINTS[keyof typeof API_ENDPOINTS];\n\n// ============================================================================\n// SERVICE CHANNEL MAPPING\n// ============================================================================\n\n/**\n * Map service channel IDs to broadcast channel names\n */\nexport const SERVICE_CHANNEL_MAP: Record<string, string> = {\n    workcenter: BROADCAST_CHANNELS.SERVICE_WORKCENTER,\n    settings: BROADCAST_CHANNELS.SERVICE_SETTINGS,\n    viewer: BROADCAST_CHANNELS.SERVICE_VIEWER,\n    explorer: BROADCAST_CHANNELS.SERVICE_EXPLORER,\n    airpad: BROADCAST_CHANNELS.SERVICE_AIRPAD,\n    print: BROADCAST_CHANNELS.SERVICE_PRINT,\n    history: BROADCAST_CHANNELS.SERVICE_HISTORY,\n    editor: BROADCAST_CHANNELS.SERVICE_EDITOR,\n    home: BROADCAST_CHANNELS.SERVICE_HOME\n} as const;\n\n/**\n * Map view IDs to route hashes\n */\nexport const VIEW_ROUTE_MAP: Record<string, string> = {\n    workcenter: ROUTE_HASHES.WORKCENTER,\n    settings: ROUTE_HASHES.SETTINGS,\n    viewer: ROUTE_HASHES.MARKDOWN_VIEWER,\n    explorer: ROUTE_HASHES.FILE_EXPLORER,\n    airpad: '#airpad',\n    print: ROUTE_HASHES.PRINT,\n    history: ROUTE_HASHES.HISTORY,\n    editor: ROUTE_HASHES.MARKDOWN_EDITOR,\n    home: '#home'\n} as const;","/**\n * Unified AI Configuration and Instructions\n *\n * Centralizes all AI processing rules, instructions, and configurations\n * for consistent behavior across different entry points and modules.\n */\n\nimport type { RecognizeByInstructionsOptions } from '@rs-com/service/service/ProcessingData';\n\n// Import built-in AI instructions and templates\nimport {\n    AI_INSTRUCTIONS,\n    BUILT_IN_AI_ACTIONS,\n} from './BuiltInAI';\n\n// AI Processing Types\nexport type AIProcessingType =\n    | 'solve-and-answer'\n    | 'write-code'\n    | 'extract-css'\n    | 'recognize-content'\n    | 'convert-data'\n    | 'extract-entities'\n    | 'general-processing';\n\n// Content Processing Rules\nexport interface ProcessingRule {\n    type: AIProcessingType;\n    instruction: string;\n    options?: RecognizeByInstructionsOptions;\n    supportedContentTypes: string[];\n    priority: number;\n}\n\n// AI_INSTRUCTIONS imported from BuiltInAI module\n\n// Core content types\nexport type ContentType =\n    | 'file'\n    | 'blob'\n    | 'text'\n    | 'markdown'\n    | 'image'\n    | 'url'\n    | 'base64';\n\n// Content contexts (where content comes from)\nexport type ContentContext =\n    | 'share-target'\n    | 'launch-queue'\n    | 'paste'\n    | 'drag-drop'\n    | 'file-open'\n    | 'url-open'\n    | 'crx-snip'\n    | 'api-upload'\n    | 'initial-load'\n    | 'broadcast';\n\n// Content actions (what to do with the content)\nexport type ContentAction =\n    | 'view'          // Display in appropriate viewer\n    | 'edit'          // Open in editor\n    | 'attach'        // Attach to work center\n    | 'process'       // Process with AI\n    | 'save'          // Save to explorer\n    | 'print'         // Send to print\n    | 'clipboard';    // Copy to clipboard\n\n// Association override factors for content routing\nexport type AssociationOverrideFactor =\n    | 'explicit-workcenter'\n    | 'explicit-viewer'\n    | 'explicit-explorer'\n    | 'force-attachment'\n    | 'force-processing'\n    | 'bypass-default'\n    | 'user-action';\n\n// Unified Processing Configuration\nexport interface UnifiedProcessingConfig {\n    processingUrl: string;\n    contentAction: {\n        onResult: string;\n        onAccept: string;\n        doProcess: string;\n        openApp?: boolean;\n    };\n    supportedContentTypes?: string[];\n    defaultOverrideFactors?: AssociationOverrideFactor[];\n    associationOverrides?: Record<string, AssociationOverrideFactor[]>;\n}\n\n// Unified Processing Rules for different entry points\nexport const UNIFIED_PROCESSING_RULES: Record<string, UnifiedProcessingConfig> = {\n    \"share-target\": {\n        processingUrl: \"/api/processing\",\n        contentAction: {\n            onResult: \"write-clipboard\",\n            onAccept: \"attach-to-associated\",\n            doProcess: \"instantly\",\n            openApp: true\n        },\n        supportedContentTypes: [\"text\", \"markdown\", \"image\", \"url\"],\n        defaultOverrideFactors: [] // Use default associations\n    },\n    \"launch-queue\": {\n        processingUrl: \"/api/processing\",\n        contentAction: {\n            onResult: \"none\",\n            onAccept: \"attach-to-associated\",\n            doProcess: \"manually\",\n            openApp: true\n        },\n        supportedContentTypes: [\"file\", \"blob\", \"text\", \"markdown\", \"image\"],\n        defaultOverrideFactors: [] // Use default associations\n    },\n    \"crx-snip\": {\n        processingUrl: \"/api/processing\",\n        contentAction: {\n            onResult: \"write-clipboard\",\n            onAccept: \"attach-to-associated\",\n            doProcess: \"instantly\",\n            openApp: false // Don't open PWA for background processing\n        },\n        supportedContentTypes: [\"text\", \"image\"],\n        defaultOverrideFactors: [\"force-processing\"] // Force processing for CRX snips\n    },\n    \"paste\": {\n        processingUrl: \"/api/processing\",\n        contentAction: {\n            onResult: \"none\",\n            onAccept: \"attach-to-associated\",\n            doProcess: \"manually\",\n            openApp: false\n        },\n        supportedContentTypes: [\"text\", \"markdown\", \"image\"],\n        defaultOverrideFactors: [],\n        associationOverrides: {\n            // When user explicitly pastes and wants to process, override defaults\n            \"text\": [\"user-action\"],\n            \"markdown\": [\"user-action\"]\n        }\n    },\n    \"drop\": {\n        processingUrl: \"/api/processing\",\n        contentAction: {\n            onResult: \"none\",\n            onAccept: \"attach-to-associated\",\n            doProcess: \"manually\",\n            openApp: false\n        },\n        supportedContentTypes: [\"file\", \"blob\", \"text\", \"markdown\", \"image\"],\n        defaultOverrideFactors: [],\n        associationOverrides: {\n            // When user drops files explicitly, treat as user action\n            \"file\": [\"user-action\"],\n            \"blob\": [\"user-action\"]\n        }\n    },\n    \"button-attach-workcenter\": {\n        processingUrl: \"/api/processing\",\n        contentAction: {\n            onResult: \"none\",\n            onAccept: \"attach-to-workcenter\",\n            doProcess: \"manually\",\n            openApp: false\n        },\n        supportedContentTypes: [\"text\", \"markdown\", \"image\", \"file\"],\n        defaultOverrideFactors: [\"explicit-workcenter\"], // Always override to workcenter\n        associationOverrides: {\n            // Explicit button clicks always go to workcenter\n            \"markdown\": [\"explicit-workcenter\"], // Override default viewer association\n            \"text\": [\"explicit-workcenter\"],     // Override default viewer association\n            \"image\": [\"explicit-workcenter\"],    // Already goes to workcenter, but explicit\n            \"file\": [\"explicit-workcenter\"]      // Override file-explorer association\n        }\n    }\n};\n\n// Backward compatibility - keep the old format\nexport const processingRules = Object.fromEntries(\n    Object.entries(UNIFIED_PROCESSING_RULES).map(([key, config]) => [\n        key,\n        {\n            processingUrl: config.processingUrl,\n            contentAction: config.contentAction,\n            ...(config.supportedContentTypes && { supportedContentTypes: config.supportedContentTypes })\n        }\n    ])\n);\n\n// AI Processing Rules Configuration (auto-generated from BUILT_IN_AI_ACTIONS)\nconst AI_PROCESSING_TYPES: readonly AIProcessingType[] = [\n    'solve-and-answer',\n    'write-code',\n    'extract-css',\n    'recognize-content',\n    'convert-data',\n    'extract-entities',\n    'general-processing'\n] as const;\n\nconst toAIProcessingType = (id: string): AIProcessingType | null => {\n    const normalized = String(id || '').toLowerCase().replace(/_/g, '-') as AIProcessingType;\n    return (AI_PROCESSING_TYPES as readonly string[]).includes(normalized) ? normalized : null;\n};\n\nexport const PROCESSING_RULES: ProcessingRule[] = BUILT_IN_AI_ACTIONS\n    .map(action => {\n        const type = toAIProcessingType(action.id);\n        if (!type) return null;\n        return {\n            type,\n            instruction: AI_INSTRUCTIONS[action.instructionKey],\n            supportedContentTypes: action.supportedContentTypes,\n            priority: action.priority\n        } satisfies ProcessingRule;\n    })\n    .filter((v): v is ProcessingRule => Boolean(v));\n\n// Content Type Mappings\nexport const CONTENT_TYPE_MAPPINGS = {\n    // File extensions to MIME types\n    extensions: {\n        '.md': 'text/markdown',\n        '.markdown': 'text/markdown',\n        '.txt': 'text/plain',\n        '.html': 'text/html',\n        '.css': 'text/css',\n        '.js': 'application/javascript',\n        '.ts': 'application/typescript',\n        '.json': 'application/json',\n        '.xml': 'application/xml',\n        '.csv': 'text/csv',\n        '.pdf': 'application/pdf',\n        '.png': 'image/png',\n        '.jpg': 'image/jpeg',\n        '.jpeg': 'image/jpeg',\n        '.gif': 'image/gif',\n        '.svg': 'image/svg+xml',\n        '.webp': 'image/webp'\n    },\n\n    // MIME type to processing type mapping\n    mimeToProcessing: {\n        'text/markdown': 'general-processing',\n        'text/plain': 'general-processing',\n        'text/html': 'extract-css',\n        'text/css': 'extract-css',\n        'application/javascript': 'write-code',\n        'application/typescript': 'write-code',\n        'application/json': 'convert-data',\n        'application/xml': 'convert-data',\n        'text/csv': 'convert-data',\n        'application/pdf': 'recognize-content',\n        'image/png': 'recognize-content',\n        'image/jpeg': 'recognize-content',\n        'image/gif': 'recognize-content',\n        'image/svg+xml': 'extract-css',\n        'image/webp': 'recognize-content'\n    } as Record<string, AIProcessingType>\n};\n\n// Processing Configuration\nexport interface ProcessingConfig {\n    maxRetries: number;\n    timeoutMs: number;\n    enableCaching: boolean;\n    enableStreaming: boolean;\n    defaultLanguage: string;\n    supportedLanguages: string[];\n}\n\n// Default processing configuration\nexport const DEFAULT_PROCESSING_CONFIG: ProcessingConfig = {\n    maxRetries: 3,\n    timeoutMs: 30000,\n    enableCaching: true,\n    enableStreaming: false,\n    defaultLanguage: 'en',\n    supportedLanguages: ['en', 'es', 'fr', 'de', 'it', 'pt', 'ru', 'zh', 'ja', 'ko']\n};\n\n// Utility Functions\n\n/**\n * Get the appropriate processing rule for content type and operation\n */\nexport function getProcessingRule(\n    contentType: string,\n    requestedType?: AIProcessingType\n): ProcessingRule | null {\n    // If specific type requested, try to find it\n    if (requestedType) {\n        const rule = PROCESSING_RULES.find(r => r.type === requestedType);\n        if (rule && (rule.supportedContentTypes.includes(contentType) || rule.supportedContentTypes.includes('*'))) {\n            return rule;\n        }\n    }\n\n    // Otherwise, find best match based on content type and priority\n    const matchingRules = PROCESSING_RULES\n        .filter(rule => rule.supportedContentTypes.includes(contentType) || rule.supportedContentTypes.includes('*'))\n        .sort((a, b) => b.priority - a.priority);\n\n    return matchingRules[0] || null;\n}\n\n/**\n * Get MIME type from file extension\n */\nexport function getMimeTypeFromExtension(filename: string): string {\n    const extension = filename.toLowerCase().substring(filename.lastIndexOf('.'));\n    return CONTENT_TYPE_MAPPINGS.extensions[extension] || 'application/octet-stream';\n}\n\n/**\n * Get processing type from MIME type\n */\nexport function getProcessingTypeFromMime(mimeType: string): AIProcessingType {\n    return CONTENT_TYPE_MAPPINGS.mimeToProcessing[mimeType] || 'general-processing';\n}\n\n/**\n * Get processing type from file\n */\nexport function getProcessingTypeFromFile(file: File): AIProcessingType {\n    const mimeType = file.type || getMimeTypeFromExtension(file.name);\n    return getProcessingTypeFromMime(mimeType);\n}\n\n/**\n * Create processing options with defaults\n */\nexport function createProcessingOptions(\n    overrides: Partial<RecognizeByInstructionsOptions> = {}\n): RecognizeByInstructionsOptions {\n    // RecognizeByInstructionsOptions currently only supports instruction + verbosity/effort knobs.\n    // Keep this helper for forward compatibility, but only return supported keys.\n    return { ...overrides };\n}\n\n/**\n * Validate content for processing\n */\nexport function validateContentForProcessing(\n    content: any,\n    contentType: string\n): { valid: boolean; errors: string[] } {\n    const errors: string[] = [];\n\n    if (!content) {\n        errors.push('Content is required');\n    }\n\n    if (!contentType) {\n        errors.push('Content type is required');\n    }\n\n    // Type-specific validation\n    switch (contentType) {\n        case 'text':\n        case 'markdown':\n            if (typeof content !== 'string' || content.trim().length === 0) {\n                errors.push('Text content must be a non-empty string');\n            }\n            break;\n        case 'file':\n            if (!(content instanceof File)) {\n                errors.push('File content must be a File object');\n            }\n            break;\n        case 'blob':\n            if (!(content instanceof Blob)) {\n                errors.push('Blob content must be a Blob object');\n            }\n            break;\n        case 'base64':\n            if (typeof content !== 'string' || !content.match(/^data:[^;]+;base64,/)) {\n                errors.push('Base64 content must be a valid data URL');\n            }\n            break;\n    }\n\n    return {\n        valid: errors.length === 0,\n        errors\n    };\n}","import { CONTENT_TYPES } from \"@rs-com/config/Names\";\nimport {\n    UNIFIED_PROCESSING_RULES,\n    type AssociationOverrideFactor\n} from \"./UnifiedAIConfig\";\n\nexport type AssociationDestination =\n    | \"basic-viewer\"\n    | \"basic-workcenter\"\n    | \"basic-explorer\"\n    | \"markdown-viewer\"\n    | \"workcenter\"\n    | \"file-explorer\"\n    | \"unknown\";\n\nexport type AssociationIntent = {\n    contentType: string;\n    context?: string;\n    processingSource?: string;\n    overrideFactors?: string[];\n};\n\nexport type AssociationResolution = {\n    destination: AssociationDestination;\n    normalizedContentType: string;\n    overrideFactors: AssociationOverrideFactor[];\n};\n\nexport type AssociationPipelineResolution = AssociationResolution & {\n    pipeline: AssociationDestination[];\n};\n\nconst normalizeContentType = (t: string): string => {\n    const v = String(t || \"\").toLowerCase().trim();\n    if (!v) return CONTENT_TYPES.OTHER;\n\n    // Accept both unified types and free-form values.\n    if (v === \"md\") return CONTENT_TYPES.MARKDOWN;\n    if (v === \"markdown\") return CONTENT_TYPES.MARKDOWN;\n    if (v === \"txt\") return CONTENT_TYPES.TEXT;\n    if (v === \"text\") return CONTENT_TYPES.TEXT;\n    if (v === \"url\") return CONTENT_TYPES.URL;\n    if (v === \"image\") return CONTENT_TYPES.IMAGE;\n    if (v === \"file\" || v === \"blob\") return CONTENT_TYPES.FILE;\n    if (v === \"pdf\") return CONTENT_TYPES.PDF;\n    if (v === \"html\") return CONTENT_TYPES.HTML;\n    if (v === \"json\") return CONTENT_TYPES.JSON;\n    if (v === \"base64\") return CONTENT_TYPES.FILE;\n\n    // If it already matches one of our constants, keep it.\n    const known = new Set(Object.values(CONTENT_TYPES));\n    if (known.has(v as any)) return v;\n    return CONTENT_TYPES.OTHER;\n};\n\nconst coerceOverrideFactors = (factors: string[] | undefined): AssociationOverrideFactor[] => {\n    const out: AssociationOverrideFactor[] = [];\n    const list = Array.isArray(factors) ? factors : [];\n    for (const f of list) {\n        const v = String(f || \"\").trim() as AssociationOverrideFactor;\n        if (!v) continue;\n        out.push(v);\n    }\n    return out;\n};\n\nconst pickExplicitDestination = (factors: AssociationOverrideFactor[]): AssociationDestination | null => {\n    // Explicit routing overrides everything else (compat behavior).\n    if (factors.includes(\"explicit-explorer\")) return \"basic-explorer\";\n    if (factors.includes(\"explicit-workcenter\")) return \"basic-workcenter\";\n    if (factors.includes(\"explicit-viewer\")) return \"basic-viewer\";\n    return null;\n};\n\nconst defaultDestinationForType = (normalizedContentType: string): AssociationDestination => {\n    // Defaults are aligned with docs/architecture.md \"Data associations\".\n    switch (normalizedContentType) {\n        case CONTENT_TYPES.TEXT:\n        case CONTENT_TYPES.MARKDOWN:\n        case CONTENT_TYPES.HTML:\n        case CONTENT_TYPES.JSON:\n            return \"basic-viewer\";\n        case CONTENT_TYPES.URL:\n            // URLs are often processed/recognized; prefer workcenter.\n            return \"basic-workcenter\";\n        case CONTENT_TYPES.IMAGE:\n        case CONTENT_TYPES.PDF:\n        case CONTENT_TYPES.FILE:\n        case CONTENT_TYPES.OTHER:\n        default:\n            return \"basic-workcenter\";\n    }\n};\n\nconst mergeRuleOverrideFactors = (intent: AssociationIntent, normalizedContentType: string): AssociationOverrideFactor[] => {\n    const base = coerceOverrideFactors(intent.overrideFactors);\n    const src = String(intent.processingSource || \"\").trim();\n    if (!src) return base;\n\n    const rule = UNIFIED_PROCESSING_RULES[src];\n    if (!rule) return base;\n\n    const merged: AssociationOverrideFactor[] = [];\n    merged.push(...(rule.defaultOverrideFactors || []));\n    const perType = rule.associationOverrides?.[normalizedContentType] || rule.associationOverrides?.[String(intent.contentType || \"\")] || [];\n    merged.push(...perType);\n    merged.push(...base);\n    return merged;\n};\n\nexport function resolveAssociation(intent: AssociationIntent): AssociationResolution {\n    const normalizedContentType = normalizeContentType(intent.contentType);\n    const mergedFactors = mergeRuleOverrideFactors(intent, normalizedContentType);\n\n    const explicit = pickExplicitDestination(mergedFactors);\n    if (explicit) {\n        return { destination: explicit, normalizedContentType, overrideFactors: mergedFactors };\n    }\n\n    return {\n        destination: defaultDestinationForType(normalizedContentType),\n        normalizedContentType,\n        overrideFactors: mergedFactors\n    };\n}\n\nexport function resolveAssociationPipeline(intent: AssociationIntent): AssociationPipelineResolution {\n    const primary = resolveAssociation(intent);\n\n    const factors = primary.overrideFactors;\n    const pipeline: AssociationDestination[] = [];\n\n    // Allow explicit multi-targeting (composite behavior).\n    if (factors.includes(\"explicit-explorer\")) pipeline.push(\"basic-explorer\");\n    if (factors.includes(\"explicit-workcenter\")) pipeline.push(\"basic-workcenter\");\n    if (factors.includes(\"explicit-viewer\")) pipeline.push(\"basic-viewer\");\n\n    // If no explicit fan-out, default to primary only.\n    if (pipeline.length === 0) {\n        pipeline.push(primary.destination);\n    }\n\n    // Force attachment/processing can add workcenter as a secondary sink even when viewing.\n    if ((factors.includes(\"force-attachment\") || factors.includes(\"force-processing\")) && !pipeline.includes(\"basic-workcenter\")) {\n        pipeline.push(\"basic-workcenter\");\n    }\n\n    // De-duplicate while preserving order.\n    const unique: AssociationDestination[] = [];\n    for (const d of pipeline) {\n        if (!unique.includes(d)) unique.push(d);\n    }\n\n    return { ...primary, pipeline: unique };\n}\n\n","/**\n * Unified Messaging System for CrossWord\n * Extends fest/uniform messaging with app-specific configuration\n */\n\nimport {\n    UnifiedMessagingManager,\n    getUnifiedMessaging as getBaseMessaging,\n    sendMessage as baseSendMessage,\n    type UnifiedMessage,\n    type MessageHandler,\n    type WorkerChannelConfig,\n    type PipelineConfig,\n    type PipelineStage,\n    type UnifiedMessagingConfig\n} from 'fest/uniform';\n\nimport {\n    BROADCAST_CHANNELS,\n    CONTENT_TYPES,\n    DESTINATIONS,\n} from '@rs-com/config/Names';\n\nimport { resolveAssociation, resolveAssociationPipeline } from './ContentAssociations';\n\n// Re-export types for consumers\nexport type {\n    UnifiedMessage,\n    MessageHandler,\n    WorkerChannelConfig,\n    PipelineConfig,\n    PipelineStage,\n    UnifiedMessagingConfig\n};\n\n// ============================================================================\n// APP-SPECIFIC CHANNEL MAPPINGS\n// ============================================================================\n\nconst APP_CHANNEL_MAPPINGS: Record<string, string> = {\n    [DESTINATIONS.WORKCENTER]: BROADCAST_CHANNELS.WORK_CENTER,\n    [DESTINATIONS.CLIPBOARD]: BROADCAST_CHANNELS.CLIPBOARD,\n    [DESTINATIONS.MARKDOWN_VIEWER]: BROADCAST_CHANNELS.MARKDOWN_VIEWER,\n    [DESTINATIONS.SETTINGS]: BROADCAST_CHANNELS.SETTINGS,\n    [DESTINATIONS.FILE_EXPLORER]: BROADCAST_CHANNELS.FILE_EXPLORER,\n    [DESTINATIONS.PRINT_VIEWER]: BROADCAST_CHANNELS.PRINT_VIEWER\n};\n\n// ============================================================================\n// APP-SPECIFIC MESSAGING MANAGER\n// ============================================================================\n\nlet appMessagingInstance: UnifiedMessagingManager | null = null;\n\n/**\n * Get the app-configured UnifiedMessagingManager\n */\nexport function getUnifiedMessaging(): UnifiedMessagingManager {\n    if (!appMessagingInstance) {\n        appMessagingInstance = getBaseMessaging({\n            channelMappings: APP_CHANNEL_MAPPINGS,\n            queueOptions: {\n                dbName: 'CrossWordMessageQueue',\n                storeName: 'messages',\n                maxRetries: 3,\n                defaultExpirationMs: 24 * 60 * 60 * 1000 // 24 hours\n            },\n            pendingStoreOptions: {\n                storageKey: 'rs-unified-messaging-pending',\n                maxMessages: 200,\n                defaultTTLMs: 24 * 60 * 60 * 1000 // 24 hours\n            }\n        });\n    }\n    return appMessagingInstance;\n}\n\n// Singleton instance for backward compatibility\nexport const unifiedMessaging = getUnifiedMessaging();\n\n// ============================================================================\n// CONVENIENCE FUNCTIONS\n// ============================================================================\n\n/**\n * Send a message using the app-configured manager\n */\nexport function sendMessage(message: Omit<UnifiedMessage, 'id' | 'source'> & { source?: string }): Promise<boolean> {\n    return unifiedMessaging.sendMessage({\n        ...message,\n        source: message.source ?? 'unified-messaging'\n    } as UnifiedMessage);\n}\n\n/**\n * Register a handler using the app-configured manager\n */\nexport function registerHandler(destination: string, handler: MessageHandler): void {\n    unifiedMessaging.registerHandler(destination, handler);\n}\n\nexport function unregisterHandler(destination: string, handler: MessageHandler): void {\n    unifiedMessaging.unregisterHandler(destination, handler);\n}\n\n/**\n * Get a worker channel from the app manager\n */\nexport function getWorkerChannel(viewHash: string, workerName: string) {\n    return unifiedMessaging.getWorkerChannel(viewHash, workerName);\n}\n\n/**\n * Get a broadcast channel from the app manager\n */\nexport function getBroadcastChannel(channelName: string): BroadcastChannel {\n    return unifiedMessaging.getBroadcastChannel(channelName);\n}\n\n// ============================================================================\n// BACKWARD COMPATIBILITY FUNCTIONS\n// ============================================================================\n\nexport function sendToWorkCenter(data: unknown, options?: Record<string, unknown>): Promise<boolean> {\n    return sendMessage({\n        type: 'content-share',\n        source: 'unified-messaging',\n        destination: DESTINATIONS.WORKCENTER,\n        data,\n        metadata: options\n    });\n}\n\nexport function sendToClipboard(data: unknown, options?: Record<string, unknown>): Promise<boolean> {\n    return sendMessage({\n        type: 'clipboard-copy',\n        source: 'unified-messaging',\n        destination: DESTINATIONS.CLIPBOARD,\n        data,\n        metadata: options\n    });\n}\n\nexport function navigateToView(view: string): Promise<boolean> {\n    return sendMessage({\n        type: 'navigation',\n        source: 'unified-messaging',\n        destination: 'router',\n        data: { view },\n        metadata: { priority: 'high' }\n    });\n}\n\nexport function initializeComponent(componentId: string): UnifiedMessage[] {\n    return unifiedMessaging.initializeComponent(componentId);\n}\n\nexport function hasPendingMessages(destination: string): boolean {\n    return unifiedMessaging.hasPendingMessages(destination);\n}\n\nexport function enqueuePendingMessage(destination: string, message: UnifiedMessage): void {\n    const dest = String(destination ?? '').trim();\n    if (!dest || !message) return;\n    unifiedMessaging.enqueuePendingMessage(dest, message);\n}\n\nexport function registerComponent(componentId: string, destination: string): void {\n    unifiedMessaging.registerComponent(componentId, destination);\n}\n\n// ============================================================================\n// CONTENT PROCESSING (APP-SPECIFIC)\n// ============================================================================\n\nexport function processInitialContent(content: Record<string, unknown>): Promise<void> {\n    const contentType = String(content?.contentType ?? content?.type ?? CONTENT_TYPES.OTHER);\n    const resolved = resolveAssociationPipeline({\n        contentType,\n        context: content?.context as string | undefined,\n        processingSource: content?.processingSource as string | undefined,\n        overrideFactors: (content?.overrideFactors ?? content?.metadata?.overrideFactors) as string[] | undefined\n    });\n\n    const payload = content?.content ?? content?.data ?? content;\n    const meta = (content?.metadata ?? {}) as Record<string, unknown>;\n\n    const source = String(content?.source ?? meta?.source ?? 'content-association');\n    const tasks = resolved.pipeline.map((dest) => {\n        if (dest === \"basic-viewer\") {\n            return sendMessage({\n                type: 'content-view',\n                source,\n                destination: 'basic-viewer',\n                contentType: resolved.normalizedContentType,\n                data: {\n                    content: (payload as Record<string, unknown>)?.text ?? (payload as Record<string, unknown>)?.content ?? payload,\n                    text: (payload as Record<string, unknown>)?.text,\n                    filename: (payload as Record<string, unknown>)?.filename ?? meta?.filename,\n                },\n                metadata: {\n                    ...meta,\n                    overrideFactors: resolved.overrideFactors,\n                    context: content?.context,\n                    processingSource: content?.processingSource\n                }\n            });\n        }\n\n        if (dest === \"basic-explorer\") {\n            return sendMessage({\n                type: 'content-explorer',\n                source,\n                destination: 'basic-explorer',\n                contentType: resolved.normalizedContentType,\n                data: {\n                    action: 'save',\n                    ...(payload as Record<string, unknown>),\n                },\n                metadata: {\n                    ...meta,\n                    overrideFactors: resolved.overrideFactors,\n                    context: content?.context,\n                    processingSource: content?.processingSource\n                }\n            });\n        }\n\n        // Default: attach into workcenter\n        return sendMessage({\n            type: 'content-share',\n            source,\n            destination: 'basic-workcenter',\n            contentType: resolved.normalizedContentType,\n            data: payload,\n            metadata: {\n                ...meta,\n                overrideFactors: resolved.overrideFactors,\n                context: content?.context,\n                processingSource: content?.processingSource\n            }\n        });\n    });\n\n    return Promise.allSettled(tasks).then(() => {});\n}\n\n// ============================================================================\n// MESSAGE CREATION HELPERS\n// ============================================================================\n\nexport function createMessageWithOverrides(\n    type: string,\n    source: string,\n    contentType: string,\n    data: unknown,\n    overrideFactors: string[] = [],\n    processingSource?: string\n): UnifiedMessage {\n    const resolved = resolveAssociation({\n        contentType,\n        context: processingSource,\n        processingSource,\n        overrideFactors\n    });\n\n    return {\n        id: crypto.randomUUID(),\n        type,\n        source,\n        destination: resolved.destination === \"basic-viewer\"\n            ? 'basic-viewer'\n            : resolved.destination === \"basic-explorer\"\n                ? 'basic-explorer'\n                : 'basic-workcenter',\n        contentType,\n        data,\n        metadata: {\n            timestamp: Date.now(),\n            overrideFactors,\n            processingSource,\n            priority: 'normal'\n        }\n    };\n}\n"],"names":["getBaseMessaging"],"mappings":"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"}