{"version":3,"mappings":"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","names":["e"],"ignoreList":[],"sources":["../../src/frontend/items/CustomInstructionsPanel.ts","../../src/frontend/views/workcenter/index.ts"],"sourcesContent":["import { H } from \"fest/lure\";\nimport { observe } from \"fest/object\";\nimport { loadSettings } from \"@rs-com/config/Settings\";\nimport type { CustomInstruction } from \"@rs-com/config/SettingsTypes\";\nimport {\n    getCustomInstructions,\n    addInstruction,\n    addInstructions,\n    updateInstruction,\n    deleteInstruction,\n    setActiveInstruction,\n    DEFAULT_INSTRUCTION_TEMPLATES\n} from \"@rs-com/service/misc/CustomInstructions\";\nimport { showSuccess, showError } from \"./Toast\";\n\nexport type CustomInstructionsPanelOptions = {\n    onUpdate?: () => void;\n};\n\ntype PanelState = {\n    instructions: CustomInstruction[];\n    activeId: string;\n    editingId: string | null;\n    isAdding: boolean;\n};\n\nexport const createCustomInstructionsPanel = (opts: CustomInstructionsPanelOptions = {}): HTMLElement => {\n    const state = observe<PanelState>({\n        instructions: [],\n        activeId: \"\",\n        editingId: null,\n        isAdding: false\n    });\n\n    const root = H`<div class=\"custom-instructions-panel\">\n        <div class=\"cip-select-row\">\n            <label class=\"field-label\">Active instruction</label>\n            <select class=\"field-control cip-select\" data-action=\"select-active\">\n                <option value=\"\">None (use default)</option>\n            </select>\n        </div>\n\n        <div class=\"cip-list\" data-list></div>\n\n        <div class=\"cip-add-form\" data-add-form hidden>\n            <input type=\"text\" class=\"field-control cip-input\" data-field=\"label\" placeholder=\"Instruction label...\" />\n            <textarea class=\"field-control cip-textarea\" data-field=\"instruction\" placeholder=\"Enter your custom instruction...\" rows=\"4\"></textarea>\n            <div class=\"cip-form-actions\">\n                <button class=\"btn btn-primary btn-sm\" type=\"button\" data-action=\"save-new\">Add</button>\n                <button class=\"btn btn-sm\" type=\"button\" data-action=\"cancel-add\">Cancel</button>\n            </div>\n        </div>\n\n        <div class=\"cip-toolbar\">\n            <button class=\"btn btn-sm\" type=\"button\" data-action=\"add\">\n                <ui-icon icon=\"plus\"></ui-icon>\n                <span>Add Instruction</span>\n            </button>\n            <button class=\"btn btn-sm\" type=\"button\" data-action=\"add-templates\">\n                <ui-icon icon=\"file-text\"></ui-icon>\n                <span>Add Templates</span>\n            </button>\n        </div>\n    </div>` as HTMLElement;\n\n    const listEl = root.querySelector(\"[data-list]\") as HTMLElement;\n    const selectEl = root.querySelector(\"[data-action='select-active']\") as HTMLSelectElement;\n    const addFormEl = root.querySelector(\"[data-add-form]\") as HTMLElement;\n    const labelInput = root.querySelector(\"[data-field='label']\") as HTMLInputElement;\n    const instructionInput = root.querySelector(\"[data-field='instruction']\") as HTMLTextAreaElement;\n\n    const renderList = () => {\n        listEl.replaceChildren();\n\n        if (!state.instructions.length) {\n            listEl.append(H`<div class=\"cip-empty\">No custom instructions defined.</div>` as HTMLElement);\n            return;\n        }\n\n        for (const instr of state.instructions) {\n            const isEditing = state.editingId === instr.id;\n            const isActive = state.activeId === instr.id;\n\n            const item = H`<div class=\"cip-item ${isActive ? \"is-active\" : \"\"}\" data-id=\"${instr.id}\">\n                <div class=\"cip-item-header\">\n                    <span class=\"cip-item-label\">${instr.label}</span>\n                    <div class=\"cip-item-actions\">\n                        ${isActive\n                            ? H`<span class=\"cip-badge\">Active</span>`\n                            : H`<button class=\"btn btn-sm\" type=\"button\" data-action=\"activate\">Use</button>`\n                        }\n                        <button class=\"btn btn-sm\" type=\"button\" data-action=\"edit\">\n                            <ui-icon icon=\"pencil-simple\"></ui-icon>\n                        </button>\n                        <button class=\"btn btn-sm btn-danger\" type=\"button\" data-action=\"delete\">\n                            <ui-icon icon=\"trash\"></ui-icon>\n                        </button>\n                    </div>\n                </div>\n                ${isEditing\n                    ? H`<div class=\"cip-edit-form\">\n                        <input type=\"text\" class=\"field-control\" data-edit-field=\"label\" value=\"${instr.label}\" />\n                        <textarea class=\"field-control\" data-edit-field=\"instruction\" rows=\"4\">${instr.instruction}</textarea>\n                        <div class=\"cip-form-actions\">\n                            <button class=\"btn btn-primary btn-sm\" type=\"button\" data-action=\"save-edit\">Save</button>\n                            <button class=\"btn btn-sm\" type=\"button\" data-action=\"cancel-edit\">Cancel</button>\n                        </div>\n                    </div>`\n                    : H`<div class=\"cip-item-preview\">${truncate(instr.instruction, 150)}</div>`\n                }\n            </div>` as HTMLElement;\n\n            item.addEventListener(\"click\", (e) => {\n                const target = e.target as HTMLElement;\n                const action = target.closest(\"[data-action]\")?.getAttribute(\"data-action\");\n\n                if (action === \"activate\") {\n                    void setActiveInstruction(instr.id).then(() => {\n                        state.activeId = instr.id;\n                        renderList();\n                        updateSelect();\n                        showSuccess(\"Instruction activated\");\n                        opts.onUpdate?.();\n                    }).catch((e) => {\n                        console.error(\"[CustomInstructionsPanel] Failed to activate:\", e);\n                        showError(\"Failed to activate instruction\");\n                    });\n                }\n\n                if (action === \"edit\") {\n                    state.editingId = instr.id;\n                    renderList();\n                }\n\n                if (action === \"delete\") {\n                    if (confirm(`Delete \"${instr.label}\"?`)) {\n                        void deleteInstruction(instr.id).then(() => {\n                            state.instructions = state.instructions.filter(i => i.id !== instr.id);\n                            if (state.activeId === instr.id) state.activeId = \"\";\n                            renderList();\n                            updateSelect();\n                            showSuccess(\"Instruction deleted\");\n                            opts.onUpdate?.();\n                        }).catch((e) => {\n                            console.error(\"[CustomInstructionsPanel] Failed to delete:\", e);\n                            showError(\"Failed to delete instruction\");\n                        });\n                    }\n                }\n\n                if (action === \"save-edit\") {\n                    const labelEl = item.querySelector(\"[data-edit-field='label']\") as HTMLInputElement;\n                    const instrEl = item.querySelector(\"[data-edit-field='instruction']\") as HTMLTextAreaElement;\n\n                    void updateInstruction(instr.id, {\n                        label: labelEl.value.trim() || instr.label,\n                        instruction: instrEl.value.trim()\n                    }).then(() => {\n                        instr.label = labelEl.value.trim() || instr.label;\n                        instr.instruction = instrEl.value.trim();\n                        state.editingId = null;\n                        renderList();\n                        updateSelect();\n                        showSuccess(\"Instruction updated\");\n                        opts.onUpdate?.();\n                    }).catch((e) => {\n                        console.error(\"[CustomInstructionsPanel] Failed to update:\", e);\n                        showError(\"Failed to update instruction\");\n                    });\n                }\n\n                if (action === \"cancel-edit\") {\n                    state.editingId = null;\n                    renderList();\n                }\n            });\n\n            listEl.append(item);\n        }\n    };\n\n    const updateSelect = () => {\n        selectEl.replaceChildren();\n        selectEl.append(H`<option value=\"\">None (use default)</option>` as HTMLOptionElement);\n\n        for (const instr of state.instructions) {\n            const opt = H`<option value=\"${instr.id}\">${instr.label}</option>` as HTMLOptionElement;\n            if (instr.id === state.activeId) opt.selected = true;\n            selectEl.append(opt);\n        }\n    };\n\n    const truncate = (text: string, maxLen: number): string => {\n        if (!text || text.length <= maxLen) return text || \"\";\n        return text.slice(0, maxLen).trim() + \"â€¦\";\n    };\n\n    const loadData = async () => {\n        const settings = await loadSettings();\n        state.instructions = settings?.ai?.customInstructions || [];\n        state.activeId = settings?.ai?.activeInstructionId || \"\";\n        renderList();\n        updateSelect();\n    };\n\n    root.addEventListener(\"click\", (e) => {\n        const target = e.target as HTMLElement;\n        const action = target.closest(\"[data-action]\")?.getAttribute(\"data-action\");\n\n        if (action === \"add\") {\n            state.isAdding = true;\n            addFormEl.hidden = false;\n            labelInput.value = \"\";\n            instructionInput.value = \"\";\n            labelInput.focus();\n        }\n\n        if (action === \"cancel-add\") {\n            state.isAdding = false;\n            addFormEl.hidden = true;\n        }\n\n        if (action === \"save-new\") {\n            const label = labelInput.value.trim();\n            const instruction = instructionInput.value.trim();\n\n            if (!instruction) {\n                instructionInput.focus();\n                showError(\"Instruction text is required\");\n                return;\n            }\n\n            void addInstruction(label || \"Custom\", instruction).then((newInstr) => {\n                state.instructions.push(newInstr);\n                state.isAdding = false;\n                addFormEl.hidden = true;\n                renderList();\n                updateSelect();\n                showSuccess(\"Instruction added\");\n                opts.onUpdate?.();\n            }).catch((e) => {\n                console.error(\"[CustomInstructionsPanel] Failed to add:\", e);\n                showError(\"Failed to add instruction\");\n            });\n        }\n\n        if (action === \"add-templates\") {\n            const existingLabels = new Set(state.instructions.map(i => i.label));\n            const templatesToAdd = DEFAULT_INSTRUCTION_TEMPLATES.filter(t => !existingLabels.has(t.label));\n\n            if (!templatesToAdd.length) {\n                showError(\"All templates already added\");\n                return;\n            }\n\n            // Use bulk add to avoid race conditions\n            addInstructions(templatesToAdd.map(t => ({\n                label: t.label,\n                instruction: t.instruction,\n                enabled: t.enabled\n            }))).then((newInstrs) => {\n                state.instructions.push(...newInstrs);\n                renderList();\n                updateSelect();\n                showSuccess(`Added ${newInstrs.length} templates`);\n                opts.onUpdate?.();\n            }).catch((e) => {\n                console.error(\"[CustomInstructionsPanel] Failed to add templates:\", e);\n                showError(\"Failed to add templates\");\n            });\n        }\n    });\n\n    selectEl.addEventListener(\"change\", () => {\n        const newActiveId = selectEl.value || \"\";\n        void setActiveInstruction(newActiveId || null).then(() => {\n            state.activeId = newActiveId;\n            renderList();\n            if (newActiveId) {\n                showSuccess(\"Instruction activated\");\n            }\n            opts.onUpdate?.();\n        });\n    });\n\n    void loadData();\n\n    return root;\n};\n","/**\n * Work Center View\n *\n * Shell-agnostic AI work center component.\n * Provides file attachment, AI processing, and result management.\n */\n\nimport { H } from \"fest/lure\";\nimport { ref, observe, affected } from \"fest/object\";\nimport { loadAsAdopted, removeAdopted } from \"fest/dom\";\nimport type { View, ViewOptions, ViewLifecycle, ShellContext } from \"../../shells/types\";\nimport type { BaseViewOptions } from \"../types\";\nimport { createViewState, createLoadingElement } from \"../types\";\n\n// @ts-ignore - SCSS import\nimport workcenterStyles from \"./scss/_index.scss?inline\";\nimport { createCustomInstructionsPanel } from \"@rs-frontend/items/CustomInstructionsPanel\";\n\n// ============================================================================\n// WORKCENTER STATE\n// ============================================================================\n\ninterface WorkCenterState {\n    files: File[];\n    prompt: string;\n    results: Array<{ id: string; content: string; timestamp: number; ok: boolean }>;\n    processing: boolean;\n}\n\nconst STORAGE_KEY = \"rs-workcenter-state\";\n\n// ============================================================================\n// WORKCENTER OPTIONS\n// ============================================================================\n\nexport interface WorkCenterOptions extends BaseViewOptions {\n    /** Initial files to attach */\n    initialFiles?: File[];\n    /** Initial prompt */\n    initialPrompt?: string;\n    /** Callback when processing completes */\n    onProcessComplete?: (result: string) => void;\n    /** Callback when files change */\n    onFilesChange?: (files: File[]) => void;\n}\n\n// ============================================================================\n// WORKCENTER VIEW IMPLEMENTATION\n// ============================================================================\n\nexport class WorkCenterView implements View {\n    id = \"workcenter\" as const;\n    name = \"Work Center\";\n    icon = \"lightning\";\n\n    private options: WorkCenterOptions;\n    private shellContext?: ShellContext;\n    private element: HTMLElement | null = null;\n\n    private files = observe<File[]>([]);\n    private prompt = ref(\"\");\n    private results = observe<Array<{ id: string; content: string; timestamp: number; ok: boolean }>>([]);\n    private processing = ref(false);\n\n    private stateManager = createViewState<Partial<WorkCenterState>>(STORAGE_KEY);\n    private _sheet: CSSStyleSheet | null = null;\n\n    lifecycle: ViewLifecycle = {\n        onMount: () => this.onMount(),\n        onUnmount: () => this.onUnmount(),\n        onShow: () => this.onShow(),\n        onHide: () => this.onHide()\n    };\n\n    constructor(options: WorkCenterOptions = {}) {\n        this.options = options;\n        this.shellContext = options.shellContext;\n\n        // Load initial state\n        if (options.initialFiles) {\n            this.files.push(...options.initialFiles);\n        }\n        if (options.initialPrompt) {\n            this.prompt.value = options.initialPrompt;\n        }\n    }\n\n    render(options?: ViewOptions): HTMLElement {\n        if (options) {\n            this.options = { ...this.options, ...options };\n            this.shellContext = options.shellContext || this.shellContext;\n        }\n\n        this._sheet = loadAsAdopted(workcenterStyles) as CSSStyleSheet;\n\n        this.element = H`\n            <div class=\"view-workcenter\">\n                <div class=\"view-workcenter__main\">\n                    <div class=\"view-workcenter__input-area\">\n                    \n                        <div class=\"view-workcenter__results\" data-results>\n                            <div class=\"view-workcenter__results-header\">\n                                <h3>Results</h3>\n                            </div>\n                            <div class=\"view-workcenter__results-list\" data-results-list>\n                                <div class=\"view-workcenter__results-empty\">\n                                    <p>Results will appear here</p>\n                                </div>\n                            </div>\n                        </div>\n                        <div class=\"view-workcenter__prompt\">\n                            <textarea\n                                class=\"view-workcenter__prompt-input\"\n                                placeholder=\"Enter your prompt or instructions...\"\n                                data-prompt-input\n                            ></textarea>\n                            <button\n                                class=\"view-workcenter__process-btn\"\n                                data-action=\"process\"\n                                type=\"button\"\n                            >\n                                <ui-icon icon=\"brain\" icon-style=\"duotone\"></ui-icon>\n                                <span>Process</span>\n                            </button>\n                        </div>\n                    </div>\n                    <div class=\"view-workcenter__files\" data-files-zone data-action=\"add-files\">\n                        <div class=\"view-workcenter__files-header\">\n                            <h3>Attachments</h3>\n                            <span class=\"view-workcenter__file-count\" data-file-count>0 files</span>\n                        </div>\n                        <div class=\"view-workcenter__files-list\" data-files-list>\n                            <div class=\"view-workcenter__files-empty\">\n                                <ui-icon icon=\"paperclip\" icon-style=\"duotone\" size=\"32\"></ui-icon>\n                                <p>Drop files here or click to attach</p>\n                            </div>\n                        </div>\n                        <div class=\"view-workcenter__files-actions\">\n                            <button class=\"view-workcenter__btn\" data-action=\"clear-files\" type=\"button\">\n                                <ui-icon icon=\"trash\" icon-style=\"duotone\"></ui-icon>\n                                <span>Clear</span>\n                            </button>\n                        </div>\n                    </div>\n                    ${createCustomInstructionsPanel({ onUpdate: () => this.updateResultsList() })}\n \n                </div>\n            </div>\n        ` as HTMLElement;\n\n        this.setupEventHandlers();\n        this.setupDragDrop();\n        this.updateFilesList();\n        this.updateResultsList();\n\n        // Reactive updates\n        affected(this.files as any, () => {\n            this.updateFilesList();\n            this.options.onFilesChange?.(this.files);\n        });\n\n        affected(this.results as any, () => {\n            this.updateResultsList();\n        });\n\n        return this.element;\n    }\n\n    getToolbar(): HTMLElement | null {\n        return null; // Uses embedded toolbar\n    }\n\n    // ========================================================================\n    // PUBLIC API\n    // ========================================================================\n\n    /**\n     * Add files to the work center\n     */\n    addFiles(files: File[]): void {\n        this.files.push(...files);\n    }\n\n    /**\n     * Set the prompt\n     */\n    setPrompt(prompt: string): void {\n        this.prompt.value = prompt;\n        const input = this.element?.querySelector(\"[data-prompt-input]\") as HTMLTextAreaElement;\n        if (input) input.value = prompt;\n    }\n\n    /**\n     * Get current files\n     */\n    getFiles(): File[] {\n        return [...this.files];\n    }\n\n    // ========================================================================\n    // PRIVATE METHODS\n    // ========================================================================\n\n    private setupEventHandlers(): void {\n        if (!this.element) return;\n\n        this.element.addEventListener(\"click\", async (e) => {\n            const target = e.target as HTMLElement;\n            const button = target.closest(\"[data-action]\") as HTMLButtonElement | null;\n            if (!button) return;\n\n            const action = button.dataset.action;\n            switch (action) {\n                case \"add-files\":\n                    this.handleAddFiles();\n                    break;\n                case \"clear-files\":\n                    this.handleClearFiles();\n                    break;\n                case \"process\":\n                    await this.handleProcess();\n                    break;\n            }\n        });\n\n        const promptInput = this.element.querySelector(\"[data-prompt-input]\") as HTMLTextAreaElement;\n        if (promptInput) {\n            promptInput.addEventListener(\"input\", () => {\n                this.prompt.value = promptInput.value;\n            });\n        }\n    }\n\n    private setupDragDrop(): void {\n        const filesZone = this.element?.querySelector(\"[data-files-zone]\");\n        if (!filesZone) return;\n\n        filesZone.addEventListener(\"dragover\", (e) => {\n            e.preventDefault();\n            filesZone.classList.add(\"dragover\");\n        });\n\n        filesZone.addEventListener(\"dragleave\", () => {\n            filesZone.classList.remove(\"dragover\");\n        });\n\n        filesZone.addEventListener(\"drop\", (e) => {\n            e.preventDefault();\n            filesZone.classList.remove(\"dragover\");\n\n            const files = Array.from((e as DragEvent).dataTransfer?.files || []);\n            if (files.length > 0) {\n                this.addFiles(files);\n                this.showMessage(`Added ${files.length} file(s)`);\n            }\n        });\n    }\n\n    private handleAddFiles(): void {\n        const input = document.createElement(\"input\");\n        input.type = \"file\";\n        input.multiple = true;\n        input.onchange = () => {\n            const files = Array.from(input.files || []);\n            if (files.length > 0) {\n                this.addFiles(files);\n                this.showMessage(`Added ${files.length} file(s)`);\n            }\n        };\n        input.click();\n    }\n\n    private handleClearFiles(): void {\n        this.files.length = 0;\n        this.showMessage(\"Files cleared\");\n    }\n\n    private async handleProcess(): Promise<void> {\n        if (this.processing.value) return;\n        if (this.files.length === 0 && !this.prompt.value.trim()) {\n            this.showMessage(\"Add files or enter a prompt\");\n            return;\n        }\n\n        this.processing.value = true;\n        this.showMessage(\"Processing...\");\n\n        try {\n            // Dynamic import of AI processing\n            const { recognizeByInstructions } = await import(\"@rs-com/service/service/RecognizeData\");\n\n            // Build input from files and prompt\n            const input = [\n                {\n                    role: \"user\",\n                    content: this.prompt.value || \"Process the attached files\"\n                }\n            ];\n\n            const result = await recognizeByInstructions(input, \"Process the content and provide a structured response.\");\n\n            const resultEntry = {\n                id: crypto.randomUUID(),\n                content: result?.data ? String(result.data) : \"No result\",\n                timestamp: Date.now(),\n                ok: Boolean(result?.ok)\n            };\n\n            this.results.push(resultEntry);\n            this.options.onProcessComplete?.(resultEntry.content);\n            this.showMessage(\"Processing complete\");\n\n        } catch (error) {\n            console.error(\"[WorkCenter] Processing failed:\", error);\n            this.results.push({\n                id: crypto.randomUUID(),\n                content: `Error: ${String(error)}`,\n                timestamp: Date.now(),\n                ok: false\n            });\n            this.showMessage(\"Processing failed\");\n        } finally {\n            this.processing.value = false;\n        }\n    }\n\n    private updateFilesList(): void {\n        const list = this.element?.querySelector(\"[data-files-list]\");\n        const count = this.element?.querySelector(\"[data-file-count]\");\n        if (!list) return;\n\n        if (count) {\n            count.textContent = `${this.files.length} file(s)`;\n        }\n\n        if (this.files.length === 0) {\n            list.innerHTML = `\n                <div class=\"view-workcenter__files-empty\">\n                    <ui-icon icon=\"paperclip\" icon-style=\"duotone\" size=\"32\"></ui-icon>\n                    <p>Drop files here or click to attach</p>\n                </div>\n            `;\n            return;\n        }\n\n        list.innerHTML = \"\";\n        for (const file of this.files) {\n            const item = H`\n                <div class=\"view-workcenter__file-item\">\n                    <ui-icon icon=\"file\" icon-style=\"duotone\"></ui-icon>\n                    <span class=\"view-workcenter__file-name\">${file.name}</span>\n                    <span class=\"view-workcenter__file-size\">${this.formatSize(file.size)}</span>\n                    <button class=\"view-workcenter__file-remove\" data-remove=\"${file.name}\" type=\"button\">\n                        <ui-icon icon=\"x\" icon-style=\"bold\" size=\"12\"></ui-icon>\n                    </button>\n                </div>\n            ` as HTMLElement;\n\n            item.querySelector(\"[data-remove]\")?.addEventListener(\"click\", () => {\n                const index = this.files.findIndex(f => f.name === file.name);\n                if (index >= 0) {\n                    this.files.splice(index, 1);\n                }\n            });\n\n            list.appendChild(item);\n        }\n    }\n\n    private updateResultsList(): void {\n        const list = this.element?.querySelector(\"[data-results-list]\");\n        if (!list) return;\n\n        if (this.results.length === 0) {\n            list.innerHTML = `\n                <div class=\"view-workcenter__results-empty\">\n                    <p>Results will appear here</p>\n                </div>\n            `;\n            return;\n        }\n\n        list.innerHTML = \"\";\n        for (const result of [...this.results].reverse()) {\n            const item = H`\n                <div class=\"view-workcenter__result-item ${result.ok ? '' : 'error'}\">\n                    <div class=\"view-workcenter__result-header\">\n                        <span class=\"view-workcenter__result-time\">${new Date(result.timestamp).toLocaleTimeString()}</span>\n                        <button class=\"view-workcenter__result-copy\" data-copy=\"${result.id}\" type=\"button\">\n                            <ui-icon icon=\"copy\" icon-style=\"duotone\" size=\"14\"></ui-icon>\n                        </button>\n                    </div>\n                    <div class=\"view-workcenter__result-content\">${result.content}</div>\n                </div>\n            ` as HTMLElement;\n\n            item.querySelector(\"[data-copy]\")?.addEventListener(\"click\", async () => {\n                try {\n                    await navigator.clipboard.writeText(result.content);\n                    this.showMessage(\"Copied to clipboard\");\n                } catch {\n                    this.showMessage(\"Failed to copy\");\n                }\n            });\n\n            list.appendChild(item);\n        }\n    }\n\n    private formatSize(bytes: number): string {\n        if (bytes < 1024) return `${bytes} B`;\n        if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n        return `${(bytes / 1024 / 1024).toFixed(1)} MB`;\n    }\n\n    private showMessage(message: string): void {\n        this.shellContext?.showMessage(message);\n    }\n\n    // ========================================================================\n    // LIFECYCLE\n    // ========================================================================\n\n    private onMount(): void {\n        console.log(\"[WorkCenter] Mounted\");\n        this._sheet ??= loadAsAdopted(workcenterStyles) as CSSStyleSheet;\n    }\n\n    private onUnmount(): void {\n        console.log(\"[WorkCenter] Unmounting\");\n        removeAdopted(this._sheet!);\n    }\n\n    private onShow(): void {\n        this._sheet ??= loadAsAdopted(workcenterStyles) as CSSStyleSheet;\n        console.log(\"[WorkCenter] Shown\");\n    }\n\n    private onHide(): void {\n        //removeAdopted(this._sheet);\n        console.log(\"[WorkCenter] Hidden\");\n    }\n\n    // ========================================================================\n    // MESSAGE HANDLING\n    // ========================================================================\n\n    canHandleMessage(messageType: string): boolean {\n        return [\n            \"content-attach\",\n            \"content-process\",\n            \"file-attach\",\n            \"share-target-input\",\n            \"content-share\"\n        ].includes(messageType);\n    }\n\n    async handleMessage(message: unknown): Promise<void> {\n        const msg = message as {\n            type?: string;\n            data?: { file?: File; files?: File[]; text?: string; content?: string; url?: string };\n        };\n\n        if (msg.data?.file) {\n            this.addFiles([msg.data.file]);\n        }\n        if (msg.data?.files) {\n            this.addFiles(msg.data.files);\n        }\n        if (msg.data?.text || msg.data?.content || msg.data?.url) {\n            const prompt = msg.data.text || msg.data.content || msg.data.url || \"\";\n            if (prompt.trim()) {\n                this.setPrompt(prompt);\n            }\n        }\n    }\n}\n\n// ============================================================================\n// FACTORY\n// ============================================================================\n\nexport function createView(options?: WorkCenterOptions): WorkCenterView {\n    return new WorkCenterView(options);\n}\n\n/** Alias for createView */\nexport const createWorkCenterView = createView;\n\nexport default createView;\n"],"file":"index15.js"}