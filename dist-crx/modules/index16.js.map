{"version":3,"mappings":"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","names":["MAX_RASTER_SIZE","MIN_RASTER_SIZE","isOPFSSupported","styles","url","preloadStyle","__decorateClass","styled","renderTabName","addPartProperty","clamp","TabChangedEvent","__publicField","box","UIElement","fmCss"],"ignoreList":[],"sources":["../../../../modules/projects/icon.ts/src/loader/OPFSCache.ts","../../../../modules/projects/icon.ts/src/loader/CSSIconRegistry.ts","../../../../modules/projects/icon.ts/src/loader/Loader.ts","../../../../modules/projects/icon.ts/src/loader/Phosphor.ts","../../../../modules/projects/fl.ui/src/styles/index.veela-basic.ts","../../../../modules/projects/fl.ui/src/ui/base/UIElement.ts","../../../../modules/projects/fl.ui/src/ui/navigation/misc/TaskStateReflect.ts","../../../../modules/projects/fl.ui/src/ui/components/containers/window/WindowFrame.ts","../../../../modules/projects/fl.ui/src/ui/components/containers/tabbed-box/TabbedBox.ts","../../../../modules/projects/fl.ui/src/ui/components/containers/box-with-sidebar/BoxWithSidebar.ts","../../../../modules/projects/fl.ui/src/ui/components/containers/tabbed-with-sidebar/TabbedSidebar.ts","../../../../modules/projects/fl.ui/src/ui/components/inputs/slider/Slider.ts","../../../../modules/projects/fl.ui/src/ui/components/inputs/text/Text.ts","../../../../modules/projects/fl.ui/src/ui/navigation/statusbar/StatusBar.ts","../../../../modules/projects/fl.ui/src/ui/navigation/taskbar/element/TaskBar.ts","../../../../modules/projects/fl.ui/src/ui/navigation/taskbar/element/Task.ts","../../../../modules/projects/fl.ui/src/ui/navigation/misc/TaskInteraction.ts","../../../../modules/projects/fl.ui/src/ui/navigation/misc/TaskIndication.ts","../../../../modules/projects/fl.ui/src/ui/navigation/appearance/Desktop.ts","../../../../modules/projects/fl.ui/src/ui/navigation/appearance/Mobile.ts","../../../../modules/projects/fl.ui/src/services/file-manager/Operative.ts","../../../../modules/projects/fl.ui/src/services/file-manager/ContextMenu.ts","../../../../modules/projects/fl.ui/src/services/file-manager/utils.ts","../../../../modules/projects/fl.ui/src/services/file-manager/FileManagerContent.ts","../../../../modules/projects/fl.ui/src/services/file-manager/FileManager.ts","../../../../modules/projects/fl.ui/src/index.ts"],"sourcesContent":["/**\n * OPFS (Origin Private File System) Icon Cache\n *\n * Provides persistent caching for:\n * - Vector SVG icon files (reduces network fetches)\n * - Rasterized mask images (reduces canvas operations)\n */\n\nconst CACHE_VERSION = 2; // Increment to invalidate old caches\nconst ROOT_DIR_NAME = \"icon-cache\";\nconst VECTOR_DIR = \"vector\";\nconst RASTER_DIR = \"raster\";\nconst META_FILE = \".cache-meta.json\";\nconst MAX_CACHE_AGE_MS = 7 * 24 * 60 * 60 * 1000; // 7 days\nconst MAX_CACHE_SIZE_BYTES = 50 * 1024 * 1024; // 50MB\n\ntype CacheMeta = {\n    version: number;\n    created: number;\n    lastAccess: number;\n};\n\nlet rootHandle: FileSystemDirectoryHandle | null = null;\nlet vectorDirHandle: FileSystemDirectoryHandle | null = null;\nlet rasterDirHandle: FileSystemDirectoryHandle | null = null;\nlet isSupported: boolean | null = null;\nlet initPromise: Promise<boolean> | null = null;\n\n/**\n * Checks if OPFS is supported in current environment\n */\nexport const isOPFSSupported = (): boolean => {\n    if (isSupported !== null) return isSupported;\n\n    try {\n        isSupported = !!(\n            typeof navigator !== \"undefined\" &&\n            \"storage\" in navigator &&\n            typeof navigator.storage?.getDirectory === \"function\" &&\n            typeof FileSystemFileHandle !== \"undefined\" &&\n            typeof FileSystemDirectoryHandle !== \"undefined\"\n        );\n    } catch {\n        isSupported = false;\n    }\n\n    return isSupported;\n};\n\n/**\n * Sanitizes a cache key to be a valid filename\n */\nconst sanitizeKey = (key: string): string => {\n    if (!key || typeof key !== \"string\") return \"_empty_\";\n    return key\n        .replace(/[<>:\"/\\\\|?*\\x00-\\x1F]/g, \"_\")\n        .replace(/\\.{2,}/g, \"_\")\n        .replace(/^\\./, \"_\")\n        .slice(0, 200);\n};\n\n/**\n * Initializes the OPFS cache directories\n */\nexport const initOPFSCache = async (): Promise<boolean> => {\n    if (initPromise) return initPromise;\n\n    initPromise = (async (): Promise<boolean> => {\n        if (!isOPFSSupported()) return false;\n\n        try {\n            const storageRoot = await navigator.storage.getDirectory();\n            rootHandle = await storageRoot.getDirectoryHandle(ROOT_DIR_NAME, { create: true });\n\n            // Check cache version and clear if outdated\n            const meta = await readCacheMeta();\n            const now = Date.now();\n\n            if (meta && meta.version !== CACHE_VERSION) {\n                if (typeof console !== \"undefined\") {\n                    console.log?.(\"[icon-cache] Cache version mismatch, clearing cache\");\n                }\n                await clearAllCache();\n            } else if (meta && (now - meta.lastAccess) > MAX_CACHE_AGE_MS) {\n                if (typeof console !== \"undefined\") {\n                    console.log?.(\"[icon-cache] Cache expired, clearing cache\");\n                }\n                await clearAllCache();\n            } else {\n                // Check cache size and clean up if too large\n                const stats = await getCacheStats();\n                if (stats && stats.totalSize > MAX_CACHE_SIZE_BYTES) {\n                    if (typeof console !== \"undefined\") {\n                        console.log?.(\"[icon-cache] Cache size exceeded, clearing cache\");\n                    }\n                    await clearAllCache();\n                }\n            }\n\n            // Create/get subdirectories\n            vectorDirHandle = await rootHandle.getDirectoryHandle(VECTOR_DIR, { create: true });\n            rasterDirHandle = await rootHandle.getDirectoryHandle(RASTER_DIR, { create: true });\n\n            // Write/update metadata\n            await writeCacheMeta();\n\n            return true;\n        } catch (error) {\n            if (typeof console !== \"undefined\") {\n                console.warn?.(\"[icon-cache] OPFS init failed:\", error);\n            }\n            rootHandle = null;\n            vectorDirHandle = null;\n            rasterDirHandle = null;\n            return false;\n        }\n    })();\n\n    return initPromise;\n};\n\n/**\n * Reads cache metadata\n */\nconst readCacheMeta = async (): Promise<CacheMeta | null> => {\n    if (!rootHandle) return null;\n\n    try {\n        const fileHandle = await rootHandle.getFileHandle(META_FILE);\n        const file = await fileHandle.getFile();\n        const text = await file.text();\n        return JSON.parse(text) as CacheMeta;\n    } catch {\n        return null;\n    }\n};\n\n/**\n * Writes cache metadata\n */\nconst writeCacheMeta = async (): Promise<void> => {\n    if (!rootHandle) return;\n\n    try {\n        const fileHandle = await rootHandle.getFileHandle(META_FILE, { create: true });\n        const writable = await fileHandle.createWritable();\n        const meta: CacheMeta = {\n            version: CACHE_VERSION,\n            created: Date.now(),\n            lastAccess: Date.now(),\n        };\n        await writable.write(JSON.stringify(meta));\n        await writable.close();\n    } catch {\n        /* silently fail */\n    }\n};\n\n/**\n * Stores a vector (SVG) icon in cache\n */\nexport const cacheVectorIcon = async (key: string, svgContent: string | Blob): Promise<boolean> => {\n    if (!vectorDirHandle) {\n        const ready = await initOPFSCache();\n        if (!ready || !vectorDirHandle) return false;\n    }\n\n    try {\n        const filename = sanitizeKey(key) + \".svg\";\n        const fileHandle = await vectorDirHandle!.getFileHandle(filename, { create: true });\n        const writable = await fileHandle.createWritable();\n\n        if (svgContent instanceof Blob) {\n            await writable.write(svgContent);\n        } else {\n            await writable.write(new Blob([svgContent], { type: \"image/svg+xml\" }));\n        }\n\n        await writable.close();\n        return true;\n    } catch (error) {\n        if (typeof console !== \"undefined\") {\n            console.warn?.(\"[icon-cache] Failed to cache vector:\", key, error);\n        }\n        return false;\n    }\n};\n\n/**\n * Retrieves a vector (SVG) icon from cache\n * Returns blob URL if found, null otherwise\n */\nexport const getCachedVectorIcon = async (key: string): Promise<string | null> => {\n    if (!vectorDirHandle) {\n        const ready = await initOPFSCache();\n        if (!ready || !vectorDirHandle) return null;\n    }\n\n    try {\n        const filename = sanitizeKey(key) + \".svg\";\n        const fileHandle = await vectorDirHandle!.getFileHandle(filename);\n        const file = await fileHandle.getFile();\n        return URL.createObjectURL(file);\n    } catch {\n        return null;\n    }\n};\n\n/**\n * Checks if a vector icon exists in cache\n */\nexport const hasVectorIcon = async (key: string): Promise<boolean> => {\n    if (!vectorDirHandle) {\n        const ready = await initOPFSCache();\n        if (!ready || !vectorDirHandle) return false;\n    }\n\n    try {\n        const filename = sanitizeKey(key) + \".svg\";\n        await vectorDirHandle!.getFileHandle(filename);\n        return true;\n    } catch {\n        return false;\n    }\n};\n\n/**\n * Stores a rasterized icon (PNG blob) in cache\n */\nexport const cacheRasterIcon = async (key: string, bucket: number, blob: Blob): Promise<boolean> => {\n    if (!rasterDirHandle) {\n        const ready = await initOPFSCache();\n        if (!ready || !rasterDirHandle) return false;\n    }\n\n    try {\n        const filename = `${sanitizeKey(key)}@${bucket}.png`;\n        const fileHandle = await rasterDirHandle!.getFileHandle(filename, { create: true });\n        const writable = await fileHandle.createWritable();\n        await writable.write(blob);\n        await writable.close();\n        return true;\n    } catch (error) {\n        if (typeof console !== \"undefined\") {\n            console.warn?.(\"[icon-cache] Failed to cache raster:\", key, error);\n        }\n        return false;\n    }\n};\n\n/**\n * Retrieves a rasterized icon from cache\n * Returns blob URL if found, null otherwise\n */\nexport const getCachedRasterIcon = async (key: string, bucket: number): Promise<string | null> => {\n    if (!rasterDirHandle) {\n        const ready = await initOPFSCache();\n        if (!ready || !rasterDirHandle) return null;\n    }\n\n    try {\n        const filename = `${sanitizeKey(key)}@${bucket}.png`;\n        const fileHandle = await rasterDirHandle!.getFileHandle(filename);\n        const file = await fileHandle.getFile();\n        return URL.createObjectURL(file);\n    } catch {\n        return null;\n    }\n};\n\n/**\n * Checks if a raster icon exists in cache\n */\nexport const hasRasterIcon = async (key: string, bucket: number): Promise<boolean> => {\n    if (!rasterDirHandle) {\n        const ready = await initOPFSCache();\n        if (!ready || !rasterDirHandle) return false;\n    }\n\n    try {\n        const filename = `${sanitizeKey(key)}@${bucket}.png`;\n        await rasterDirHandle!.getFileHandle(filename);\n        return true;\n    } catch {\n        return false;\n    }\n};\n\n/**\n * Removes a specific vector icon from cache\n */\nexport const removeVectorIcon = async (key: string): Promise<boolean> => {\n    if (!vectorDirHandle) return false;\n\n    try {\n        const filename = sanitizeKey(key) + \".svg\";\n        await vectorDirHandle.removeEntry(filename);\n        return true;\n    } catch {\n        return false;\n    }\n};\n\n/**\n * Removes a specific raster icon from cache\n */\nexport const removeRasterIcon = async (key: string, bucket: number): Promise<boolean> => {\n    if (!rasterDirHandle) return false;\n\n    try {\n        const filename = `${sanitizeKey(key)}@${bucket}.png`;\n        await rasterDirHandle.removeEntry(filename);\n        return true;\n    } catch {\n        return false;\n    }\n};\n\n/**\n * Clears all cached icons\n */\nexport const clearAllCache = async (): Promise<void> => {\n    if (!rootHandle) {\n        const ready = await initOPFSCache();\n        if (!ready || !rootHandle) return;\n    }\n\n    try {\n        // Remove subdirectories recursively\n        for await (const [name] of (rootHandle as any).entries()) {\n            if (name !== META_FILE) {\n                await rootHandle!.removeEntry(name, { recursive: true });\n            }\n        }\n\n        // Reset handles\n        vectorDirHandle = null;\n        rasterDirHandle = null;\n\n        // Reinitialize\n        initPromise = null;\n        await initOPFSCache();\n    } catch (error) {\n        if (typeof console !== \"undefined\") {\n            console.warn?.(\"[icon-cache] Failed to clear cache:\", error);\n        }\n    }\n};\n\n/**\n * Gets cache statistics\n */\nexport const getCacheStats = async (): Promise<{\n    vectorCount: number;\n    rasterCount: number;\n    totalSize: number;\n} | null> => {\n    if (!vectorDirHandle || !rasterDirHandle) {\n        const ready = await initOPFSCache();\n        if (!ready) return null;\n    }\n\n    try {\n        let vectorCount = 0;\n        let rasterCount = 0;\n        let totalSize = 0;\n\n        for await (const [, handle] of (vectorDirHandle as any).entries()) {\n            if (handle.kind === \"file\") {\n                vectorCount++;\n                const file = await (handle as FileSystemFileHandle).getFile();\n                totalSize += file.size;\n            }\n        }\n\n        for await (const [, handle] of (rasterDirHandle as any).entries()) {\n            if (handle.kind === \"file\") {\n                rasterCount++;\n                const file = await (handle as FileSystemFileHandle).getFile();\n                totalSize += file.size;\n            }\n        }\n\n        return { vectorCount, rasterCount, totalSize };\n    } catch {\n        return null;\n    }\n};\n\n/**\n * Validates and cleans up corrupted cache entries\n */\nexport const validateAndCleanCache = async (): Promise<void> => {\n    if (!vectorDirHandle || !rasterDirHandle) {\n        const ready = await initOPFSCache();\n        if (!ready) return;\n    }\n\n    const corruptedKeys: string[] = [];\n\n    try {\n        // Check vector icons\n        for await (const [name, handle] of (vectorDirHandle as any).entries()) {\n            if (handle.kind === \"file\" && name.endsWith('.svg')) {\n                try {\n                    const file = await (handle as FileSystemFileHandle).getFile();\n                    // Basic validation - check if file has content and starts with SVG tag\n                    if (file.size === 0) {\n                        corruptedKeys.push(`vector:${name}`);\n                        continue;\n                    }\n\n                    const text = await file.text();\n                    if (!text.trim().startsWith('<svg')) {\n                        corruptedKeys.push(`vector:${name}`);\n                    }\n                } catch {\n                    corruptedKeys.push(`vector:${name}`);\n                }\n            }\n        }\n\n        // Check raster icons\n        for await (const [name, handle] of (rasterDirHandle as any).entries()) {\n            if (handle.kind === \"file\" && (name.endsWith('.png') || name.endsWith('.webp'))) {\n                try {\n                    const file = await (handle as FileSystemFileHandle).getFile();\n                    if (file.size === 0) {\n                        corruptedKeys.push(`raster:${name}`);\n                    }\n                } catch {\n                    corruptedKeys.push(`raster:${name}`);\n                }\n            }\n        }\n\n        // Remove corrupted entries\n        for (const key of corruptedKeys) {\n            try {\n                const [type, filename] = key.split(':');\n                if (type === 'vector' && vectorDirHandle) {\n                    await vectorDirHandle.removeEntry(filename);\n                } else if (type === 'raster' && rasterDirHandle) {\n                    await rasterDirHandle.removeEntry(filename);\n                }\n            } catch {\n                /* ignore removal errors */\n            }\n        }\n\n        if (corruptedKeys.length > 0 && typeof console !== \"undefined\") {\n            console.log?.(`[icon-cache] Cleaned up ${corruptedKeys.length} corrupted cache entries`);\n        }\n    } catch (error) {\n        if (typeof console !== \"undefined\") {\n            console.warn?.(\"[icon-cache] Cache validation failed:\", error);\n        }\n    }\n};\n\n/**\n * Pre-initializes cache on module load (non-blocking)\n */\nif (isOPFSSupported()) {\n    initOPFSCache().then(() => {\n        // Validate cache after initialization\n        validateAndCleanCache().catch(() => {\n            /* silent validation failure */\n        });\n    }).catch(() => {\n        /* silent init failure */\n    });\n}\n\n","/**\n * CSS-based Icon Registry\n *\n * Instead of caching URLs in JavaScript Maps and setting inline styles,\n * this registry manages a shared stylesheet with attribute-based selectors\n * and image-set() for resolution-aware icon loading.\n *\n * CSS rules are generated lazily when icons are first requested.\n * Multiple icon instances share the same CSS rule automatically.\n */\n\n// Constants inlined to avoid circular dependency with Loader.ts\nconst MAX_RASTER_SIZE = 512;\nconst MIN_RASTER_SIZE = 32;\n\n// Icon style element reference\nlet iconStyleSheet: CSSStyleSheet | null = null;\nlet styleElement: HTMLStyleElement | null = null;\n\n// Track which icon+style+bucket combinations have rules\nconst registeredRules = new Set<string>();\n\n// Store actual rule data for persistence across refreshes\nconst registeredRuleData = new Map<string, { selector: string; cssText: string }>();\n\n// Persistent registry storage - survives page refreshes via localStorage\nconst PERSISTENT_REGISTRY_KEY = 'ui-icon-registry-state.v2';\nconst LEGACY_PERSISTENT_KEYS = ['ui-icon-registry-state'];\n\nconst extractFirstCssUrl = (cssText: string): string | null => {\n    if (!cssText || typeof cssText !== \"string\") return null;\n    const match = cssText.match(/url\\(\\s*(['\"]?)([^'\")\\s]+)\\1\\s*\\)/i);\n    return match?.[2] ?? null;\n};\n\nconst isPersistableRuleCssText = (cssText: string): boolean => {\n    const url = extractFirstCssUrl(cssText);\n    if (!url) { return false; }\n\n    // blob: URLs are not stable across refreshes\n    if (/^blob:/i.test(url)) { return false; }\n\n    // data: URLs are safe to persist\n    if (/^data:/i.test(url)) { return true; }\n\n    // For http(s), only persist if same-origin (cross-origin will trigger CORS issues in CSS fetch)\n    if (/^https?:/i.test(url)) {\n        try {\n            if (typeof location !== \"undefined\" && typeof URL === \"function\") {\n                return new URL(url).origin === location.origin;\n            }\n        } catch {\n            return false;\n        }\n        return false;\n    }\n\n    // Relative/same-origin paths are OK\n    return true;\n};\n\n// Pending rule insertions (batched for performance)\nlet pendingRules: Array<{ selector: string; cssText: string; key: string }> = [];\nlet flushScheduled = false;\n\nconst ICON_PROXY_PATH = \"/api/icon-proxy\";\nconst isChromeExtensionRuntime = (): boolean => {\n    try {\n        const chromeRuntime = (globalThis as any)?.chrome?.runtime;\n        return !!chromeRuntime?.id;\n    } catch {\n        return false;\n    }\n};\n\nconst tryRewriteCrossOriginUrlToProxy = (rawUrl: string): string | null => {\n    if (!rawUrl || typeof rawUrl !== \"string\") return null;\n    const trimmed = rawUrl.trim();\n    if (!trimmed) return null;\n\n    // data/blob are already safe in CSS.\n    if (/^(data:|blob:)/i.test(trimmed)) return trimmed;\n\n    // Relative URLs are same-origin.\n    if (/^(\\/|\\.\\/|\\.\\.\\/)/.test(trimmed)) return trimmed;\n\n    // Only rewrite absolute cross-origin URLs.\n    if (!/^https?:/i.test(trimmed)) return trimmed;\n\n    // In extension runtimes (popup/options/content-script), don't rewrite to /api.\n    // Such endpoint is app-specific and usually unavailable there.\n    if (isChromeExtensionRuntime()) return trimmed;\n\n    try {\n        if (typeof location === \"undefined\" || typeof URL !== \"function\") return trimmed;\n        const u = new URL(trimmed);\n        if (u.origin === location.origin) return trimmed;\n        return `${ICON_PROXY_PATH}?url=${encodeURIComponent(trimmed)}`;\n    } catch {\n        return null;\n    }\n};\n\nconst rewriteCssUrlFunctionValue = (cssValue: string): string | null => {\n    if (!cssValue || typeof cssValue !== \"string\") return null;\n    const match = cssValue.match(/url\\(\\s*(['\"]?)([^'\")\\s]+)\\1\\s*\\)/i);\n    if (!match) return cssValue;\n    const rewritten = tryRewriteCrossOriginUrlToProxy(match[2]);\n    if (!rewritten) return null;\n    return `url(\"${rewritten}\")`;\n};\n\n/**\n * Saves the registry state to localStorage for persistence across refreshes\n */\nconst saveRegistryState = (): void => {\n    if (typeof localStorage === 'undefined') return;\n\n    try {\n        const ruleData = Array.from(registeredRuleData.entries())\n            .filter(([, data]) => isPersistableRuleCssText(data.cssText))\n            .map(([key, data]) => ({\n                key,\n                selector: data.selector,\n                cssText: data.cssText\n            }));\n\n        const state = {\n            rules: ruleData,\n            timestamp: Date.now()\n        };\n        localStorage.setItem(PERSISTENT_REGISTRY_KEY, JSON.stringify(state));\n    } catch {\n        // Ignore localStorage errors\n    }\n};\n\n// Store pending rule restorations until stylesheet is available\nlet pendingRuleRestorations: Array<{ key: string; selector: string; cssText: string }> | null = null;\n\n/**\n * Loads the registry state from localStorage and prepares rules for restoration\n */\nconst loadRegistryState = (): void => {\n    if (typeof localStorage === 'undefined') return;\n\n    try {\n        // Clean legacy keys eagerly to avoid restoring unsafe old rules.\n        for (const legacyKey of LEGACY_PERSISTENT_KEYS) {\n            if (legacyKey !== PERSISTENT_REGISTRY_KEY) {\n                try { localStorage.removeItem(legacyKey); } catch { /* ignore */ }\n            }\n        }\n\n        const stored = localStorage.getItem(PERSISTENT_REGISTRY_KEY);\n        if (!stored) return;\n\n        const state = JSON.parse(stored);\n        if (state.rules && Array.isArray(state.rules)) {\n            // Only restore rules from the last 24 hours to avoid stale data\n            const age = Date.now() - (state.timestamp || 0);\n            if (age < 24 * 60 * 60 * 1000) {\n                // Store for later restoration when stylesheet is available\n                pendingRuleRestorations = state.rules.filter((r: any) => isPersistableRuleCssText(r?.cssText));\n                if (typeof console !== 'undefined') {\n                    console.log?.(`[icon-registry] Prepared ${pendingRuleRestorations.length} rules for restoration from cache`);\n                }\n            } else {\n                // Clear expired state\n                localStorage.removeItem(PERSISTENT_REGISTRY_KEY);\n            }\n        }\n    } catch {\n        // Ignore localStorage errors\n    }\n};\n\n/**\n * Restores pending rules to the stylesheet when it becomes available\n */\nconst restorePendingRules = (sheet: CSSStyleSheet): void => {\n    if (!pendingRuleRestorations) return;\n\n    let restoredCount = 0;\n    let skippedCount = 0;\n    pendingRuleRestorations.forEach((ruleData) => {\n        if (ruleData.key && ruleData.selector && ruleData.cssText && !registeredRules.has(ruleData.key)) {\n            if (!isPersistableRuleCssText(ruleData.cssText)) {\n                skippedCount++;\n                return;\n            }\n            try {\n                // Re-insert the rule into the stylesheet\n                const ruleText = `${ruleData.selector} { ${ruleData.cssText} }`;\n                sheet.insertRule(ruleText, sheet.cssRules.length);\n\n                // Restore the tracking data\n                registeredRules.add(ruleData.key);\n                registeredRuleData.set(ruleData.key, {\n                    selector: ruleData.selector,\n                    cssText: ruleData.cssText\n                });\n                restoredCount++;\n            } catch (e) {\n                if (typeof console !== 'undefined') {\n                    console.warn?.(`[icon-registry] Failed to restore rule ${ruleData.key}:`, e);\n                }\n            }\n        }\n    });\n\n    if (typeof console !== 'undefined' && (restoredCount > 0 || skippedCount > 0)) {\n        console.log?.(`[icon-registry] Restored ${restoredCount} CSS rules to stylesheet (skipped ${skippedCount} unsafe/unstable rules)`);\n    }\n\n    pendingRuleRestorations = null; // Clear after restoration\n};\n\n/**\n * Clears the persistent registry state\n */\nexport const clearRegistryState = (): void => {\n    registeredRules.clear();\n    registeredRuleData.clear();\n    pendingRules.length = 0;\n    flushScheduled = false;\n\n    // Reset stylesheet\n    if (iconStyleSheet && document.adoptedStyleSheets) {\n        const index = document.adoptedStyleSheets.indexOf(iconStyleSheet as CSSStyleSheet);\n        if (index !== -1) {\n            document.adoptedStyleSheets.splice(index, 1);\n        }\n    }\n    iconStyleSheet = null;\n    styleElement = null;\n\n    if (typeof localStorage !== 'undefined') {\n        localStorage.removeItem(PERSISTENT_REGISTRY_KEY);\n    }\n\n    if (typeof console !== 'undefined') {\n        console.log?.('[icon-registry] Registry state cleared');\n    }\n};\n\n/**\n * Reinitializes the registry - useful for page refreshes or when needing to reload all rules\n */\nexport const reinitializeRegistry = (): void => {\n    clearRegistryState();\n    ensureStyleSheet();\n\n    if (typeof console !== 'undefined') {\n        console.log?.('[icon-registry] Registry reinitialized');\n    }\n};\n\n/**\n * Gets or creates the shared icon stylesheet\n */\nexport const ensureStyleSheet = (): CSSStyleSheet | null => {\n    if (iconStyleSheet) return iconStyleSheet as CSSStyleSheet;\n    if (typeof document === \"undefined\") return null;\n\n    // Load persistent registry state on first access\n    if (registeredRules.size === 0) {\n        loadRegistryState();\n    }\n\n    // Check for existing style element\n    /*styleElement = document.querySelector<HTMLStyleElement>(\"style[data-icon-registry]\");\n\n    if (!styleElement) {\n        styleElement = document.createElement(\"style\");\n        styleElement.setAttribute(\"data-icon-registry\", \"true\");\n        // Insert early in head for lower specificity\n        const head = document.head || document.documentElement;\n        head.insertBefore(styleElement, head.firstChild);\n    }*/\n\n    iconStyleSheet = new CSSStyleSheet() as CSSStyleSheet;//styleElement.sheet;\n    document.adoptedStyleSheets?.push?.((iconStyleSheet as unknown as CSSStyleSheet));\n\n    //\n    iconStyleSheet.insertRule(`@property --icon-image { syntax: \"<image>\"; inherits: true; initial-value: linear-gradient(#0000, #0000); }`, iconStyleSheet.cssRules.length);\n    iconStyleSheet.insertRule(`:where(ui-icon), :host(ui-icon) { --icon-image: linear-gradient(#0000, #0000); }`, iconStyleSheet.cssRules.length);\n    iconStyleSheet.insertRule(`:where(ui-icon:not([icon])), :where(ui-icon[icon=\"\"]), :host(ui-icon:not([icon])), :host(ui-icon[icon=\"\"]) { background-color: transparent; }`, iconStyleSheet.cssRules.length);\n\n    // Restore any pending rules from localStorage\n    restorePendingRules(iconStyleSheet);\n\n    return iconStyleSheet as CSSStyleSheet;\n};\n\n/**\n * Generates the CSS rule key for deduplication\n */\nconst makeRuleKey = (iconName: string, iconStyle: string, bucket: number): string => {\n    return `${iconStyle}:${iconName}@${bucket}`;\n};\n\n/**\n * Creates image-set value for different resolutions\n * Uses the resolved URL with appropriate resolution descriptors\n */\nconst createImageSetCSS = (\n    url: string,\n    bucket: number,\n): string => {\n    if (!url) return \"linear-gradient(#0000, #0000)\";\n\n    // Build image-set with 1x and 2x variants\n    // The browser will pick the best resolution based on device pixel ratio\n    /*const parts: string[] = [];\n\n    // Base resolution\n    parts.push((url.startsWith(\"url(\") ? url : `url(\"${url}\")`) + \" 1x\");\n\n    // Higher density hint (same URL, browser handles scaling)\n    if (bucket <= MAX_RASTER_SIZE / 2) {\n        parts.push((url.startsWith(\"url(\") ? url : `url(\"${url}\")`) + \" 2x\");\n    }\n\n    return `image-set(${parts.join(\", \")})`;*/\n    // Ensure the CSS doesn't directly reference cross-origin https://... URLs,\n    // because CSS fetches are credentialed and many CDNs respond with ACAO=\"*\".\n    if (url.startsWith(\"url(\")) {\n        return rewriteCssUrlFunctionValue(url) ?? \"linear-gradient(#0000, #0000)\";\n    }\n    const rewritten = tryRewriteCrossOriginUrlToProxy(url);\n    return rewritten ? `url(\"${rewritten}\")` : \"linear-gradient(#0000, #0000)\";\n};\n\n/**\n * Generates the CSS selector for an icon\n * Uses attribute selectors for icon name and style\n */\nconst makeSelector = (iconName: string, iconStyle: string): string => {\n    // Validate and sanitize inputs\n    const safeName = (iconName || '').trim();\n    const safeStyle = (iconStyle || 'duotone').trim().toLowerCase();\n\n    if (!safeName) {\n        return ''; // Invalid selector\n    }\n\n    // Escape special characters in attribute values\n    const escapedName = CSS.escape(safeName);\n    const escapedStyle = CSS.escape(safeStyle);\n\n    // Match both class selector (.ui-icon) and :host selector for shadow DOM\n    return `.ui-icon[icon=\"${escapedName}\"][icon-style=\"${escapedStyle}\"], :host(.ui-icon[icon=\"${escapedName}\"][icon-style=\"${escapedStyle}\"])`;\n};\n\n/**\n * Flushes pending CSS rules in a single batch\n */\nconst flushPendingRules = () => {\n    flushScheduled = false;\n    if (pendingRules.length === 0) return;\n\n    const sheet = ensureStyleSheet();\n    if (!sheet) {\n        // Retry later if document not ready\n        pendingRules = [];\n        return;\n    }\n\n    const rulesToInsert = pendingRules.slice();\n    pendingRules = [];\n\n    for (const { selector, cssText, key } of rulesToInsert) {\n        if (registeredRules.has(key)) continue;\n\n        try {\n            const ruleText = `${selector} { ${cssText} }`;\n            sheet.insertRule(ruleText, sheet.cssRules.length);\n            registeredRules.add(key);\n\n            // Store the rule data for persistence\n            registeredRuleData.set(key, { selector, cssText });\n\n            // Save registry state after successful rule insertion\n            saveRegistryState();\n        } catch (e) {\n            if (typeof console !== \"undefined\") {\n                console.warn?.(\"[icon-registry] Failed to insert rule:\", e);\n            }\n        }\n    }\n};\n\n/**\n * Schedules a batch flush of pending rules\n */\nconst scheduleFlush = () => {\n    if (flushScheduled) return;\n    flushScheduled = true;\n    queueMicrotask(flushPendingRules);\n};\n\n/**\n * Registers an icon rule in the stylesheet\n * Rules are batched and deduplicated automatically\n */\nexport const registerIconRule = (\n    iconName: string,\n    iconStyle: string,\n    imageUrl: string,\n    bucket: number = MIN_RASTER_SIZE,\n): void => {\n    const key = makeRuleKey(iconName, iconStyle, bucket);\n\n    // Skip if already registered\n    if (registeredRules.has(key)) return;\n\n    // Skip if already pending\n    if (pendingRules.some(r => r.key === key)) return;\n\n    const selector = makeSelector(iconName, iconStyle);\n    const imageSetValue = createImageSetCSS(imageUrl, bucket);\n\n    // Queue the rule for batch insertion\n    pendingRules.push({\n        selector,\n        cssText: `--icon-image: ${imageSetValue};`,\n        key,\n    });\n\n    scheduleFlush();\n};\n\n/**\n * Registers multiple bucket sizes for an icon\n * Useful for responsive icons that need different resolutions\n */\nexport const registerIconRuleWithBuckets = (\n    iconName: string,\n    iconStyle: string,\n    imageUrl: string,\n    buckets: number[] = [32, 64, 128, 256],\n): void => {\n    for (const bucket of buckets) {\n        registerIconRule(iconName, iconStyle, imageUrl, bucket);\n    }\n};\n\n/**\n * Checks if an icon rule is already registered\n */\nexport const hasIconRule = (\n    iconName: string,\n    iconStyle: string,\n    bucket: number = MIN_RASTER_SIZE,\n): boolean => {\n    const key = makeRuleKey(iconName, iconStyle, bucket);\n    return registeredRules.has(key) || pendingRules.some(r => r.key === key);\n};\n\n/**\n * Generates a container query based rule for bucket sizing\n * This allows icons to automatically use the right resolution based on their size\n */\nexport const registerResponsiveIconRule = (\n    iconName: string,\n    iconStyle: string,\n    baseUrl: string,\n    bucketUrls: Map<number, string>,\n): void => {\n    const selector = makeSelector(iconName, iconStyle);\n\n    // Register base rule\n    registerIconRule(iconName, iconStyle, baseUrl, MIN_RASTER_SIZE);\n\n    // Add container-query based rules for different sizes\n    // Note: This requires the icon container to have container-type set\n    for (const [bucket, url] of bucketUrls) {\n        const key = `${makeRuleKey(iconName, iconStyle, bucket)}-cq`;\n        if (registeredRules.has(key)) continue;\n\n        const sheet = ensureStyleSheet();\n        if (!sheet) continue;\n\n        try {\n            // Use @container query for responsive sizing (logical property)\n            const cqRule = `\n                @container (min-inline-size: ${bucket}px) {\n                    ${selector} {\n                        --icon-image: ${createImageSetCSS(url, bucket)};\n                    }\n                }\n            `;\n            sheet.insertRule(cqRule, sheet.cssRules.length);\n            registeredRules.add(key);\n        } catch {\n            // Container queries might not be supported\n        }\n    }\n};\n\n/**\n * Clears all registered icon rules\n * Useful for hot reload or cache invalidation\n */\nexport const clearIconRules = (): void => {\n    registeredRules.clear();\n    pendingRules = [];\n\n    if (styleElement?.sheet) {\n        // Remove all rules\n        const sheet = styleElement.sheet;\n        while (sheet.cssRules.length > 0) {\n            sheet.deleteRule(0);\n        }\n    }\n};\n\n/**\n * Gets statistics about registered rules\n */\nexport const getRegistryStats = (): {\n    ruleCount: number;\n    pendingCount: number;\n    hasStyleSheet: boolean;\n} => {\n    return {\n        ruleCount: registeredRules.size,\n        pendingCount: pendingRules.length,\n        hasStyleSheet: iconStyleSheet !== null,\n    };\n};\n\n/**\n * Pre-registers common icon styles to reduce layout shifts\n * Call this early in app initialization if you know which icons will be used\n */\nexport const preregisterIcons = (\n    icons: Array<{ name: string; style: string; url: string }>,\n): void => {\n    for (const { name, style, url } of icons) {\n        registerIconRule(name, style, url);\n    }\n};\n\n/**\n * Pre-initializes registry on module load (non-blocking)\n */\nif (typeof document !== \"undefined\" && typeof window !== \"undefined\") {\n    // Load persisted state immediately (doesn't require DOM)\n    loadRegistryState();\n\n    // Initialize stylesheet on next tick to ensure DOM is ready\n    queueMicrotask(() => {\n        ensureStyleSheet();\n\n        // Listen for page visibility changes to reinitialize if needed\n        document.addEventListener('visibilitychange', () => {\n            if (!document.hidden && !iconStyleSheet) {\n                // Page became visible and we don't have a stylesheet - reinitialize\n                reinitializeRegistry();\n            }\n        });\n\n        // Also reinitialize on focus to handle tab switching\n        globalThis.addEventListener('focus', () => {\n            if (!iconStyleSheet) {\n                reinitializeRegistry();\n            }\n        });\n    });\n}\n","import {\n    isOPFSSupported,\n    getCachedVectorIcon,\n    cacheVectorIcon,\n    getCachedRasterIcon,\n    cacheRasterIcon,\n} from \"./OPFSCache\";\n\nimport {\n    registerIconRule,\n    hasIconRule,\n} from \"./CSSIconRegistry\";\n\n//\n//import * as icons from \"lucide\";\nexport const iconMap = new Map<string, Promise<string>>();\n\n// Minimal caches - only for in-flight operations, not long-term storage\n// CSS stylesheet handles the actual caching via attribute selectors\nexport const resolvedUrlCache = new Map<string, string>();\nexport const imageElementCache = new Map<string, Promise<HTMLImageElement>>();\n\n// Re-export registry functions for external use\nexport { registerIconRule, hasIconRule } from \"./CSSIconRegistry\";\n\nexport const MAX_RASTER_SIZE = 512;\nexport const MIN_RASTER_SIZE = 32;\n\n// Timeout and retry queue configuration\n// Increased timeout for mobile/slow networks\nconst FETCH_TIMEOUT_MS = 5000;\nconst RETRY_DELAY_MS = 1000; // Progressive delay\nconst MAX_RETRIES = 5; // More retries for unreliable networks\n\n// Network detection utilities\nconst isOnline = (): boolean => {\n    try {\n        return navigator.onLine !== false;\n    } catch {\n        return true; // Assume online if can't detect\n    }\n};\n\nconst isSlowConnection = (): boolean => {\n    try {\n        const connection = (navigator as any).connection ||\n                          (navigator as any).mozConnection ||\n                          (navigator as any).webkitConnection;\n        if (!connection) return false;\n\n        // Check for slow connection types\n        const slowTypes = ['slow-2g', '2g', '3g'];\n        return slowTypes.includes(connection.effectiveType) ||\n               connection.saveData === true ||\n               connection.downlink < 1.5; // Less than 1.5 Mbps\n    } catch {\n        return false;\n    }\n};\n\n// Delayed retry queue\ntype QueuedItem = { name: string; creator?: (name: any) => any; resolve: (v: string) => void; reject: (e: Error) => void; retries: number };\nconst retryQueue: QueuedItem[] = [];\nlet retryScheduled = false;\n\nconst scheduleRetryQueue = () => {\n    if (retryScheduled || retryQueue.length === 0) { return; }\n    retryScheduled = true;\n    setTimeout(processRetryQueue, RETRY_DELAY_MS);\n};\n\nconst processRetryQueue = () => {\n    retryScheduled = false;\n\n    // Skip retries if offline\n    if (!isOnline()) {\n        if (typeof console !== \"undefined\") {\n            console.log?.(\"[icon-loader] Skipping retries - device is offline\");\n        }\n        // Clear queue to prevent accumulation\n        retryQueue.length = 0;\n        return;\n    }\n\n    const batch = retryQueue.splice(0, Math.min(2, retryQueue.length)); // Even smaller batches\n    for (const item of batch) {\n        // Add progressive delay for retries\n        const delay = RETRY_DELAY_MS * Math.pow(1.5, item.retries - 1);\n        setTimeout(() => {\n            loadAsImageInternal(item.name, item.creator, item.retries)\n                .then(item.resolve)\n                .catch((error) => {\n                    // Enhanced error logging for debugging\n                    if (typeof console !== \"undefined\") {\n                        console.warn?.(`[icon-loader] Retry ${item.retries}/${MAX_RETRIES} failed for ${item.name}:`, error?.message || error);\n                    }\n                    item.reject(error);\n                });\n        }, delay);\n    }\n\n    // Schedule next batch with longer delay if we have more items\n    if (retryQueue.length > 0) {\n        const nextDelay = isSlowConnection() ? RETRY_DELAY_MS * 2 : RETRY_DELAY_MS;\n        setTimeout(processRetryQueue, nextDelay);\n    }\n};\n\nconst withTimeout = <T>(promise: Promise<T>, ms: number): Promise<T> => {\n    let timeoutId: ReturnType<typeof setTimeout>;\n    const timeoutPromise = new Promise<never>((_, reject) => {\n        timeoutId = setTimeout(() => reject(new Error(\"Timeout\")), ms);\n    });\n    return Promise.race([promise, timeoutPromise]).finally(() => clearTimeout(timeoutId));\n};\n\nexport type DevicePixelSize = { inline: number; block: number };\n\nconst globalScope = typeof globalThis !== \"undefined\" ? (globalThis as { location?: Location }) : {};\nconst hasChromeRuntime = (): boolean => {\n    try {\n        const chromeRuntime = (globalThis as any)?.chrome?.runtime;\n        return !!chromeRuntime?.id;\n    } catch {\n        return false;\n    }\n};\n\nconst pickBaseUrl = (): string | undefined => {\n    try {\n        if (typeof document !== \"undefined\" && typeof document.baseURI === \"string\" && document.baseURI !== \"about:blank\") {\n            return document.baseURI;\n        }\n    } catch {\n        /* noop */\n    }\n\n    try {\n        const { location } = globalScope;\n        if (location?.href && location.href !== \"about:blank\") {\n            return location.href;\n        }\n        if (location?.origin) {\n            return location.origin;\n        }\n    } catch {\n        /* noop */\n    }\n    return undefined;\n};\n\nconst DEFAULT_BASE_URL = pickBaseUrl();\n\nexport const fallbackMaskValue = (url: string) => (!url ? \"none\" : `url(\"${url}\")`);\n\nexport const resolveAssetUrl = (input: string): string => {\n    if (!input || typeof input !== \"string\") { return \"\"; }\n    const cached = resolvedUrlCache.get(input);\n    if (cached) { return cached; }\n\n    let resolved = input;\n    if (typeof URL === \"function\") {\n        try {\n            resolved = DEFAULT_BASE_URL ? new URL(input, DEFAULT_BASE_URL).href : new URL(input).href;\n        } catch {\n            try {\n                resolved = new URL(input, globalScope.location?.origin ?? undefined).href;\n            } catch {\n                resolved = input;\n            }\n        }\n    }\n\n    resolvedUrlCache.set(input, resolved);\n    if (!resolvedUrlCache.has(resolved)) {\n        resolvedUrlCache.set(resolved, resolved);\n    }\n    return resolved;\n};\n\n// In-flight promise tracking to prevent duplicate loads\nconst inflightPromises = new Map<string, Promise<string>>();\n\nconst isSafeCssMaskUrl = (url: string): boolean => {\n    if (!url || typeof url !== \"string\") return false;\n    const trimmed = url.trim();\n    if (!trimmed) return false;\n    if (trimmed.startsWith(\"data:\") || trimmed.startsWith(\"blob:\")) return true;\n\n    // Allow relative and root-relative paths (same-origin).\n    if (trimmed.startsWith(\"/\") || trimmed.startsWith(\"./\") || trimmed.startsWith(\"../\")) return true;\n\n    // For absolute URLs, only allow same-origin to avoid CSS cross-origin fetch + credentials issues.\n    if (typeof URL === \"function\") {\n        try {\n            const base = globalScope.location?.origin ?? DEFAULT_BASE_URL;\n            const parsed = new URL(trimmed, base);\n            const origin = globalScope.location?.origin;\n            if (origin && parsed.origin === origin) return true;\n        } catch {\n            return false;\n        }\n    }\n\n    return false;\n};\n\n/**\n * Generates cache key for icon lookup\n */\nconst makeCacheKey = (cacheKey: string | undefined, normalizedUrl: string, bucket: number): string => {\n    const sanitizedKey = (cacheKey ?? \"\").trim();\n    return sanitizedKey ? `${sanitizedKey}@${bucket}` : `${normalizedUrl}@${bucket}`;\n};\n\nexport const quantizeToBucket = (value: number): number => {\n    if (!Number.isFinite(value) || value <= 0) { value = MIN_RASTER_SIZE; }\n    const safe = Math.max(value, MIN_RASTER_SIZE);\n    const bucket = 2 ** Math.ceil(Math.log2(safe));\n    return Math.min(MAX_RASTER_SIZE, bucket);\n};\n\nexport const loadImageElement = (url: string): Promise<HTMLImageElement> => {\n    const resolvedUrl = resolveAssetUrl(url);\n    if (!resolvedUrl) { return Promise.reject(new Error(\"Invalid icon URL\")); }\n    if (!imageElementCache.has(resolvedUrl)) {\n        const promise = (async (): Promise<HTMLImageElement> => {\n            // Try OPFS cache first for blob URL\n            let effectiveUrl = resolvedUrl;\n            if (isOPFSSupported()) {\n                try {\n                    const cachedUrl = await getCachedVectorIcon(resolvedUrl);\n                    if (cachedUrl) {\n                        effectiveUrl = cachedUrl;\n                    }\n                } catch {\n                    /* cache miss */\n                }\n            }\n\n            return new Promise<HTMLImageElement>((resolve, reject) => {\n                const img = new Image();\n                let settled = false;\n\n                // Timeout for image loading to prevent stuck preloading\n                const timeoutId = setTimeout(() => {\n                    if (!settled) {\n                        settled = true;\n                        img.onload = img.onerror = null;\n                        reject(new Error(`Timeout loading icon: ${url}`));\n                    }\n                }, FETCH_TIMEOUT_MS);\n\n                // Configure image properties\n                try { img.decoding = \"async\"; } catch (_) { /* noop */ }\n                try { img.crossOrigin = \"anonymous\"; } catch (_) { /* noop */ }\n\n                // Prevent image from being displayed if it accidentally gets added to DOM\n                img.style.display = 'none';\n                img.style.position = 'absolute';\n                img.style.visibility = 'hidden';\n\n                img.onload = () => {\n                    if (settled) { return; }\n                    settled = true;\n                    clearTimeout(timeoutId);\n\n                    // Validate loaded image\n                    if (img.naturalWidth === 0 || img.naturalHeight === 0) {\n                        reject(new Error(`Invalid image dimensions for: ${url}`));\n                        return;\n                    }\n\n                    resolve(img);\n                };\n\n                img.onerror = (_event) => {\n                    if (settled) { return; }\n                    settled = true;\n                    clearTimeout(timeoutId);\n\n                    // If cached URL failed, try original URL\n                    if (effectiveUrl !== resolvedUrl) {\n                        const retryImg = new Image();\n                        try { retryImg.decoding = \"async\"; } catch (_) { /* noop */ }\n                        try { retryImg.crossOrigin = \"anonymous\"; } catch (_) { /* noop */ }\n                        retryImg.style.display = retryImg.style.position = retryImg.style.visibility = 'none';\n\n                        retryImg.onload = () => {\n                            if (retryImg.naturalWidth === 0 || retryImg.naturalHeight === 0) {\n                                reject(new Error(`Invalid retry image dimensions for: ${url}`));\n                                return;\n                            }\n                            resolve(retryImg);\n                        };\n                        retryImg.onerror = () => reject(new Error(`Failed to load icon: ${url}`));\n                        retryImg.src = resolvedUrl;\n                        return;\n                    }\n                    reject(new Error(`Failed to load icon: ${url}`));\n                };\n\n                img.src = effectiveUrl;\n            });\n        })().then(async (img) => {\n            if (typeof img.decode === \"function\") {\n                try { await img.decode(); } catch (_) { /* ignore decode errors */ }\n            }\n\n            // Cache SVG to OPFS if loaded from network\n            if (isOPFSSupported() && img.src === resolvedUrl) {\n                // Fetch and cache in background\n                fetch(resolvedUrl)\n                    .then(r => r.blob())\n                    .then(blob => cacheVectorIcon(resolvedUrl, blob))\n                    .catch(() => { /* silent */ });\n            }\n\n            return img;\n        }).catch((error) => {\n            // Remove from cache on failure to allow retry\n            imageElementCache.delete(resolvedUrl);\n            throw error;\n        });\n        imageElementCache.set(resolvedUrl, promise);\n    }\n    return imageElementCache.get(resolvedUrl)!;\n};\n\nexport const createCanvas = (size: number): OffscreenCanvas | HTMLCanvasElement => {\n    const dimension = Math.max(size, MIN_RASTER_SIZE);\n    if (typeof OffscreenCanvas !== \"undefined\") {\n        return new OffscreenCanvas(dimension, dimension);\n    }\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = dimension;\n    canvas.height = dimension;\n    return canvas;\n};\n\nexport const canvasToImageUrl = async (canvas: OffscreenCanvas | HTMLCanvasElement): Promise<string> => {\n    if (\"convertToBlob\" in canvas) {\n        const blob = await (canvas as OffscreenCanvas).convertToBlob({ type: \"image/png\" });\n        return URL.createObjectURL(blob);\n    }\n    const htmlCanvas = canvas as HTMLCanvasElement;\n    if (typeof htmlCanvas.toBlob === \"function\") {\n        const blob = await new Promise<Blob>((resolve, reject) => {\n            htmlCanvas.toBlob((blobValue) => {\n                if (blobValue) { resolve(blobValue); }\n                else { reject(new Error(\"Canvas toBlob returned null\")); }\n            }, \"image/png\");\n        });\n        return URL.createObjectURL(blob);\n    }\n    return htmlCanvas.toDataURL(\"image/png\");\n};\n\n/**\n * Converts canvas to blob for OPFS caching\n */\nconst canvasToBlob = async (canvas: OffscreenCanvas | HTMLCanvasElement): Promise<Blob | null> => {\n    try {\n        if (\"convertToBlob\" in canvas) {\n            return await (canvas as OffscreenCanvas).convertToBlob({ type: \"image/png\" });\n        }\n        const htmlCanvas = canvas as HTMLCanvasElement;\n        if (typeof htmlCanvas.toBlob === \"function\") {\n            return await new Promise<Blob | null>((resolve) => {\n                htmlCanvas.toBlob((blob) => resolve(blob), \"image/png\");\n            });\n        }\n    } catch {\n        /* noop */\n    }\n    return null;\n};\n\nexport const rasterizeSvgToMask = async (url: string, bucket: number, cacheKey?: string): Promise<string> => {\n    const size = Math.max(bucket, MIN_RASTER_SIZE);\n    const opfsCacheKey = cacheKey || url;\n\n    // Check OPFS cache first for raster version\n    if (isOPFSSupported()) {\n        try {\n            const cachedRaster = await getCachedRasterIcon(opfsCacheKey, size);\n            if (cachedRaster) {\n                return fallbackMaskValue(cachedRaster);\n            }\n        } catch (error) {\n            console.warn('[ui-icon] OPFS cache read failed:', error);\n        }\n    }\n\n    const img = await loadImageElement(url);\n    const canvas = createCanvas(size);\n    const context = canvas.getContext(\"2d\", {\n        alpha: true,\n        desynchronized: true,\n        willReadFrequently: false\n    }) as CanvasRenderingContext2D;\n\n    if (!context) {\n        throw new Error(\"Unable to acquire 2d context for rasterization\");\n    }\n\n    // Configure canvas for high-quality rendering\n    context.clearRect(0, 0, size, size);\n    context.imageSmoothingEnabled = true;\n    context.imageSmoothingQuality = 'high';\n    context.globalCompositeOperation = 'source-over';\n\n    const naturalWidth = img.naturalWidth || img.width || size;\n    const naturalHeight = img.naturalHeight || img.height || size;\n\n    // Ensure we have valid dimensions\n    const safeWidth = Math.max(1, naturalWidth);\n    const safeHeight = Math.max(1, naturalHeight);\n\n    // Calculate scale to fit within canvas while maintaining aspect ratio\n    const scale = Math.min(size / safeWidth, size / safeHeight);\n    const drawWidth = Math.max(1, Math.floor(safeWidth * scale));\n    const drawHeight = Math.max(1, Math.floor(safeHeight * scale));\n\n    // Center the image on the canvas\n    const offsetX = Math.floor((size - drawWidth) / 2);\n    const offsetY = Math.floor((size - drawHeight) / 2);\n\n    // Clear canvas with transparent background\n    context.clearRect(0, 0, size, size);\n\n    // Draw the image with proper scaling and error handling\n    try {\n        context.drawImage(img, offsetX, offsetY, drawWidth, drawHeight);\n    } catch (error) {\n        console.warn('[ui-icon] Failed to draw image on canvas:', error);\n        // Fallback: create a simple colored rectangle as placeholder\n        context.fillStyle = 'rgba(128, 128, 128, 0.5)';\n        context.fillRect(offsetX, offsetY, drawWidth, drawHeight);\n    }\n\n    // Cache raster to OPFS in background with error handling\n    if (isOPFSSupported()) {\n        canvasToBlob(canvas).then((blob) => {\n            if (blob && blob.size > 0) {\n                return cacheRasterIcon(opfsCacheKey, size, blob);\n            }\n        }).catch((error) => {\n            console.warn('[ui-icon] OPFS cache write failed:', error);\n        });\n    }\n\n    const rasterUrl = await canvasToImageUrl(canvas);\n    return fallbackMaskValue(rasterUrl);\n};\n\n/**\n * Ensures a mask value is available for an icon.\n * Uses CSS registry for caching - the result is registered as a CSS rule\n * with attribute selectors, so the browser handles caching.\n */\nexport const ensureMaskValue = (url: string, cacheKey: string | undefined, bucket: number): Promise<string> => {\n    const safeUrl = typeof url === \"string\" ? url : \"\";\n    const normalizedUrl = resolveAssetUrl(safeUrl);\n    const effectiveUrl = normalizedUrl || safeUrl;\n    const key = makeCacheKey(cacheKey, normalizedUrl, bucket);\n\n    if (!effectiveUrl) {\n        return Promise.resolve(fallbackMaskValue(\"\"));\n    }\n\n    // Check if already in-flight\n    const inflight = inflightPromises.get(key);\n    if (inflight) { return inflight; }\n\n    const promise = loadAsImage(effectiveUrl, /*bucket, cacheKey*/)\n        .catch((error) => {\n            if (effectiveUrl && typeof console !== \"undefined\") {\n                console.warn?.(\"[ui-icon] Mask generation failed; refusing to use cross-origin CSS url() fallback\", error);\n            }\n            // IMPORTANT:\n            // Do not fall back to `url(\"https://...\")` for cross-origin CDNs, because CSS fetches use\n            // credentials=include and many CDNs respond with ACAO=\"*\", which is blocked in that mode.\n            return fallbackMaskValue(isSafeCssMaskUrl(effectiveUrl) ? effectiveUrl : \"\");\n        })\n        .finally(() => {\n            inflightPromises.delete(key);\n        });\n\n    inflightPromises.set(key, promise);\n    return promise;\n};\n\nexport const camelToKebab = (camel: string) => {\n    if (typeof camel !== \"string\") { return \"\"; }\n    return camel\n        .replace(/[_\\s]+/g, \"-\")\n        .replace(/([a-z0-9])([A-Z])/g, \"$1-$2\")\n        .replace(/([A-Z])([A-Z][a-z])/g, \"$1-$2\")\n        .toLowerCase();\n};\n\n/**\n * Creates an image-set CSS value for resolution-aware icons.\n * Used by the CSS registry for generating rules.\n */\nexport const createImageSetValue = (url: string, resolutions: Array<{ scale: number; size: number }> = []): string => {\n    if (!url) { return \"linear-gradient(#0000, #0000)\"; }\n\n    const baseSet = [`url(\"${url}\") 1x`];\n\n    for (const { scale } of resolutions) {\n        if (scale > 1) {\n            baseSet.push(`url(\"${url}\") ${scale}x`);\n        }\n    }\n\n    return `image-set(${baseSet.join(\", \")})`;\n};\n\n/**\n * Registers an icon in the CSS registry.\n * This generates a CSS rule with attribute selectors and image-set.\n *\n * @param iconName - The icon name (e.g., \"house\", \"arrow-right\")\n * @param iconStyle - The icon style (e.g., \"duotone\", \"fill\")\n * @param url - The resolved icon URL\n * @param bucket - The size bucket for the icon\n */\nexport const generateIconImageVariable = (\n    iconName: string,\n    url: string,\n    bucket: number\n): void => {\n    // Parse iconName to extract the style if it's in \"style:name\" format\n    const parts = iconName.split(\":\");\n    const [iconStyle, name] = parts.length === 2 ? parts : [\"duotone\", iconName];\n\n    // Register in the CSS stylesheet via registry\n    registerIconRule(name, iconStyle, url, bucket);\n};\n\nexport const isPathURL = (url: unknown): url is string => {\n    if (typeof url !== \"string\" || !url) { return false; }\n    if (typeof URL === \"undefined\") {\n        return /^([a-z]+:)?\\/\\//i.test(url) || url.startsWith(\"/\") || url.startsWith(\"./\") || url.startsWith(\"../\");\n    }\n\n    if (typeof URL.canParse === \"function\") {\n        try {\n            if (URL.canParse(url, DEFAULT_BASE_URL)) { return true; }\n            if (globalScope.location?.origin && URL.canParse(url, globalScope.location.origin)) { return true; }\n        } catch {\n            /* noop */\n        }\n    }\n\n    try {\n        new URL(url, DEFAULT_BASE_URL ?? globalScope.location?.origin ?? undefined);\n        return true;\n    } catch {\n        return false;\n    }\n};\nexport const rasterizeSVG = (blob: Blob | string)=>{ return isPathURL(blob) ? resolveAssetUrl(blob) : URL.createObjectURL(blob); }\n\n/**\n * Fetches SVG content with a hard timeout and abort support.\n * This prevents fetch storms from piling up and timing out later.\n */\nconst fetchSvgBlob = async (url: string, timeoutMs: number): Promise<Blob> => {\n    const controller = typeof AbortController !== \"undefined\" ? new AbortController() : null;\n    const timeoutId = controller ? setTimeout(() => controller.abort(), timeoutMs) : null;\n\n    try {\n        const response = await fetch(url, {\n            credentials: \"omit\",\n            mode: \"cors\",\n            signal: controller?.signal,\n        });\n\n        if (!response.ok) {\n            throw new Error(`HTTP ${response.status} ${response.statusText}`);\n        }\n\n        const blob = await response.blob();\n        if (!blob || blob.size === 0) {\n            throw new Error(\"Empty SVG response\");\n        }\n        return blob;\n    } catch (e) {\n        if (e instanceof DOMException && e.name === \"AbortError\") {\n            throw new Error(\"Timeout\");\n        }\n        throw e;\n    } finally {\n        if (timeoutId) { clearTimeout(timeoutId); }\n    }\n};\n\nconst tryLoadFromVectorCache = async (canonicalUrl: string): Promise<string | null> => {\n    if (!canonicalUrl) return null;\n    if (!isOPFSSupported()) return null;\n    try {\n        const cached = await getCachedVectorIcon(canonicalUrl);\n        if (!cached) return null;\n\n        const blob = await fetchSvgBlob(cached, FETCH_TIMEOUT_MS);\n        const svgText = await blob.text();\n        if (!svgText || svgText.trim().length === 0) return null;\n        return toSvgDataUrl(svgText);\n    } catch {\n        return null;\n    }\n};\n\n/**\n * Fallback icon SVG (used when all icon sources fail).\n *\n * Note: This is used as a CSS mask, so we prefer solid filled shapes and avoid\n * odd self-intersections that can look like artifacts at small sizes.\n */\nconst FALLBACK_SVG_TEXT = `<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n  <path fill=\"currentColor\" fill-rule=\"evenodd\" d=\"M6 2a4 4 0 0 0-4 4v12a4 4 0 0 0 4 4h12a4 4 0 0 0 4-4V6a4 4 0 0 0-4-4H6zm0 2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z\" clip-rule=\"evenodd\"/>\n  <path fill=\"currentColor\" d=\"M11 7h2v7h-2z\"/>\n  <path fill=\"currentColor\" d=\"M11 16h2v2h-2z\"/>\n</svg>`;\n\n/**\n * Validates and converts SVG text to data URL\n */\nconst toSvgDataUrl = (svgText: string): string => {\n    if (!svgText || typeof svgText !== 'string') {\n        throw new Error('Invalid SVG text: empty or not a string');\n    }\n\n    // Basic validation - check for SVG tag\n    const trimmed = svgText.trim();\n    if (!trimmed.includes('<svg') || !trimmed.includes('</svg>')) {\n        throw new Error('Invalid SVG: missing svg tags');\n    }\n\n    // Check for reasonable size (not empty, not too large)\n    if (trimmed.length < 50) {\n        throw new Error('Invalid SVG: content too small');\n    }\n\n    if (trimmed.length > 1024 * 1024) { // 1MB limit\n        throw new Error('Invalid SVG: content too large');\n    }\n\n    // Basic XML structure check\n    const openTags = trimmed.match(/<[^/?][^>]*>/g) || [];\n    const closeTags = trimmed.match(/<\\/[^>]+>/g) || [];\n    const selfClosingTags = trimmed.match(/<[^>]+\\/>/g) || [];\n\n    // Rough check that we have balanced tags\n    if (openTags.length + selfClosingTags.length < closeTags.length) {\n        throw new Error('Invalid SVG: unbalanced tags');\n    }\n\n    // Ensure proper UTF-8 encoding for SVG data URLs\n    try {\n        // Use TextEncoder for proper UTF-8 handling\n        const encoder = new TextEncoder();\n        const utf8Bytes = encoder.encode(svgText);\n        const binaryString = Array.from(utf8Bytes, byte => String.fromCharCode(byte)).join('');\n        return `data:image/svg+xml;base64,${btoa(binaryString)}`;\n    } catch {\n        // Fallback to the original method if TextEncoder fails\n        try {\n            return `data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(svgText)))}`;\n        } catch {\n            // Final fallback: return SVG as-is without base64 encoding\n            return `data:image/svg+xml;charset=utf-8,${encodeURIComponent(svgText)}`;\n        }\n    }\n};\n\nconst FALLBACK_SVG_DATA_URL = (() => {\n    try {\n        return toSvgDataUrl(FALLBACK_SVG_TEXT);\n    } catch {\n        return `data:image/svg+xml;charset=utf-8,${encodeURIComponent(FALLBACK_SVG_TEXT)}`;\n    }\n})();\n\nexport const FALLBACK_ICON_DATA_URL = FALLBACK_SVG_DATA_URL;\n\nconst rewritePhosphorUrl = (url: string): string => {\n    // Legacy (broken) format used previously:\n    // - https://cdn.jsdelivr.net/gh/phosphor-icons/phosphor-icons/src/{style}/{name}.svg\n    //\n    // Correct/stable format (npm package assets):\n    // - https://cdn.jsdelivr.net/npm/@phosphor-icons/core@2/assets/{style}/{name}.svg\n    //\n    // Keep this rewrite conservative: only rewrite known phosphor patterns.\n    if (!url || typeof url !== 'string') return url;\n\n    try {\n        const isHttpOrigin = (() => {\n            const proto = (globalScope.location as any)?.protocol || \"\";\n            return proto === \"http:\" || proto === \"https:\";\n        })();\n        const isExtensionRuntime = hasChromeRuntime();\n\n        const toNpmAssetUrl = (style: string, baseName: string) => {\n            // For duotone icons, append '-duotone' to the filename\n            // For other styles like 'fill', 'bold', etc., append '-{style}'\n            const iconFileName = style === \"duotone\"\n                ? `${baseName}-duotone`\n                : style !== \"regular\"\n                    ? `${baseName}-${style}`\n                    : baseName;\n            return `https://cdn.jsdelivr.net/npm/@phosphor-icons/core@2/assets/${style}/${iconFileName}.svg`;\n        };\n\n        const urlObj = new URL(url);\n\n        // In extension runtimes (including content scripts on http(s) pages),\n        // `/assets/icons/phosphor/...` is not guaranteed to exist. Rewrite to CDN.\n        if ((isExtensionRuntime || !isHttpOrigin) && urlObj.pathname.startsWith(\"/assets/icons/phosphor/\")) {\n            const parts = urlObj.pathname.split(\"/\").filter(Boolean); // [\"assets\",\"icons\",\"phosphor\",style,name.svg]\n            const style = parts[3] || \"duotone\";\n            const fileName = parts[4] || \"\";\n            const baseName = fileName.replace(/\\.svg$/i, \"\");\n            const validStyles = [\"thin\", \"light\", \"regular\", \"bold\", \"fill\", \"duotone\"];\n            if (validStyles.includes(style) && baseName && /^[a-z0-9-]+$/.test(baseName)) {\n                return toNpmAssetUrl(style, baseName);\n            }\n            return url;\n        }\n\n        // Only rewrite GitHub phosphor URLs\n        if (urlObj.hostname === 'cdn.jsdelivr.net' &&\n            urlObj.pathname.startsWith('/gh/phosphor-icons/phosphor-icons/')) {\n\n            const pathParts = urlObj.pathname.split('/').filter(Boolean);\n            const srcIndex = pathParts.indexOf('src');\n\n            if (srcIndex >= 0 && pathParts.length >= srcIndex + 3) {\n                const style = pathParts[srcIndex + 1];\n                const fileName = pathParts[srcIndex + 2];\n\n                if (style && fileName && fileName.endsWith('.svg')) {\n                    let iconName = fileName.replace(/\\.svg$/i, '');\n\n                    // Remove style suffix from icon name if present (e.g., \"folder-open-duotone\" -> \"folder-open\")\n                    if (style === 'duotone' && iconName.endsWith('-duotone')) {\n                        iconName = iconName.replace(/-duotone$/, '');\n                    } else if (style !== 'regular' && iconName.endsWith(`-${style}`)) {\n                        iconName = iconName.replace(new RegExp(`-${style}$`), '');\n                    }\n\n                    // Validate style and icon name\n                    const validStyles = ['thin', 'light', 'regular', 'bold', 'fill', 'duotone'];\n                    if (validStyles.includes(style) && iconName && /^[a-z0-9-]+$/.test(iconName)) {\n                        // Prefer proxy only on non-extension http(s) origins where /api exists.\n                        return (isHttpOrigin && !isExtensionRuntime)\n                            ? `/assets/icons/phosphor/${style}/${iconName}.svg`\n                            : toNpmAssetUrl(style, iconName);\n                    }\n                }\n            }\n        }\n\n        // Also handle direct npm package URLs that might be used\n        if (urlObj.hostname === 'cdn.jsdelivr.net' &&\n            urlObj.pathname.startsWith('/npm/@phosphor-icons/')) {\n            // Extract style and icon name from npm URL\n            const pathParts = urlObj.pathname.split('/').filter(Boolean);\n            const assetsIndex = pathParts.indexOf('assets');\n\n            if (assetsIndex >= 0 && pathParts.length >= assetsIndex + 3) {\n                const style = pathParts[assetsIndex + 1];\n                const fileName = pathParts[assetsIndex + 2];\n\n                if (style && fileName && fileName.endsWith('.svg')) {\n                    let iconName = fileName.replace(/\\.svg$/i, '');\n\n                    // Remove style suffix from icon name if present (e.g., \"folder-open-duotone\" -> \"folder-open\")\n                    if (style === 'duotone' && iconName.endsWith('-duotone')) {\n                        iconName = iconName.replace(/-duotone$/, '');\n                    } else if (style !== 'regular' && iconName.endsWith(`-${style}`)) {\n                        iconName = iconName.replace(new RegExp(`-${style}$`), '');\n                    }\n\n                    // Validate style and icon name\n                    const validStyles = ['thin', 'light', 'regular', 'bold', 'fill', 'duotone'];\n                    if (validStyles.includes(style) && iconName && /^[a-z0-9-]+$/.test(iconName)) {\n                        // Prefer proxy only on non-extension http(s) origins where /api exists.\n                        return (isHttpOrigin && !isExtensionRuntime)\n                            ? `/assets/icons/phosphor/${style}/${iconName}.svg`\n                            : toNpmAssetUrl(style, iconName);\n                    }\n                }\n            }\n        }\n    } catch (error) {\n        // Invalid URL, return as-is\n        console.warn('[ui-icon] Invalid URL for phosphor rewrite:', url, error);\n    }\n\n    return url;\n};\n\nconst isClientErrorStatus = (error: unknown): boolean => {\n    if (!(error instanceof Error)) { return false; }\n\n    // Don't retry 4xx client errors (except 408 Request Timeout which might be network related)\n    if (/\\bHTTP\\s*4\\d\\d\\b/.test(error.message) || /\\b4\\d\\d\\b/.test(error.message)) {\n        return !/408/.test(error.message); // Allow retry for 408\n    }\n\n    // Retry on network-related errors that might be temporary\n    return /network|timeout|offline|connection|aborted/i.test(error.message) ||\n           error.name === 'TypeError' && /fetch/i.test(error.message);\n};\n\n// Internal loader with retry support\n// Internal loader with retry support\n\nconst loadAsImageInternal = async (name: any, creator?: (name: any) => any, attempt = 0): Promise<string> => {\n    if (isPathURL(name)) {\n        const resolvedUrl = resolveAssetUrl(name);\n\n        // Skip if this is already a data URL (from cache or previous processing)\n        if (resolvedUrl.startsWith(\"data:\")) {\n            console.log(`[ui-icon] Already a data URL, returning as-is`);\n            return resolvedUrl;\n        }\n\n        const effectiveUrl = rewritePhosphorUrl(resolvedUrl);\n        if (effectiveUrl !== resolvedUrl) {\n            console.log(`[ui-icon] Rewrote phosphor URL: ${resolvedUrl} -> ${effectiveUrl}`);\n        }\n\n        try {\n            // Try OPFS cache first (fast, local, avoids network storms).\n            if (isOPFSSupported()) {\n                try {\n                    const cached = await withTimeout(getCachedVectorIcon(effectiveUrl), 50);\n                    if (cached) {\n                        const blob = await fetchSvgBlob(cached, FETCH_TIMEOUT_MS);\n                        const svgText = await blob.text();\n                        return toSvgDataUrl(svgText);\n                    }\n                } catch {\n                    /* cache miss or timeout */\n                }\n            }\n\n            // Build a small, correct fallback list (sequential attempts).\n            const candidates: string[] = [effectiveUrl];\n\n            // jsDelivr -> unpkg (correct path mapping for phosphor assets)\n            if (effectiveUrl.startsWith(\"https://cdn.jsdelivr.net/npm/\")) {\n                const unpkg = effectiveUrl.replace(\"https://cdn.jsdelivr.net/npm/\", \"https://unpkg.com/\");\n                candidates.push(unpkg);\n            }\n\n            // Only attempt a second mirror if its an https URL and not already included.\n            if (effectiveUrl.startsWith(\"https://\") && effectiveUrl.includes(\"cdn.jsdelivr.net\")) {\n                const mirror = effectiveUrl.replace(\"cdn.jsdelivr.net\", \"unpkg.com\").replace(\"/npm/\", \"/\");\n                if (!candidates.includes(mirror)) {\n                    candidates.push(mirror);\n                }\n            }\n\n            const errors: Error[] = [];\n            for (const url of candidates) {\n                try {\n                    const blob = await fetchSvgBlob(url, FETCH_TIMEOUT_MS);\n                    if (blob.size > 1024 * 1024) {\n                        throw new Error(`Blob too large (${blob.size} bytes)`);\n                    }\n                    const svgText = await blob.text();\n                    const dataUrl = toSvgDataUrl(svgText);\n\n                    // Cache vector SVG for the canonical URL in background (best-effort),\n                    // even if we succeeded via a mirror.\n                    if (isOPFSSupported()) {\n                        cacheVectorIcon(effectiveUrl, blob).catch(() => { /* silent */ });\n                    }\n\n                    return dataUrl;\n                } catch (e) {\n                    const err = e instanceof Error ? e : new Error(String(e));\n                    errors.push(new Error(`${url}: ${err.message}`));\n                }\n            }\n\n            throw new Error(`All icon sources failed: ${errors.map(e => e.message).join(\"; \")}`);\n\n        } catch (error) {\n            console.warn(`[ui-icon] Failed to load icon: ${effectiveUrl}`, error);\n\n            // Don't spam retries on 404/4xx: it's a deterministic failure.\n            if (attempt < MAX_RETRIES && !isClientErrorStatus(error)) {\n                console.log(`[ui-icon] Queueing retry ${attempt + 1} for ${effectiveUrl}`);\n                return new Promise((resolve, reject) => {\n                    retryQueue.push({ name, creator, resolve, reject, retries: attempt + 1 });\n                    scheduleRetryQueue();\n                });\n            }\n\n            // If everything failed (CORS/offline/etc), prefer returning a cached vector icon if present.\n            const cachedDataUrl = await tryLoadFromVectorCache(effectiveUrl);\n            if (cachedDataUrl) {\n                console.warn(`[ui-icon] Using OPFS cached icon after failures: ${effectiveUrl}`);\n                return cachedDataUrl;\n            }\n\n            // Final fallback: return a simple placeholder SVG\n            console.warn(`[ui-icon] All loading methods failed, using fallback SVG for: ${effectiveUrl}`, error);\n            return FALLBACK_SVG_DATA_URL;\n        }\n    }\n\n    const doLoad = async (): Promise<string> => {\n        const element = await (creator ? creator?.(name) : name);\n        if (isPathURL(element)) {\n            // Recurse to get OPFS caching for path URLs\n            return loadAsImageInternal(element, undefined, attempt);\n        }\n        let file: any = name;\n        if (element instanceof Blob || element instanceof File) { file = element; }\n        else {\n            const text = typeof element == \"string\" ? element : element.outerHTML;\n            file = new Blob([`<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>`, text], { type: \"image/svg+xml\" });\n        }\n        return rasterizeSVG(file);\n    };\n\n    try {\n        // First attempt with timeout\n        return await withTimeout(doLoad(), FETCH_TIMEOUT_MS);\n    } catch (error) {\n        // On timeout, queue for retry if not exceeded max retries\n        if (attempt < MAX_RETRIES && error instanceof Error && error.message === \"Timeout\") {\n            return new Promise((resolve, reject) => {\n                retryQueue.push({ name, creator, resolve, reject, retries: attempt + 1 });\n                scheduleRetryQueue();\n            });\n        }\n        throw error;\n    }\n};\n\nexport const loadAsImage = async (name: any, creator?: (name: any) => any): Promise<string> => {\n    if (isPathURL(name)) { name = resolveAssetUrl(name) || name; }\n    // @ts-ignore // !experimental `getOrInsert` feature!\n    return iconMap.getOrInsertComputed(name, () => loadAsImageInternal(name, creator, 0));\n};\n\n/**\n * Clears in-memory caches for icon loading\n * Useful when switching themes or when cache becomes stale\n */\nexport const clearIconCaches = (): void => {\n    resolvedUrlCache.clear();\n    imageElementCache.clear();\n    iconMap.clear();\n    retryQueue.length = 0; // Clear pending retries\n\n    if (typeof console !== \"undefined\") {\n        console.log?.(\"[icon-loader] Cleared all in-memory caches\");\n    }\n};\n\n/**\n * Forces cache invalidation for a specific icon\n * @param iconName The icon name/URL to invalidate\n */\nexport const invalidateIconCache = (iconName: string): void => {\n    if (!iconName) return;\n\n    // Remove from in-memory caches\n    resolvedUrlCache.delete(iconName);\n    imageElementCache.delete(iconName);\n    iconMap.delete(iconName);\n\n    // Remove from OPFS cache (async, fire-and-forget)\n    if (typeof import('./OPFSCache') !== 'undefined') {\n        import('./OPFSCache').then(({ clearAllCache }) => {\n            // For individual icons, we might want to implement selective clearing\n            // For now, just clear problematic entries\n            clearAllCache().catch(() => { /* silent */ });\n        }).catch(() => { /* silent */ });\n    }\n\n    if (typeof console !== \"undefined\") {\n        console.log?.(`[icon-loader] Invalidated cache for: ${iconName}`);\n    }\n};\n\n/**\n * Tests the racing loading functionality by loading an icon with verbose logging\n * @param iconUrl The icon URL to test\n * @returns Promise that resolves to the loaded data URL\n */\nexport const testIconRacing = async (iconUrl: string): Promise<string> => {\n    console.log(`[icon-test] Testing racing for: ${iconUrl}`);\n\n    // Clear caches to force fresh load\n    clearIconCaches();\n\n    const startTime = performance.now();\n    const result = await loadAsImage(iconUrl);\n    const endTime = performance.now();\n\n    console.log(`[icon-test] Racing test completed in ${(endTime - startTime).toFixed(2)}ms`);\n    console.log(`[icon-test] Result:`, result.substring(0, 100) + '...');\n\n    return result;\n};\n\n/**\n * Debug function to check icon system status\n */\nexport const debugIconSystem = (): void => {\n    console.group('[icon-debug] Icon System Status');\n\n    // Check caches first (always available)\n    console.log('Resolved URL cache size:', resolvedUrlCache.size);\n    console.log('Image element cache size:', imageElementCache.size);\n    console.log('Icon map size:', iconMap.size);\n    console.log('Retry queue length:', retryQueue.length);\n\n    // Check CSS registry and OPFS asynchronously\n    Promise.all([\n        import('./CSSIconRegistry').then(({ getRegistryStats, ensureStyleSheet }) => {\n            const sheet = ensureStyleSheet();\n            const stats = getRegistryStats();\n            console.log('CSS Registry:', stats);\n            console.log('StyleSheet exists:', !!sheet);\n            console.log('Adopted sheets:', document.adoptedStyleSheets?.length || 0);\n            console.log('CSS rules in sheet:', sheet?.cssRules?.length || 0);\n        }).catch(e => console.error('CSS Registry error:', e)),\n\n        import('./OPFSCache').then(({ isOPFSSupported, getCacheStats }) => {\n            console.log('OPFS supported:', isOPFSSupported());\n            return getCacheStats().then(stats => {\n                console.log('OPFS cache stats:', stats);\n            });\n        }).catch(e => console.error('OPFS check error:', e))\n    ]).catch(() => {/* ignore */});\n\n    // Check network status\n    console.log('Network online:', navigator.onLine);\n    console.log('Slow connection:', isSlowConnection());\n\n    console.groupEnd();\n};\n","// should to return from source code to style element (in shadow DOM)\nexport const preloadStyle = (srcCode: string) => {\n    const content = typeof srcCode === \"string\" ? srcCode?.trim?.() : \"\";\n    if (!content) { return () => null as HTMLStyleElement | null; }\n    const styleURL = URL.createObjectURL(new Blob([content], {type: \"text/css\"}));\n\n    //\n    if (typeof document === \"undefined\") { return null; }\n    const styleEl = document.createElement(\"style\");\n    styleEl.setAttribute(\"data-ui-phosphor-icon\", \"true\");\n    styleEl.innerHTML = `@import url(\"${styleURL}\");`;\n\n    //\n    return () => styleEl?.cloneNode?.(true);;\n};\n\n// @ts-ignore  Vite inline import\nimport styles from \"./Phosphor.scss?inline\";\nimport {\n    ensureMaskValue,\n    loadAsImage,\n    FALLBACK_ICON_DATA_URL,\n    MIN_RASTER_SIZE,\n    quantizeToBucket,\n    camelToKebab,\n    generateIconImageVariable,\n    registerIconRule,\n    hasIconRule,\n    type DevicePixelSize,\n} from \"./Loader\";\n\n//\nconst createStyle = preloadStyle(styles);\n\n// Handle non-string or empty inputs gracefully\nconst capitalizeFirstLetter = (str: unknown) => {\n    if (typeof str !== \"string\" || str.length === 0) { return str; }\n    return str.charAt(0).toUpperCase() + str.slice(1);\n};\n\n// @ts-ignore\nexport class UIPhosphorIcon extends HTMLElement {\n    static get observedAttributes() {\n        return [\"icon\", \"icon-style\", \"size\", \"width\", \"icon-base\"];\n    }\n\n    #options: { padding?: number | string; icon?: string; iconStyle?: string } = {\n        padding: 0,\n        icon: \"\",\n        iconStyle: \"duotone\",\n    };\n    #resizeObserver?: ResizeObserver;\n    #devicePixelSize: DevicePixelSize = {\n        inline: MIN_RASTER_SIZE,\n        block: MIN_RASTER_SIZE,\n    };\n    #queuedMaskUpdate: Promise<void> | null = null;\n    #currentIconUrl = \"\";\n    #maskKeyBase = \"\";\n    #maskRef = { value: \"\" };\n    #styleAttached = false;\n    #pendingIconName: string | null = null;\n    #intersectionObserver?: IntersectionObserver;\n    #isIntersecting = false;\n\n    constructor(\n        options: Partial<{ icon: string; iconStyle: string; padding: number | string }> = {},\n    ) {\n        super();\n        Object.assign(this.#options, options);\n\n        if (typeof options.icon === \"string\" && options.icon.length > 0) {\n            this.setAttribute(\"icon\", options.icon);\n        }\n\n        if (typeof options.iconStyle === \"string\" && options.iconStyle.length > 0) {\n            this.setAttribute(\"icon-style\", options.iconStyle.toLowerCase());\n        }\n\n        this.#ensureShadowRoot();\n    }\n\n    get icon(): string {\n        return this.getAttribute(\"icon\") ?? \"\";\n    }\n\n    set icon(value: string) {\n        if (value == null || value === \"\") {\n            this.removeAttribute(\"icon\");\n            return;\n        }\n        const normalized = String(value);\n        if (this.getAttribute(\"icon\") !== normalized) {\n            this.setAttribute(\"icon\", normalized);\n        }\n    }\n\n    get iconStyle(): string {\n        return this.getAttribute(\"icon-style\") ?? this.#options.iconStyle ?? \"duotone\";\n    }\n\n    set iconStyle(value: string) {\n        const normalized = (value ?? \"\")?.trim?.()?.toLowerCase?.();\n        if (!normalized) {\n            this.removeAttribute(\"icon-style\");\n            return;\n        }\n        if (this.getAttribute(\"icon-style\") !== normalized) {\n            this.setAttribute(\"icon-style\", normalized);\n        }\n    }\n\n    get size(): string | null {\n        return this.getAttribute(\"size\");\n    }\n\n    set size(value: string | null) {\n        if (value == null || value === \"\") {\n            this.removeAttribute(\"size\");\n            return;\n        }\n        const normalized = String(value);\n        if (this.getAttribute(\"size\") !== normalized) {\n            this.setAttribute(\"size\", normalized);\n        }\n    }\n\n    get width(): string | null {\n        return this.getAttribute(\"width\");\n    }\n\n    set width(value: string | number | null) {\n        if (value == null || value === \"\") {\n            this.removeAttribute(\"width\");\n            return;\n        }\n        const normalized = typeof value === \"number\" ? String(value) : value;\n        if (this.getAttribute(\"width\") !== normalized) {\n            this.setAttribute(\"width\", normalized);\n        }\n    }\n\n    /**\n     * Optional base URL for same-origin icon hosting.\n     * Example: icon-base=\"/assets/phosphor\"\n     * Will be tried before CDNs.\n     */\n    get iconBase(): string {\n        return this.getAttribute(\"icon-base\") ?? \"\";\n    }\n\n    set iconBase(value: string) {\n        const normalized = (value ?? \"\").trim();\n        if (!normalized) {\n            this.removeAttribute(\"icon-base\");\n            return;\n        }\n        if (this.getAttribute(\"icon-base\") !== normalized) {\n            this.setAttribute(\"icon-base\", normalized);\n        }\n    }\n\n    connectedCallback(): void {\n        this.#applyHostDefaults();\n        this.#setupResizeObserver(this);\n        this.#setupVisibilityObserver();\n\n        if (!this.#styleAttached) {\n            const styleNode = createStyle?.() ?? null;\n            if (styleNode) { this.shadowRoot!.appendChild(styleNode); }\n            this.#styleAttached = true;\n        }\n\n        if (!this.hasAttribute(\"icon\") && this.#options.icon) {\n            this.setAttribute(\"icon\", this.#options.icon);\n        }\n        if (!this.hasAttribute(\"icon-style\") && this.#options.iconStyle) {\n            this.setAttribute(\"icon-style\", this.#options.iconStyle);\n        }\n\n        // Force load any pending icon immediately when connected\n        const pendingIcon = this.#pendingIconName ?? this.icon;\n        console.log(`[ui-icon] Element connected, pending icon: ${pendingIcon}, current icon: ${this.icon}`);\n\n        if (pendingIcon) {\n            console.log(`[ui-icon] Loading pending icon: ${pendingIcon}`);\n            this.updateIcon(pendingIcon);\n        } else if (this.icon) {\n            console.log(`[ui-icon] Loading current icon: ${this.icon}`);\n            this.updateIcon(this.icon);\n        } else {\n            console.log(`[ui-icon] No icon to load`);\n        }\n    }\n\n    disconnectedCallback(): void {\n        this.#resizeObserver?.disconnect();\n        this.#resizeObserver = undefined;\n        this.#teardownVisibilityObserver();\n        this.#queuedMaskUpdate = null;\n        this.#retryAttempt = 0;\n    }\n\n    attributeChangedCallback(name: string, oldValue: string | null, newValue: string | null) {\n        if (oldValue === newValue) { return; }\n\n        switch (name) {\n            case \"icon\": {\n                if (!this.isConnected) {\n                    this.#pendingIconName = newValue ?? \"\";\n                    return;\n                }\n                this.updateIcon(newValue ?? \"\");\n                break;\n            }\n            case \"icon-style\": {\n                if (newValue) {\n                    const normalized = newValue?.trim?.()?.toLowerCase?.();\n                    if (normalized !== newValue) {\n                        this.setAttribute(\"icon-style\", normalized);\n                        return;\n                    }\n                }\n                this.#maskKeyBase = \"\";\n                if (!this.isConnected) {\n                    this.#pendingIconName = this.icon;\n                    return;\n                }\n                this.updateIcon();\n                break;\n            }\n            case \"size\": {\n                if (newValue) {\n                    this.style.setProperty(\"--icon-size\", (typeof newValue === \"number\" || /^\\d+$/.test(newValue)) ? `${newValue}px` : newValue);\n                } else {\n                    this.style.removeProperty(\"--icon-size\");\n                }\n                if (this.isConnected) {\n                    this.#queueMaskUpdate();\n                }\n                break;\n            }\n            case \"width\": {\n                if (newValue == null || newValue === \"\") {\n                    this.style.removeProperty(\"width\");\n                } else {\n                    const value = (typeof newValue === \"number\" || /^\\d+$/.test(newValue)) ? `${newValue}px` : newValue;\n                    this.style.width = value;\n                }\n                if (this.isConnected) {\n                    this.#queueMaskUpdate();\n                }\n                break;\n            }\n            case \"icon-base\": {\n                // Changing base affects load source; force reload.\n                this.#currentIconUrl = \"\";\n                this.#maskKeyBase = \"\";\n                if (this.isConnected) {\n                    this.updateIcon(this.icon);\n                }\n                break;\n            }\n        }\n    }\n\n    #retryAttempt = 0;\n    static readonly #MAX_ICON_RETRIES = 3;\n    static readonly #RETRY_DELAY_MS = 500;\n\n    public updateIcon(icon?: string) {\n        const candidate = typeof icon === \"string\" && icon.length > 0 ? icon : this.icon;\n        const nextIcon = candidate?.trim?.() ?? \"\";\n\n        if (!this.isConnected) {\n            this.#pendingIconName = nextIcon;\n            return this;\n        }\n\n        if (typeof IntersectionObserver !== \"undefined\" && !this.#isIntersecting) {\n            this.#pendingIconName = nextIcon;\n            return this;\n        }\n\n        this.#pendingIconName = null;\n\n        if (!nextIcon) { return this; }\n\n        let iconStyle = (this.iconStyle ?? \"duotone\")?.trim?.()?.toLowerCase?.();\n        const ICON = camelToKebab(nextIcon);\n        // Use CDN for Phosphor icons (npm package assets; stable paths)\n        // Example:\n        // - https://cdn.jsdelivr.net/npm/@phosphor-icons/core@2/assets/duotone/folder-open-duotone.svg\n        // Validate icon name to prevent invalid requests\n        if (!ICON || !/^[a-z0-9-]+$/.test(ICON)) {\n            console.warn(`[ui-icon] Invalid icon name: ${ICON}`);\n            return this;\n        }\n\n        // Validate icon style\n        const validStyles = ['thin', 'light', 'regular', 'bold', 'fill', 'duotone'];\n        if (!validStyles.includes(iconStyle)) {\n            console.warn(`[ui-icon] Invalid icon style: ${iconStyle}, defaulting to 'duotone'`);\n            iconStyle = 'duotone';\n        }\n\n        // For duotone icons, append '-duotone' to the filename\n        // For other styles like 'fill', 'bold', etc., append '-{style}'\n        const iconFileName = iconStyle === 'duotone' ? `${ICON}-duotone` :\n                            iconStyle !== 'regular' ? `${ICON}-${iconStyle}` :\n                            ICON;\n\n        // Try direct CDN first (most reliable), then proxy (without suffix - proxy adds it), then local\n        const directCdnPath = `https://cdn.jsdelivr.net/npm/@phosphor-icons/core@2/assets/${iconStyle}/${iconFileName}.svg`;\n        const proxyCdnPath = `/assets/icons/phosphor/${iconStyle}/${ICON}.svg`; // Proxy expects base name, adds suffix\n        const base = (this.iconBase ?? \"\").trim().replace(/\\/+$/, \"\");\n        const localPath = base ? `${base}/${iconStyle}/${iconFileName}.svg` : \"\";\n        const requestKey = `${iconStyle}:${ICON}`;\n\n        this.#maskKeyBase = requestKey;\n\n        requestAnimationFrame(() => {\n            // Always attempt to load if we don't have a current icon URL, or if we're intersecting\n            const shouldLoad = !this.#currentIconUrl || this.#isIntersecting ||\n                (this?.checkVisibility?.({\n                    contentVisibilityAuto: true,\n                    opacityProperty: true,\n                    visibilityProperty: true,\n                }) ?? true);\n\n            console.log(`[ui-icon] Checking load conditions for ${requestKey}:`, {\n                hasCurrentUrl: !!this.#currentIconUrl,\n                isIntersecting: this.#isIntersecting,\n                shouldLoad\n            });\n\n            if (shouldLoad) {\n                const sources = (localPath ? [directCdnPath, proxyCdnPath, localPath] : [directCdnPath, proxyCdnPath]);\n                (async () => {\n                    let lastUrl: string | null = null;\n                    let lastError: unknown = null;\n\n                    for (const src of sources) {\n                        try {\n                            const url = await loadAsImage(src);\n                            lastUrl = url;\n\n                            // If local source returns fallback placeholder, try the CDN next.\n                            if (src === localPath && url === FALLBACK_ICON_DATA_URL) {\n                                continue;\n                            }\n                            break;\n                        } catch (e) {\n                            lastError = e;\n                        }\n                    }\n\n                    const url = lastUrl;\n                    console.log(`[ui-icon] Loaded icon ${requestKey} (${localPath ? \"local+proxy+fallback\" : \"proxy+fallback\"}):`, url);\n                    if (!url || typeof url !== \"string\") {\n                        console.warn(`[ui-icon] Invalid URL returned for ${requestKey}:`, url);\n                        return;\n                    }\n                    if (this.#maskKeyBase !== requestKey) {\n                        console.log(`[ui-icon] Ignoring outdated request for ${requestKey}`);\n                        return;\n                    }\n                    this.#currentIconUrl = url;\n                    this.#retryAttempt = 0;\n                    this.#queueMaskUpdate();\n\n                    // If both sources failed and we ended up with fallback, keep the old retry behavior for timeouts.\n                    if (url === FALLBACK_ICON_DATA_URL && lastError instanceof Error) {\n                        const isTimeout = lastError.message.includes(\"Timeout\");\n                        if (isTimeout && this.#retryAttempt < UIPhosphorIcon.#MAX_ICON_RETRIES && this.isConnected) {\n                            this.#retryAttempt++;\n                            setTimeout(() => {\n                                if (this.isConnected && this.#maskKeyBase === requestKey) {\n                                    this.updateIcon(nextIcon);\n                                }\n                            }, UIPhosphorIcon.#RETRY_DELAY_MS * this.#retryAttempt);\n                        }\n                    }\n                })().catch((error) => {\n                    if (typeof console !== \"undefined\") {\n                        console.error?.(\"[ui-icon] Failed to load icon sources\", { directCdnPath, proxyCdnPath, localPath }, error);\n                    }\n                });\n            }\n        });\n\n        return this;\n    }\n\n    #setupVisibilityObserver() {\n        console.log(`[ui-icon] Setting up visibility observer`);\n\n        if (typeof IntersectionObserver === \"undefined\") {\n            console.log(`[ui-icon] IntersectionObserver not available, setting intersecting to true`);\n            this.#isIntersecting = true;\n            return;\n        }\n\n        if (this.#intersectionObserver) {\n            console.log(`[ui-icon] Visibility observer already exists`);\n            return;\n        }\n\n        console.log(`[ui-icon] Creating new IntersectionObserver`);\n        this.#intersectionObserver = new IntersectionObserver((entries) => {\n            const isIntersecting = entries.some((entry) => entry.isIntersecting);\n            console.log(`[ui-icon] IntersectionObserver callback: isIntersecting=${isIntersecting}, was=${this.#isIntersecting}`);\n\n            if (isIntersecting !== this.#isIntersecting) {\n                this.#isIntersecting = isIntersecting;\n                if (isIntersecting) {\n                    console.log(`[ui-icon] Element became visible, updating icon`);\n                    this.updateIcon(this.#pendingIconName ?? this.icon);\n                }\n            }\n        }, { rootMargin: \"100px\" });\n\n        console.log(`[ui-icon] Starting observation`);\n        this.#intersectionObserver.observe(this);\n\n        // Handle content-visibility\n        // @ts-ignore\n        this.addEventListener(\"contentvisibilityautostatechange\", this.#handleContentVisibility);\n\n        // Initially assume intersecting to allow loading\n        console.log(`[ui-icon] Setting initial intersecting state to true`);\n        this.#isIntersecting = true;\n    }\n\n    #teardownVisibilityObserver() {\n        this.#intersectionObserver?.disconnect();\n        this.#intersectionObserver = undefined;\n        // @ts-ignore\n        this.removeEventListener(\"contentvisibilityautostatechange\", this.#handleContentVisibility);\n    }\n\n    #handleContentVisibility = (e: Event) => {\n        // @ts-ignore\n        if (e.skipped === false) {\n            this.updateIcon(this.#pendingIconName ?? this.icon);\n        }\n    }\n\n    #ensureShadowRoot() {\n        if (!this.shadowRoot) {\n            this.attachShadow({ mode: \"open\" });\n        }\n    }\n\n    #applyHostDefaults() {\n        this.classList.add(\"ui-icon\", \"u2-icon\");\n\n        try {\n            (this as unknown as { inert: boolean }).inert = true;\n        } catch {\n            this.setAttribute(\"inert\", \"\");\n        }\n\n        /*if (!this.hasAttribute(\"aria-hidden\")) {\n            this.setAttribute(\"aria-hidden\", \"true\");\n        }*/\n\n        const paddingOption = this.#options.padding;\n        if (\n            !this.style.getPropertyValue(\"--icon-padding\") &&\n            paddingOption !== undefined &&\n            paddingOption !== null &&\n            paddingOption !== \"\"\n        ) {\n            const paddingValue =\n                typeof paddingOption === \"number\" ? `${paddingOption}rem` : String(paddingOption);\n            this.style.setProperty(\"--icon-padding\", paddingValue);\n        }\n\n        const sizeAttr = this.getAttribute(\"size\");\n        if (sizeAttr) {\n            this.style.setProperty(\"--icon-size\", (typeof sizeAttr === \"number\" || /^\\d+$/.test(sizeAttr)) ? `${sizeAttr}px` : sizeAttr);\n        }\n\n        // Note: --icon-image is now set via CSS rules with attribute selectors\n        // e.g., ui-icon[icon=\"house\"][icon-style=\"duotone\"] { --icon-image: image-set(...); }\n        // No inline style needed - the CSS registry handles it lazily\n    }\n\n    #setupResizeObserver(element: HTMLElement) {\n        if (typeof ResizeObserver === \"undefined\" || this.#resizeObserver) { return; }\n        this.#resizeObserver = new ResizeObserver((entries) => {\n            for (const entry of entries) {\n                if (entry.target !== element) { continue; }\n\n                const deviceSize = entry.devicePixelContentBoxSize?.[0];\n                const contentSize = Array.isArray(entry.contentBoxSize)\n                    ? entry.contentBoxSize[0]\n                    : (entry.contentBoxSize as unknown as ResizeObserverSize | undefined);\n\n                const ratio =\n                    typeof devicePixelRatio === \"number\" && isFinite(devicePixelRatio)\n                        ? devicePixelRatio\n                        : 1;\n\n                const inline =\n                    deviceSize?.inlineSize ??\n                    (contentSize?.inlineSize ?? entry.contentRect?.width ?? element.clientWidth ?? MIN_RASTER_SIZE) *\n                        ratio;\n                const block =\n                    deviceSize?.blockSize ??\n                    (contentSize?.blockSize ?? entry.contentRect?.height ?? element.clientHeight ?? MIN_RASTER_SIZE) *\n                        ratio;\n\n                this.#devicePixelSize = {\n                    inline: inline || MIN_RASTER_SIZE,\n                    block: block || MIN_RASTER_SIZE,\n                };\n                this.#queueMaskUpdate();\n            }\n        });\n\n        try {\n            this.#resizeObserver.observe(element, { box: \"device-pixel-content-box\" as const });\n        } catch {\n            this.#resizeObserver.observe(element);\n        }\n    }\n\n    #queueMaskUpdate() {\n        if (!this.#currentIconUrl || !this.isConnected) { return; }\n        if (this.#queuedMaskUpdate) { return; }\n\n        const forResolve = Promise.withResolvers<void>();\n        this.#queuedMaskUpdate = forResolve?.promise;\n        requestAnimationFrame(() => {\n            this.#queuedMaskUpdate = null;\n            forResolve?.resolve();\n            const url = this.#currentIconUrl;\n            if (!url || !this.isConnected) { return; }\n\n            const bucket = this.#getRasterBucket();\n            const iconName = camelToKebab(this.icon);\n            const iconStyle = this.iconStyle;\n\n            // Check if CSS rule already exists for this icon combination\n            if (hasIconRule(iconName, iconStyle, bucket)) {\n                // Rule exists, CSS handles the styling via attribute selectors\n                return;\n            }\n\n            // Generate mask value and register CSS rule\n            ensureMaskValue(url, this.#maskKeyBase, bucket)\n                .then((maskValue) => {\n                    console.log(`[ui-icon] Got mask value for ${iconName}:${iconStyle}:`, maskValue);\n\n                    // Register the icon in CSS registry with attribute-based selector\n                    // The rule: ui-icon[icon=\"name\"][icon-style=\"style\"] { --icon-image: ... }\n                    registerIconRule(iconName, iconStyle, maskValue, bucket);\n                    console.log(`[ui-icon] Registered CSS rule for ${iconName}:${iconStyle}`);\n\n                    // Keep local ref for fallback/debugging\n                    if (this.#maskRef.value !== maskValue) {\n                        this.#maskRef.value = maskValue;\n                    }\n                })\n                .catch((error) => {\n                    if (typeof console !== \"undefined\") {\n                        console.warn?.(\"[ui-icon] Mask update failed\", error);\n                    }\n                });\n        });\n    }\n\n    #getRasterBucket(): number {\n        const self = this as unknown as HTMLElement;\n        const inline = Math.ceil(this.#devicePixelSize?.inline || 0);\n        const block = Math.ceil(this.#devicePixelSize?.block || 0);\n        const candidate = Math.max(inline, block);\n        if (candidate > 0) {\n            return quantizeToBucket(candidate);\n        }\n\n        let fallback = MIN_RASTER_SIZE;\n        const ratio =\n            typeof devicePixelRatio === \"number\" && isFinite(devicePixelRatio)\n                ? devicePixelRatio\n                : 1;\n\n        if (typeof self.getBoundingClientRect === \"function\") {\n            const rect = self.getBoundingClientRect();\n            const maximum = Math.max(rect.width, rect.height) * ratio;\n            if (maximum > 0) {\n                fallback = maximum;\n            }\n        }\n\n        return quantizeToBucket(fallback);\n    }\n}\n\ndeclare global {\n    interface HTMLElementTagNameMap {\n        \"ui-icon\": UIPhosphorIcon;\n    }\n}\n\nif (typeof window !== \"undefined\" && !customElements.get(\"ui-icon\")) {\n    console.log(UIPhosphorIcon);\n    customElements.define(\"ui-icon\", UIPhosphorIcon);\n}\n","/**\n * FL.UI with Veela Basic Entry Point\n *\n * Use this entry point for lightweight styling with veela-basic.\n *\n * @example\n * ```ts\n * import { Button, Card } from \"fest/fl-ui/veela-basic\";\n * ```\n */\n\nimport { loadInlineStyle, preloadStyle } from \"fest/dom\";\nimport { UIPhosphorIcon } from \"fest/icon\";\nconsole.log(UIPhosphorIcon);\n\n//\nimport { loadVeelaVariant } from \"fest/veela\";\n\n// @ts-ignore\nimport coreStyles from \"./index.core.scss?inline\";\n\n//\nexport const loader = async () => {\n    try {\n        await loadVeelaVariant(\"basic\");\n    } catch {\n        console.warn(\"[FL.UI] Could not load veela-basic runtime\");\n    }\n\n    // Keep fl.ui core styles after veela runtime so component styles can override base normalize.\n    const styled = await preloadStyle(coreStyles);\n    await loadInlineStyle(coreStyles);\n};\n\n//\nexport default loader;\n","import { preloadStyle, loadAsAdopted } from \"fest/dom\";\nimport { defineElement, GLitElement, H, property } from \"fest/lure\";\nimport { ensureStyleSheet } from \"fest/icon\";\n\n// @ts-ignore\n@defineElement(\"ui-element\")\nexport class UIElement extends GLitElement() {\n    @property({ source: \"attr\" }) theme: string = \"default\";\n\n    //\n    render = function () { return H`<slot></slot>`; }\n\n    //\n    constructor() { super(); }\n\n    //\n    onRender(): this|void|undefined {\n        return super.onRender();\n    }\n\n    //\n    connectedCallback(): this {\n        const result = super.connectedCallback?.();\n        const self : any = result ?? this;\n        return self;\n    }\n\n    //\n    onInitialize(): this {\n        const result = super.onInitialize();\n        // Only load icon styles, not the heavy veela runtime styles\n        // which cause freezing/hanging performance issues\n        const self : any = result ?? this;\n        self.loadStyleLibrary(ensureStyleSheet());\n        return self;\n    }\n}\n\n//\nexport default UIElement;\n","import { propRef, affected } from \"fest/object\";\nimport { handleHidden, handleAttribute, handleStyleChange, setStyleProperty, addEvent } from \"fest/dom\";\nimport { bindWith, ITask } from \"fest/lure\";\n\n//\nexport class TaskStateReflect {\n    task?: ITask|null;\n    element?: HTMLElement|any|null;\n    listeners?: {\n        click?: any|null;\n        keydown?: any|null;\n        focus?: any|null;\n        blur?: any|null;\n        close?: any|null;\n        minimize?: any|null;\n        maximize?: any|null;\n    }|null;\n    bindings?: {\n        visible?: any|null;\n        focus?: any|null;\n        title?: any|null;\n        icon?: any|null;\n        order?: any|null;\n        orderSub?: any|null;\n    }|null;\n\n    //\n    constructor(element: HTMLElement|any|null = null, task: ITask|null = null) {\n        this.update(element, task);\n    }\n\n    //\n    update(element: HTMLElement|any|null = null, task: ITask|null = null) {\n        if (this.task !== task) { this.task = task; }\n        this.bind(element);\n        return this;\n    }\n\n    //\n    unbind() {\n        if (this.bindings) {\n            Object.values(this.bindings).forEach((binding)=>{ typeof binding == \"function\" ? binding() : binding?.unbind?.() });\n            this.bindings?.orderSub?.();\n            this.bindings = null;\n        }\n        if (this.listeners) {\n            Object.values(this.listeners).forEach((listener)=>{ typeof listener == \"function\" ? listener() : listener?.remove?.() });\n            this.listeners = null;\n        }\n        if (this.element) {\n            handleHidden(this.element, this.task, false);\n            handleAttribute(this.element, \"data-focus\", null);\n            handleAttribute(this.element, \"data-title\", null);\n            handleAttribute(this.element, \"data-icon\", null);\n            handleStyleChange(this.element, \"--order\", null);\n        }\n    }\n\n    //\n    bind(element: HTMLElement|any|null = null) {\n        if (this.element !== element) { this.element = element; }\n        if (this.bindings) { this.unbind();  }\n\n        //\n        if (this.element) {\n            this.bindings ??= {};\n\n            const visibleRef = propRef(this.task, \"active\");\n            this.bindings.visible = bindWith(this.element, \"data-hidden\", visibleRef, handleHidden);\n\n            const titleRef = propRef(this.task?.payload, \"title\");\n            this.bindings.title = bindWith(this.element, \"title\", titleRef, handleAttribute);\n\n            const iconRef = propRef(this.task?.payload, \"icon\");\n            this.bindings.icon = bindWith(this.element, \"icon\", iconRef, handleAttribute);\n\n            //\n            setStyleProperty(this.element, \"--order\", this.task?.order);\n            document.addEventListener(\"task-focus\", (e)=>{ setStyleProperty(this.element, \"--order\", this.task?.order); });\n\n            // UI-events\n            this.listeners ??= {};\n            this.listeners.click = addEvent(this.element, \"pointerdown\", ()=>{ if (this.task) { this.task.focus = true; } });\n            this.listeners.keydown = addEvent(this.element, \"keydown\", (e)=>{ if (e.key == \"Enter\" && this.task) { this.task.focus = true; } });\n            this.listeners.focus = addEvent(this.element, \"focus\", (e)=>{ if (this.task) { this.task.focus = true; } });\n            this.listeners.blur = addEvent(this.element, \"blur\", (e)=>{ if (this.task) { this.task.focus = false; } });\n\n            // UI-actions\n            this.listeners.close = addEvent(this.element, \"close\", (e)=>{ if (this.task) {\n                this.element.addEventListener(\"u2-hidden\", ()=>{ this.task?.removeFromList(); }, {once: true});\n                this.element.setAttribute(\"data-hidden\", \"\");\n            } });\n            this.listeners.minimize = addEvent(this.element, \"minimize\", (e)=>{ if (this.task) { this.task.focus = false; this.task.active = false; } });\n\n            // TODO: under consideration\n            this.listeners.maximize = addEvent(this.element, \"maximize\", (e)=>{ if (this.task) { /*this.task.maximized = true;*/ } });\n        }\n        return this;\n    }\n}\n","import { defineElement, property, H, E, DragHandler, ResizeHandler, ITask  } from \"fest/lure\";\nimport { handleAttribute, preloadStyle, setStyleProperty } from \"fest/dom\";\n\n//\nimport { UIElement } from \"@fl-ui/base/UIElement\";\nimport { TaskStateReflect } from \"@fl-ui/navigation/misc/TaskStateReflect\";\n\n// @ts-ignore\nimport styles from \"./WindowFrame.scss?inline\"\nconst styled  = preloadStyle(styles);\n\n\n\n// @ts-ignore\n@defineElement(\"ui-window-frame\")\nexport class WindowFrame extends UIElement {\n    /* Attributes */\n    @property({ source: \"attr\", name: \"name\" }) name?: string = \"\";\n    @property({ source: \"attr\", name: \"icon\" }) icon?: string = \"app-window\";\n    @property({ source: \"attr\", name: \"title\" }) title?: string = \"WINDOW_FRAME_TITLE\";\n    @property({ source: \"attr\", name: \"subtitle\" }) subtitle?: string = \"WINDOW_FRAME_SUBTITLE\";\n\n    /* Public Attributes */\n    @property({ source: \"attr\", name: \"close-icon\" }) closeIcon?: string = \"x\";\n    @property({ source: \"attr\", name: \"minimize-icon\" }) minimizeIcon?: string = \"minus\";\n    @property({ source: \"attr\", name: \"maximize-icon\" }) maximizeIcon?: string = \"corners-out\";\n\n    /* Shadow DOM Elements */\n    @property({ source: \"query-shadow\", name: \".ui-window-frame-content\" }) contentEl?: HTMLElement;\n    @property({ source: \"query-shadow\", name: \".ui-window-frame-titlebar\" }) titlebarEl?: HTMLElement;\n    @property({ source: \"query-shadow\", name: \".ui-window-frame-titlebar-handle\" }) titlebarHandleEl?: HTMLElement;\n    @property({ source: \"query-shadow\", name: \".ui-window-frame-titlebar-app-icon\" }) appIconEl?: HTMLSpanElement;\n    @property({ source: \"query-shadow\", name: \".ui-window-frame-resize-handle\" }) resizeHandleEl?: HTMLElement;\n    @property({ source: \"query-shadow\", name: \".ui-window-frame-titlebar-title-text\" }) titleTextEl?: HTMLSpanElement;\n    @property({ source: \"query-shadow\", name: \".ui-window-frame-titlebar-title-text-sub\" }) titleTextSubEl?: HTMLSpanElement;\n    @property({ source: \"query-shadow\", name: \".ui-window-frame-titlebar-control-close\" }) closeEl?: HTMLButtonElement;\n    @property({ source: \"query-shadow\", name: \".ui-window-frame-titlebar-control-minimize\" }) minimizeEl?: HTMLButtonElement;\n    @property({ source: \"query-shadow\", name: \".ui-window-frame-titlebar-control-maximize\" }) maximizeEl?: HTMLButtonElement;\n\n    //\n    task: ITask|null = null;\n    reflect?: TaskStateReflect|null;\n\n    //\n    constructor() { super(); }\n    onInitialize() {\n        super.onInitialize();  // @ts-ignore\n        new DragHandler(this as any, { handler: this.titlebarHandleEl });  // @ts-ignore\n        new ResizeHandler(this as any, { handler: this.resizeHandleEl });\n        E(this as any, { classList: new Set([\"c2-surface\"]) })\n\n        //\n        const self: any = this;\n        const weak = new WeakRef(self);\n\n        //\n        const withDispatch = (name)=>((ev)=>{\n            ev.preventDefault();\n            weak.deref?.().dispatchEvent(new CustomEvent(name, { bubbles: true, cancelable: true, }));\n        })\n\n        //\n        this.closeEl?.addEventListener(\"click\", withDispatch(\"close\"));\n        this.minimizeEl?.addEventListener(\"click\", withDispatch(\"minimize\"));\n        this.maximizeEl?.addEventListener(\"click\", withDispatch(\"maximize\"));\n\n        //\n        self.addEventListener(\"maximize\", ()=>{ handleAttribute(self, \"data-maximized\", self.getAttribute(\"data-maximized\") != null ? false : true); });\n        self.setAttribute(\"data-dragging\", \"\");\n\n        //\n        //this.doCenter();\n        this.bindWithTask();\n    }\n\n\n\n    //\n    bindWithTask(task: ITask|null = null) {\n        if (this.task != task) {\n            if (this.task && task) { this.reflect?.unbind(); this.reflect = null; this.task = null; }\n            if (this.task = task ?? this.task) { this.reflect ??= new TaskStateReflect(this.task, this as any); this.reflect?.bind(this as any); }\n        }\n        return this;\n    }\n\n    //\n    onRender() {\n        // @ts-ignore\n        super.onRender(); //this.doCenter();\n        queueMicrotask(()=>{ this.doCenter(); });\n    }\n\n    //\n    doCenter () {\n        const holder: any = this;\n        const box = holder.getBoundingClientRect();\n        const parent = holder.parentElement;\n        const parentBox = parent?.getBoundingClientRect();\n        const cX = (parentBox?.width || 0) / 2 - (box?.width || 0) / 2;\n        const cY = (parentBox?.height || 0) / 2 - (box?.height || 0) / 2;\n        setStyleProperty(holder, \"--shift-x\", cX - (parentBox?.left || 0));\n        setStyleProperty(holder, \"--shift-y\", cY - (parentBox?.top || 0));\n        holder.removeAttribute(\"data-dragging\");\n    }\n\n    //\n    styles = function () { return styled; }\n    render = function () { return H`\n        <div class=\"ui-window-frame-titlebar\" part=\"titlebar\">\n            <span class=\"ui-window-frame-titlebar-handle\" part=\"handle\">\n                <span class=\"ui-window-frame-titlebar-app-icon\" part=\"app-icon\">\n                    <ui-icon name=\"window-frame-app-icon\" icon=${this.icon ?? \"window-frame-app-icon\"}></ui-icon>\n                </span>\n                <span class=\"ui-window-frame-titlebar-title-text\" part=\"title-text\">\n                    ${this.title || H`<slot name=\"title\"></slot>`}\n                </span>\n                <span class=\"ui-window-frame-titlebar-title-text-sub\" part=\"title-text-sub\">\n                    ${this.subtitle || H`<slot name=\"subtitle\"></slot>`}\n                </span>\n            </span>\n            <span class=\"ui-window-frame-titlebar-controls\" part=\"controls\">\n                <button class=\"ui-window-frame-titlebar-control-minimize\" part=\"control-minimize\">\n                    <ui-icon name=\"window-frame-minimize\" icon=${this.minimizeIcon ?? \"minus\"}></ui-icon>\n                </button>\n                <button class=\"ui-window-frame-titlebar-control-maximize\" part=\"control-maximize\">\n                    <ui-icon name=\"window-frame-maximize\" icon=${this.maximizeIcon ?? \"corners-out\"}></ui-icon>\n                </button>\n                <button class=\"ui-window-frame-titlebar-control-close\" part=\"control-close\">\n                    <ui-icon name=\"window-frame-close\" icon=${this.closeIcon ?? \"x\"}></ui-icon>\n                </button>\n            </span>\n        </div>\n        <div class=\"ui-window-frame-content ui-window-frame-anchor-box\" part=\"content\">\n            <slot></slot>\n        </div>\n        <span class=\"ui-window-frame-resize-handle\" part=\"resize-handle\"></span>`; }\n}\n\n//\nexport default WindowFrame;\n","import { defineElement, H, E, M, I, property } from \"fest/lure\"\nimport { preloadStyle } from \"fest/dom\"\nimport { $trigger, observableByMap, propRef, affected } from \"fest/object\";\n\n//\nimport { UIElement } from \"@fl-ui/base/UIElement\"\n\n// @ts-ignore\nimport styles from \"./TabbedBox.scss?inline\"\nconst styled = preloadStyle(styles);\n\n\n\n//\nconst renderTabName = (tabName: any) => {\n    if (typeof tabName != \"string\") { return tabName; }\n    if (tabName == null || tabName == \"\") { return \"\"; }\n\n    // split _ as spaces\n    tabName = tabName?.replace?.(/_/g, \" \") || tabName;\n\n    // capitalize first word letter\n    tabName = (tabName?.charAt?.(0)?.toUpperCase?.() + tabName?.slice?.(1)) || tabName;\n\n    //\n    return tabName;\n}\n\n//\nconst addPartProperty = (element: HTMLElement | string, name: string = \"\") => {\n    if (typeof element == \"string\") { return element; }\n    if (element instanceof HTMLElement) {\n        element?.setAttribute?.(`tab`, name);\n        element?.setAttribute?.(`part`, \"tab\");\n    }\n    return element;\n}\n\n//\nconst clamp = (value: number, min: number, max: number) => Math.max(min, Math.min(max, value));\n\n//\nclass TabChangedEvent extends Event {\n    newTab?: string;\n    constructor(name, options, newTab) {\n        super(name, options);\n        this.newTab = newTab;\n    }\n}\n\n\n//\nconst normalizeOrient = (value?: string | number): 0 | 2 => {\n    if (typeof value === \"number\") {\n        const numeric = Number.isFinite(value) ? Math.trunc(value) : 0;\n        return numeric === 2 ? 2 : 0;\n    }\n    if (typeof value === \"string\") {\n        const normalized = value.trim().toLowerCase();\n        if (!normalized.length) { return 0; }\n        if (normalized === \"2\" || normalized === \"top\") { return 2; }\n        if (normalized === \"0\" || normalized === \"bottom\") { return 0; }\n        const parsed = Number.parseInt(normalized, 10);\n        if (Number.isFinite(parsed) && parsed === 2) { return 2; }\n        return 0;\n    }\n    return 0;\n}\n\n// @ts-ignore\n@defineElement(\"ui-tabbed-box\")\nexport class TabbedBox extends UIElement {\n    @property({ source: \"attr\", name: \"current-tab\" }) currentTab?: string = \"\";\n    @property({ source: \"attr\", name: \"orient\" }) orient?: string | number = 1;\n\n    //\n    constructor() { super(); const self: any = this; self.currentTab ??= \"\"; }\n    onInitialize() {\n        const self: any = this;\n        super.onInitialize?.();\n\n        //\n        self.currentTab ||= [...self?.tabs?.keys?.() ?? []]?.[0] || \"\";\n\n        //\n        E(self, {}, [I({ current: propRef(self as any, \"currentTab\"), mapped: self.tabs })])\n\n        //\n        affected(propRef(self as any, \"currentTab\"), (_newVal)=>{\n            self.dispatchEvent(new TabChangedEvent(\"tab-changed\", { bubbles: true }, self.currentTab));\n        });\n\n        //\n        /*requestAnimationFrame(() => {\n            self.setAttribute(\"orient\", \"1\");\n        });*/\n\n        //\n        self.addEventListener(\"keydown\", (e: KeyboardEvent) => {\n            const target  = e?.composedPath?.()?.[0] as HTMLElement;\n            const isInput = target?.tagName === \"INPUT\" || target?.tagName === \"TEXTAREA\" || target?.isContentEditable;\n            if (isInput) { return; }\n\n            //\n            if ((e?.key === \"ArrowLeft\" || e?.key === \"ArrowRight\") && self?.checkVisibility({\n                contentVisibilityAuto: true,\n                opacityProperty: true,\n                visibilityProperty: true\n            })) {\n                e?.preventDefault?.();\n                e?.stopPropagation?.();\n\n                //\n                const tabs = Array.from(self?.tabs?.keys?.() ?? []);\n                if (!tabs?.length) { return; }\n\n                //\n                const currentIndex = tabs?.indexOf?.(self?.currentTab ?? \"\");\n                let newIndex = currentIndex;\n\n                //\n                if (e?.key === \"ArrowLeft\") {\n                    newIndex = currentIndex - 1;\n                    if (newIndex < 0) { newIndex = tabs?.length - 1; }\n                } else {\n                    newIndex = currentIndex + 1;\n                    if (newIndex >= tabs?.length) { newIndex = 0; }\n                }\n\n                //\n                const newTab = tabs?.[newIndex];\n                self?.openTab?.(newTab);\n            }\n        });\n    }\n\n    //\n    setTabs(tabs: Map<string, HTMLElement | string | any>) {\n        const self: any = this;\n        self.tabs ??= tabs ?? self.tabs;\n    }\n\n    //\n    onRender() {\n        const self: any = this;\n        if (!self.tabs || !self.currentTab) return;\n        this.observeTabsOverflow?.();\n    }\n\n    //\n    createTab(tabName: string, idx?: number) {\n        if (!tabName) return;\n        const self: any = this;\n        const tabLabel  = H`<span part=\"tab-label\" class=\"ui-tabbed-box-tab-label\">${(self?.renderTabName?.bind?.(self) ?? renderTabName)?.(tabName) ?? tabName}</span>`;\n        const tabButton = H`<button part=\"tab\" slot=\"tabs\" type=\"button\" on:click=${(ev: Event)=>self.openTab(tabName, ev)} class=\"ui-tabbed-box-tab\" role=\"tab\" tab-name=${tabName} tab-index=${idx}>${tabLabel}</button>`;\n        addPartProperty(tabButton, tabName);\n        propRef(self as any, \"currentTab\")?.[$trigger]?.();\n        return tabButton; //@ts-ignore\n    }\n\n    //\n    openTab(tabName: string, ev?: any) {\n        if (!tabName) return;\n        const self: any = this;\n        if (tabName) {\n            const btn = self.shadowRoot?.querySelector(`[tab-name=\"${tabName}\"]`);\n            if (btn instanceof HTMLElement) (btn as HTMLElement)?.focus?.();\n\n            //\n            self.currentTab = tabName ?? self.currentTab;\n            self.dispatchEvent(new TabChangedEvent(\"tab-changed\", { bubbles: true }, self.currentTab));\n        }\n    }\n\n    //\n    styles = () => styled;\n    render = function () {\n        const self: any = this;\n        const root = H`\n        <div class=\"ui-tabbed-box-tabs-container\"><form class=\"ui-tabbed-box-tabs\" part=\"tabs\">${M(observableByMap(self.tabs ?? new Map()), ([key, _], idx) => this.createTab(key, idx))}</form></div>\n        <div class=\"ui-tabbed-box-content\" part=\"content\"><slot></slot></div>`\n        return root;\n    }\n\n    //\n    private tabsBox?: HTMLElement\n    private detachTabsOverflow?: () => void\n    private resizeObserver?: ResizeObserver\n    private observeTabsOverflow() {\n        const self: any = this;\n        this.tabsBox = self.shadowRoot?.querySelector?.(\".ui-tabbed-box-tabs\") ?? undefined;\n        const tabsBox = this.tabsBox;\n        if (!tabsBox) return;\n\n        this.detachTabsOverflow?.();\n        this.resizeObserver?.disconnect();\n\n        const updateIndicators = () => {\n            queueMicrotask(() => {\n                if (tabsBox) {\n                    const maxScrollLeft = tabsBox.scrollWidth - tabsBox.clientWidth;\n                    const hasOverflow = maxScrollLeft > 1;\n                    const startOverflow = tabsBox.scrollLeft > 1;\n                    const endOverflow = tabsBox.scrollLeft < maxScrollLeft - 1;\n\n                    if (tabsBox.hasAttribute(\"scrollable\") !== hasOverflow) {\n                        tabsBox.toggleAttribute(\"scrollable\", hasOverflow);\n                    }\n                    if (tabsBox.hasAttribute(\"scrollable-start\") !== startOverflow) {\n                        tabsBox.toggleAttribute(\"scrollable-start\", startOverflow);\n                    }\n                    if (tabsBox.hasAttribute(\"scrollable-end\") !== endOverflow) {\n                        tabsBox.toggleAttribute(\"scrollable-end\", endOverflow);\n                    }\n                }\n            });\n        };\n\n        const onWheel = (event: WheelEvent) => {\n            if (Math.abs(event.deltaX) < Math.abs(event.deltaY)) {\n                const delta = clamp(event.deltaY, -80, 80);\n                tabsBox.scrollLeft += delta;\n                event.preventDefault();\n            }\n        };\n\n        const onPointerUp = () => updateIndicators();\n\n        tabsBox.addEventListener(\"wheel\", onWheel, { passive: false });\n        tabsBox.addEventListener(\"scroll\", updateIndicators, { passive: true });\n        tabsBox.addEventListener(\"pointerup\", onPointerUp, { passive: true });\n\n        this.detachTabsOverflow = () => {\n            tabsBox.removeEventListener(\"wheel\", onWheel);\n            tabsBox.removeEventListener(\"scroll\", updateIndicators);\n            tabsBox.removeEventListener(\"pointerup\", onPointerUp);\n        };\n\n        updateIndicators();\n        queueMicrotask(updateIndicators);\n\n        if (typeof ResizeObserver !== \"undefined\") {\n            this.resizeObserver = new ResizeObserver(updateIndicators);\n            this.resizeObserver.observe(tabsBox);\n        }\n    }\n}\n\n//\nexport default TabbedBox;\n","import { defineElement, Q, H, makeClickOutsideTrigger, registerSidebar } from \"fest/lure\"\nimport { preloadStyle } from \"fest/dom\"\nimport { booleanRef, conditional, affected } from \"fest/object\"\nimport { UIElement } from \"@fl-ui/base/UIElement\"\n\n/*\n * Used for mobile applications\n * In desktop or widescreen sidebar can be statically visible\n * In mobile applications sidebar is hidden by default and can be opened by clicking on the button\n *\n * <ui-box-with-sidebar>\n *   <div slot=\"bar\">\n *     <button part=\"open-sidebar\" class=\"open-sidebar\" on:click=${()=>{this.sidebarOpened.value = true;}}></button>\n *     <button class=\"open-sidebar\" on:click=${()=>{this.sidebarOpened.value = true;}}></button>\n *     <slot name=\"bar\"></slot>\n *   </div>\n *   <div part=\"sidebar\" class=\"sidebar c2-surface\" visibility=\"${this.sidebarOpened}\"><slot name=\"sidebar\"></slot></div>\n *   <div part=\"content\" class=\"content\"><slot></slot></div>\n * </ui-box-with-sidebar>\n */\n\n// @ts-ignore\nimport styles from \"./BoxWithSidebar.scss?inline\"\nconst styled = preloadStyle(styles);\n\n// @ts-ignore\n@defineElement(\"ui-box-with-sidebar\")\nexport class BoxWithSidebar extends UIElement {\n    sidebarOpened = booleanRef(false); //@ts-ignore\n\n    //\n    constructor() { super(); }\n    onInitialize() { super.onInitialize?.(); }\n    onRender() {\n        const self: any = this;\n        makeClickOutsideTrigger(self.sidebarOpened, Q(\"button\", self?.shadowRoot), Q(\".sidebar\", self?.shadowRoot));\n\n        //\n        Q(\"a\")?.addEventListener?.(\"click\", ()=>{\n            self.sidebarOpened.value = false;\n        });\n\n        //\n        self.sidebarOpened.value = false;\n\n        // Register sidebar with back navigation for mobile back gesture support\n        /*const sidebarEl = Q(\".sidebar\", self?.shadowRoot);\n        if (sidebarEl) {\n            registerSidebar(sidebarEl as HTMLElement, self.sidebarOpened);\n        }*/\n    }\n\n    //\n    styles = () => styled;\n    render = function () {\n        return H`<div part=\"bar\" class=\"bar c2-surface\"><button part=\"open-sidebar\" class=\"open-sidebar c2-surface\" on:click=${() => { this.sidebarOpened.value = !this.sidebarOpened.value; }}><ui-icon icon=\"${conditional(this.sidebarOpened, 'text-outdent', 'list')}\"></ui-icon></button><slot name=\"bar\"></slot></div>\n    <div part=\"content-box\" class=\"content-box\"><div part=\"sidebar\" class=\"sidebar\" data-visible=${this.sidebarOpened}><slot name=\"sidebar\"></slot></div><div part=\"content\" class=\"content\"><slot></slot></div></div>`;\n    }\n}\n\n//\nexport default BoxWithSidebar;\n","import { defineElement, Q, H, makeClickOutsideTrigger, M, property, registerSidebar } from \"fest/lure\"\nimport { preloadStyle } from \"fest/dom\"\nimport { $trigger, booleanRef, conditional, observableByMap, propRef, stringRef, affected } from \"fest/object\"\nimport { UIElement } from \"@fl-ui/base/UIElement\"\n\n// @ts-ignore\nimport styles from \"./TabbedSidebar.scss?inline\"\nconst styled = preloadStyle(styles);\n\n\n\n//\nconst renderTabName = (tabName: any) => {\n    if (tabName == \"home\") { return H`<ui-icon icon=\"house-line\"></ui-icon>`; };\n\n    //\n    if (typeof tabName != \"string\") { return tabName; }\n    if (tabName == null || tabName == \"\") return \"\";\n\n    // split _ as spaces\n    tabName = tabName?.replace?.(/_/g, \" \") || tabName;\n\n    // capitalize first word letter\n    tabName = (tabName?.charAt?.(0)?.toUpperCase?.() + tabName?.slice?.(1)) || tabName;\n\n    //\n    return tabName;\n}\n\n//\nconst addPartProperty = (element: HTMLElement | string, name: string = \"\") => {\n    if (typeof element == \"string\") { return element; }\n    if (element instanceof HTMLElement) {\n        element?.setAttribute?.(`data-tab`, name);\n        element?.setAttribute?.(`part`, \"tab\");\n    }\n    return element;\n}\n\n//\nconst clamp = (value: number, min: number, max: number) => Math.max(min, Math.min(max, value));\n\n//\nconst normalizeTabPosition = (value?: string): \"top\" | \"bottom\" => {\n    const normalized = String(value || \"top\").trim().toLowerCase();\n    return normalized === \"bottom\" ? \"bottom\" : \"top\";\n};\n\n//\nconst parseBooleanOption = (value: unknown): boolean => {\n    if (typeof value === \"boolean\") { return value; }\n    if (typeof value === \"number\") { return value !== 0; }\n    if (value == null) { return false; }\n    const normalized = String(value).trim().toLowerCase();\n    if (!normalized.length) { return true; }\n    if ([\"false\", \"0\", \"no\", \"off\", \"null\", \"undefined\"].includes(normalized)) { return false; }\n    return true;\n};\n\n\n//\nclass TabChangedEvent extends Event {\n    newTab?: string;\n    constructor(name, options, newTab) {\n        super(name, options);\n        this.newTab = newTab;\n    }\n}\n\n//\nclass TabCloseEvent extends Event {\n    tabName?: string;\n    constructor(name, options, tabName) {\n        super(name, options);\n        this.tabName = tabName;\n    }\n}\n\n// @ts-ignore\n@defineElement(\"ui-tabbed-with-sidebar\")\nexport class TabbedSidebar extends UIElement {\n    @property({ source: \"attr\", name: \"current-tab\" }) currentTab?: string = \"\"; //@ts-ignore\n    @property({ source: \"attr\", name: \"tab-position\" }) tabPosition?: string = \"top\"; //@ts-ignore\n    @property({ source: \"attr\", name: \"sidebar-drop-menu\" }) sidebarAsDropMenu?: string | boolean = null; //@ts-ignore\n    @property({ source: \"attr\", name: \"sidebar-opened\" }) sidebarOpened?: string | boolean = false; //@ts-ignore\n    @property({ source: \"attr\", name: \"toolbar-opened\" }) toolbarOpened?: string | boolean = false; //@ts-ignore\n\n    //\n    setTabs(tabs: Map<string, HTMLElement | string | any>) {\n        const self: any = this;\n        self.tabs ??= tabs ?? self.tabs;\n    }\n\n    //\n    createTab(tabName: string, idx?: number) {\n        if (!tabName) return;\n        // Never render internal keys as tabs\n        if (typeof tabName === \"string\" && tabName.startsWith(\"_\")) { return; }\n        const self: any = this; if (self?.shadowRoot?.querySelector(`[data-tab-name=\"${tabName}\"]`)) return;\n        const renderLabel = self?.renderTabName?.bind?.(self) ?? renderTabName;\n        const rawLabel = renderLabel?.(tabName) ?? tabName;\n        const readableLabel = typeof rawLabel === \"string\" ? rawLabel : renderTabName?.(String(tabName ?? \"\")) ?? String(tabName ?? \"\");\n\n        //\n        const tabLabel = H`<span class=\"ui-tabbed-box-tab-label\">${rawLabel}</span>`;\n        const closeButton = tabName != \"home\" ? H`<button type=\"button\" on:click=${(ev: Event) => {\n            ev?.preventDefault?.();\n            ev?.stopPropagation?.();\n            if (ev?.target == ev?.currentTarget) {\n                self?.dispatchEvent?.(new TabCloseEvent(\"tab-close\", { bubbles: true, composed: true }, tabName));\n            }\n        }} class=\"ui-tabbed-box-tab-close\" aria-label=${`Close ${readableLabel}`} part=\"tab-close\">\n            <ui-icon icon=\"x\"></ui-icon>\n        </button>` : null;\n\n        //\n        const tabButton = H`<div on:click=${(ev: Event) => {\n            ev?.preventDefault?.();\n            ev?.stopPropagation?.();\n            if (ev?.target == ev?.currentTarget) {\n                self?.openTab?.(tabName, ev);\n            }\n        }} class=\"ui-tabbed-box-tab\" role=\"tab\" data-tab-name=${tabName}>${tabLabel}${closeButton}</div>`;\n        addPartProperty(tabButton, tabName);\n        propRef(self as any, \"currentTab\")?.[$trigger]?.();\n        return tabButton; //@ts-ignore\n    }\n\n    //\n    // Prevent recursive tab operations\n    private isOpeningTab = false;\n    private openingTabName = \"\";\n\n    openTab(tabName: string, ev?: any) {\n        if (!tabName) return;\n\n        // Prevent recursive calls for the same tab\n        if (this.isOpeningTab && this.openingTabName === tabName) {\n            return;\n        }\n\n        this.isOpeningTab = true;\n        this.openingTabName = tabName;\n\n        try {\n            const self: any = this;\n            if (tabName && tabName != self?.currentTab)\n                { self.currentTab = tabName ?? self?.currentTab; }\n            self?.dispatchEvent?.(new TabChangedEvent(\"tab-changed\", { bubbles: true, composed: true }, self.currentTab));\n        } finally {\n            this.isOpeningTab = false;\n        }\n    }\n\n    //\n    constructor() { super(); }\n    onInitialize() {\n        super.onInitialize?.(); const self = this as any;\n        self.removeAttribute(\"sidebar-opened\");\n        self.removeAttribute(\"toolbar-opened\");\n        self.removeAttribute(\"sidebar-drop-menu\");\n\n        //\n        requestAnimationFrame(() => {\n            self.removeAttribute(\"sidebar-drop-menu\");\n            self.removeAttribute(\"sidebar-opened\");\n            self.removeAttribute(\"toolbar-opened\");\n        });\n\n        //\n        self.addEventListener(\"keydown\", (e: KeyboardEvent) => {\n            const target  = e?.composedPath?.()?.[0] as HTMLElement;\n            const isInput = target?.tagName === \"INPUT\" || target?.tagName === \"TEXTAREA\" || target?.isContentEditable;\n            if (isInput) { return; }\n\n            //\n            if (e?.ctrlKey && (e?.key === \"ArrowLeft\" || e?.key === \"ArrowRight\") && self?.checkVisibility({\n                contentVisibilityAuto: true,\n                opacityProperty: true,\n                visibilityProperty: true\n            })) {\n                e?.preventDefault?.();\n                e?.stopPropagation?.();\n\n                //\n                const rawTabs = Array.from(self?.tabs?.keys?.() ?? []);\n                const tabs = rawTabs?.filter?.(k => k !== \"home\" && !(typeof k === \"string\" && k.startsWith(\"_\")));\n\n                //\n                const currentIndex = tabs?.indexOf?.(self?.currentTab ?? \"\");\n                let newIndex = currentIndex;\n\n                //\n                if (newIndex === -1) { newIndex = 0; }\n\n                //\n                if (e?.key === \"ArrowLeft\") {\n                    newIndex = currentIndex - 1;\n                    if (newIndex < 0) { newIndex = tabs?.length - 1; }\n                } else {\n                    newIndex = currentIndex + 1;\n                    if (newIndex >= tabs?.length) { newIndex = 0; }\n                }\n\n                //\n                const newTab = tabs?.[newIndex];\n                self?.openTab?.(newTab);\n            }\n        });\n    }\n\n    //\n    onRender() {\n        const self: any = this;\n        const sidebarOpenedRef = propRef(self as any, \"sidebarOpened\") ?? self.sidebarOpened;\n\n        makeClickOutsideTrigger(\n            sidebarOpenedRef,\n            Q(\"button.open-sidebar\", self?.shadowRoot),\n            Q(\".sidebar\", self?.shadowRoot)\n        );\n\n        //\n        Q(\"a\")?.addEventListener?.(\"click\", ()=>{\n            self.sidebarOpened = false;\n        });\n\n        //\n        self.sidebarOpened = false;\n\n        // Register sidebar with back navigation for mobile back gesture support\n        const sidebarEl = self?.shadowRoot?.querySelector?.(\".sidebar\") as HTMLElement;\n        if (sidebarEl && sidebarOpenedRef) {\n            (sidebarEl as any)._backUnreg = registerSidebar(sidebarEl as HTMLElement, sidebarOpenedRef, () => {\n                self.sidebarOpened = false;\n            });\n        }\n\n        if (!self.tabs || !self.currentTab) return;\n        this.observeTabsOverflow?.();\n    }\n\n    //\n    protected readonly sidebarUniqueId = `tabbed-sidebar-${Math.random().toString(36).slice(2)}`;\n    protected tabsBox!: HTMLElement\n    protected detachTabsOverflow!: () => void\n    protected resizeObserver!: ResizeObserver\n    protected observeTabsOverflow() {\n        const self: any = this;\n        self.tabsBox = self.shadowRoot?.querySelector?.(\".ui-tabbed-box-tabs\") ?? \"\";\n        if (!self.tabsBox) return;\n\n        self.detachTabsOverflow?.();\n        self.resizeObserver?.disconnect();\n\n        const updateIndicators = () => {\n            queueMicrotask(() => {\n                if (self.tabsBox) {\n                    const maxScrollLeft = self.tabsBox.scrollWidth - self.tabsBox.clientWidth;\n                    const hasOverflow = maxScrollLeft > 1;\n                    const startOverflow = self.tabsBox.scrollLeft > 1;\n                    const endOverflow = self.tabsBox.scrollLeft < maxScrollLeft - 1;\n\n                    if (self.tabsBox.hasAttribute(\"data-scrollable\") !== hasOverflow) {\n                        self.tabsBox.toggleAttribute(\"data-scrollable\", hasOverflow);\n                    }\n                    if (self.tabsBox.hasAttribute(\"data-scrollable-start\") !== startOverflow) {\n                        self.tabsBox.toggleAttribute(\"data-scrollable-start\", startOverflow);\n                    }\n                    if (self.tabsBox.hasAttribute(\"data-scrollable-end\") !== endOverflow) {\n                        self.tabsBox.toggleAttribute(\"data-scrollable-end\", endOverflow);\n                    }\n                }\n            });\n        };\n\n        const onWheel = (event: WheelEvent) => {\n            if (Math.abs(event.deltaX) < Math.abs(event.deltaY)) {\n                const delta = clamp(event.deltaY, -80, 80);\n                self.tabsBox.scrollLeft += delta;\n                event.preventDefault();\n            }\n        };\n\n        const onPointerUp = () => updateIndicators();\n\n        self.tabsBox.addEventListener(\"wheel\", onWheel, { passive: false });\n        self.tabsBox.addEventListener(\"scroll\", updateIndicators, { passive: true });\n        self.tabsBox.addEventListener(\"pointerup\", onPointerUp, { passive: true });\n\n        self.detachTabsOverflow = () => {\n            self.tabsBox.removeEventListener(\"wheel\", onWheel);\n            self.tabsBox.removeEventListener(\"scroll\", updateIndicators);\n            self.tabsBox.removeEventListener(\"pointerup\", onPointerUp);\n        };\n\n        updateIndicators();\n        queueMicrotask(updateIndicators);\n\n        if (typeof ResizeObserver !== \"undefined\") {\n            self.resizeObserver = new ResizeObserver(updateIndicators);\n            self.resizeObserver.observe(self.tabsBox);\n        }\n    }\n\n    //\n    styles = () => styled;\n    render = function () {\n        const openedProperty = propRef(this as any, \"sidebarOpened\") ?? this.sidebarOpened;\n        const toolbarOpenedProperty = propRef(this as any, \"toolbarOpened\") ?? this.toolbarOpened;\n        return H`<div part=\"bar\" class=\"bar\">\n            <button\n                part=\"open-sidebar\"\n                class=\"open-sidebar c2-surface\"\n                aria-haspopup=\"menu\"\n                aria-controls=${this.sidebarUniqueId}\n                aria-expanded=${conditional(openedProperty, \"true\", \"false\")}\n                on:click=${() => { this.sidebarOpened = !this.sidebarOpened; }}\n            ><ui-icon icon=\"${conditional(openedProperty, 'text-outdent', 'list')}\"></ui-icon></button>\n            <form class=\"ui-tabbed-box-tabs pinned\" part=\"pinned\">${this.createTab(\"home\")}</form>\n            <div class=\"toolbar-slot\" toolbar-opened=${conditional(toolbarOpenedProperty, \"true\", \"false\")}><slot name=\"bar\"></slot></div>\n            <form class=\"ui-tabbed-box-tabs\" part=\"tabs\">${M(observableByMap(this.tabs ?? new Map()), ([key, _], idx) => (key != \"home\" && (typeof key == \"string\") && !key.startsWith(\"_\") ? this.createTab(key) : null))}\n            </form>\n\n            <button\n                type=\"button\"\n                part=\"toggle-toolbar\"\n                class=\"toggle-toolbar c2-surface\"\n                aria-label=\"Toggle toolbar\"\n                aria-expanded=${conditional(toolbarOpenedProperty, \"true\", \"false\")}\n                on:click=${(ev: Event) => {\n                    ev?.preventDefault?.();\n                    ev?.stopPropagation?.();\n                    if (ev?.target == ev?.currentTarget) {\n                        this.toolbarOpened = !this.toolbarOpened;\n                    }\n                }}\n            ><ui-icon icon=\"${conditional(toolbarOpenedProperty, 'caret-right', 'caret-left')}\"></ui-icon></button>\n        </div>\n        <div part=\"backdrop\" class=\"ui-backdrop\"><slot name=\"backdrop\"></slot></div>\n        <div part=\"underlay\" class=\"ui-underlay\"><slot name=\"underlay\"></slot></div>\n        <div part=\"content-box\" class=\"content-box\">\n            <div part=\"sidebar\" class=\"sidebar\" id=${this.sidebarUniqueId} sidebar-opened=${conditional(openedProperty, \"true\", \"false\")}><slot name=\"sidebar\"></slot></div>\n            <div part=\"content\" class=\"content\"><slot></slot></div>\n        </div>`;\n    }\n}\n\n//\nexport default TabbedSidebar;\n","/* **\n * @module ui/inputs/slider/Slider\n * @description Slider input element\n * @author [@danielx](https://github.com/danielx)\n * @version 1.0.0\n * @license MIT\n * @copyright 2025\n */\n\n/*\n * Functional Appearance: Slider (alike range)\n * Usable for: Radio, Range, Checkbox, Number\n * Differs by: Universal Wrapper, Mobile Friendly, More Functional\n */\n\n//\nimport { attrRef, defineElement, H, property, valueAsNumberRef, valueRef, dragSlider, getInputValues, Q, bindWith } from \"fest/lure\";\nimport { preloadStyle, handleProperty } from \"fest/dom\";\nimport { computed, assign, propRef } from \"fest/object\";\n\n//\nimport { UIElement } from \"@fl-ui/base/UIElement\";\n\n// @ts-ignore\nimport styles from \"./Slider.scss?inline\"\nconst styled  = preloadStyle(styles);\n\n// @ts-ignore\n@defineElement(\"ui-slider\")\nexport class SliderInput extends UIElement {\n    get valueAsNumber() {\n        return getInputValues(this.input)?.[0] || 0;\n    }\n\n    //\n    @property({ source: \"query\", name: \"input\" }) input?: HTMLInputElement;\n    @property({ source: \"query-shadow\", name: \".ui-thumb\" }) thumb?: HTMLElement;\n    @property({ source: \"query-shadow\", name: \".ui-box\" }) handle?: HTMLElement;\n    @property({ source: \"attr\" }) name?: string = \"\";\n    @property({ source: \"attr\" }) value?: string|null = null;\n    @property({ source: \"attr\" }) min?: string = \"0\";\n    @property({ source: \"attr\" }) max?: string = \"100\";\n    @property({ source: \"attr\" }) step?: string = \"1\";\n    @property({ source: \"attr\" }) type?: string;\n    @property({ source: \"attr\" }) disabled?: boolean = false;\n    @property({ source: \"attr\" }) variant?: string;\n\n    //\n    static formAssociated = true;\n\n    //\n    constructor() {\n        super(); // @ts-ignore\n        this.internals_ = this.attachInternals();\n    }\n\n    //\n    styles = () => styled;\n    render = ()=> H`\n<div class=\"ui-box c2-surface\" part=\"box\">\n    <div class=\"ui-track c2-surface\" part=\"track\"></div>\n    <div class=\"ui-thumb c2-surface\" part=\"thumb\" style=\"z-index: 99;\"></div>\n</div>\n<slot></slot>\n`;\n\n    //\n    onRender() {\n        super.onRender();\n\n        // Initialize input after render\n        queueMicrotask(() => this.initializeInput());\n    }\n\n    initializeInput() {\n        const self: any = this;\n        if (!self?.querySelector?.(\"input\")) {\n            const newInput = document.createElement(\"input\");\n            self?.append?.(newInput);\n        }\n        {\n            const newInput = Q(\"input\", self);\n            newInput.type = newInput?.type || self?.type || \"range\";\n            newInput.value ||= self?.value || self?.min || \"0\";\n            self.type = newInput.type || self?.type;\n\n            // Bind properties to input element\n            bindWith(newInput, \"value\", propRef(self as any, \"value\"), handleProperty, null, true);\n            bindWith(newInput, \"name\", propRef(self as any, \"name\"), handleProperty);\n            bindWith(newInput, \"min\", propRef(self as any, \"min\"), handleProperty);\n            bindWith(newInput, \"max\", propRef(self as any, \"max\"), handleProperty);\n            bindWith(newInput, \"step\", propRef(self as any, \"step\"), handleProperty);\n            bindWith(newInput, \"type\", propRef(self as any, \"type\"), handleProperty);\n            bindWith(newInput, \"disabled\", propRef(self as any, \"disabled\"), handleProperty);\n        }\n    }\n\n    //\n    onInitialize() {\n        super.onInitialize();\n\n        // Set default variant based on input type\n        const host = this as any;\n        if (!host.getAttribute(\"variant\")) {\n            const inputType = this.type || \"range\";\n            host.setAttribute(\"variant\", inputType === \"checkbox\" ? \"switch\" : \"slider\");\n        }\n\n        // Initialize drag functionality after input is ready\n        queueMicrotask(() => {\n            if (this.input && this.thumb && this.handle) {\n                dragSlider(this.thumb, this.handle, this.input);\n            }\n        });\n\n        // Set up accessibility attributes\n        // @ts-ignore\n        assign([this.internals_, \"ariaValueMax\"], computed(attrRef(this.input, \"max\"), (v)=>getInputValues(this.input)?.[2]??v)); // @ts-ignore\n        assign([this.internals_, \"ariaValueMin\"], computed(attrRef(this.input, \"min\"), (v)=>getInputValues(this.input)?.[1]??v)); // @ts-ignore\n        assign([this.internals_, \"ariaValueNow\"], computed(valueAsNumberRef(this.input), (v)=>getInputValues(this.input)?.[0]??v)); // @ts-ignore\n        assign([this.internals_, \"ariaValueText\"], valueRef(this.input)); // @ts-ignore\n        assign([this.internals_, \"ariaOrientation\"], \"horizontal\"); // @ts-ignore\n        assign([this.internals_, \"ariaLive\"], \"polite\"); // @ts-ignore\n        assign([this.internals_, \"ariaRelevant\"], \"additions\"); // @ts-ignore\n        assign([this.internals_, \"ariaRole\"], \"slider\"); // @ts-ignore\n    }\n}\n\n//\nexport default SliderInput;\n","import { bindWith, defineElement, property, H } from \"fest/lure\";\nimport { addEvent, preloadStyle, handleProperty } from \"fest/dom\";\nimport { UIElement } from \"@fl-ui/base/UIElement\";\nimport { assign, propRef } from \"fest/object\";\n\n/* **\n * @module ui/inputs/text/Text\n * @description Text input element\n * @author [@danielx](https://github.com/danielx)\n * @version 1.0.0\n * @license MIT\n * @copyright 2025\n */\n\n/*\n * Functional Appearance: Long Text (alike input[type=\"text\"])\n * Usable for: Text Input, Fields, Textarea\n * Differs by: Scrollable, Long-Length, Better Text Selection, Mobile Friendly\n */\n\n// @ts-ignore\nimport styles from \"./Text.scss?inline\"\nconst styled  = preloadStyle(styles);\n\n// @ts-ignore\n@defineElement(\"ui-longtext\")\nexport class LongTextInput extends UIElement {\n    @property({ source: \"query\", name: \"input\" }) input?: HTMLInputElement;\n    @property({ source: \"query-shadow\", name: \".box-layer\" }) box?: HTMLElement;\n    @property({ source: \"attr\" }) name?: string = \"\";\n    @property({ source: \"property\" }) value?: string|null = null;\n    @property({ source: \"attr\" }) placeholder?: string = \"\";\n    @property({ source: \"attr\" }) disabled?: boolean = false;\n    @property({ source: \"attr\" }) readOnly?: boolean = false;\n    @property({ source: \"attr\" }) required?: boolean = false;\n\n    //\n    static formAssociated = true;\n    #connected = Promise.withResolvers();\n\n    //\n    constructor() {\n        super(); // @ts-ignore\n        this.internals_ = this.attachInternals();\n        this.#connected = Promise.withResolvers();\n    }\n\n    //\n    onRender() {\n        super.onRender();\n        this.#connected.resolve(true);\n\n        //\n        const self: any = this;\n        self.style.display = \"grid\";\n\n        //\n        const box = self?.shadowRoot?.querySelector?.(\".box-layer\");\n        addEvent(box, \"wheel\", (ev) => {\n            // use vertical scroll to scroll horizontally\n            if (ev?.deltaY !== 0) {\n                box?.scrollBy?.({\n                    left: (-ev?.deltaY || 0) - (ev?.deltaX || 0),\n                    behavior: \"smooth\"\n                });\n                ev?.preventDefault?.();\n            }\n        });\n\n        // fix scrolling by horizontal\n        queueMicrotask(() => {\n            this.initializeInput();\n\n            //\n            const box = self?.shadowRoot?.querySelector?.(\".box-layer\");\n            //const frame: any = document.createElement(\"ui-scrollframe\"); // @ts-ignore\n            //frame.style.zIndex = 99;\n            //frame?.bindWith?.(box, self, self?.querySelector?.(\"input\"));\n        });\n    }\n\n    initializeInput() {\n        const self: any = this;\n        if (!self?.querySelector?.(\"input\")) {\n            const newInput = document.createElement(\"input\");\n            self?.append?.(newInput);\n        }\n        {\n            const newInput = self?.querySelector?.(\"input\");\n            newInput.type = \"text\";\n            newInput.value ||= self?.value;\n\n            //\n            bindWith(newInput, \"value\", propRef(self as any, \"value\"), handleProperty, null, true);\n            bindWith(newInput, \"name\", propRef(self as any, \"name\"), handleProperty);\n            bindWith(newInput, \"placeholder\", propRef(self as any, \"placeholder\"), handleProperty);\n            bindWith(newInput, \"disabled\", propRef(self as any, \"disabled\"), handleProperty);\n            bindWith(newInput, \"readOnly\", propRef(self as any, \"readOnly\"), handleProperty);\n            bindWith(newInput, \"required\", propRef(self as any, \"required\"), handleProperty);\n        }\n    }\n\n    //\n    onInitialize() {\n        super.onInitialize(); // @ts-ignore\n        assign([this.internals_, \"ariaValueText\"], this.value); // @ts-ignore\n        assign([this.internals_, \"ariaOrientation\"], \"horizontal\"); // @ts-ignore\n        assign([this.internals_, \"ariaLive\"], \"polite\"); // @ts-ignore\n        assign([this.internals_, \"ariaRelevant\"], \"additions\"); // @ts-ignore\n        assign([this.internals_, \"ariaRole\"], \"textbox\"); // @ts-ignore\n    }\n\n    //\n    styles = function () { return styled; }\n    render = function () { return H`<div class=\"box-layer\" part=\"box-layer\"><slot></slot></div>`; };\n}\n\n//\nexport default LongTextInput;\n","/* Statusbar wrapper */\nimport UIElement from \"@fl-ui/base/UIElement\";\nimport { H, defineElement } from \"fest/lure\";\n\n//\n// @ts-ignore\nimport styles from \"./StatusBar.scss?inline\";\nimport { preloadStyle } from \"fest/dom\";\nconst styled = preloadStyle(styles);\n\n//\n// @ts-ignore\n@defineElement(\"ui-statusbar\")\nexport class StatusBar extends UIElement {\n    constructor() { super(); }\n\n    //\n    styles = () => styled;\n    render = () => {\n        return H`\n<div style=\"background-color: transparent;\" part=\"left\"   class=\"left\"  ><slot name=\"left\"  ></slot></div>\n        <div style=\"background-color: transparent;\" part=\"center\" class=\"center\"><slot name=\"center\"></slot></div>\n        <div style=\"background-color: transparent;\" part=\"right\"  class=\"right\" ><slot name=\"right\" ></slot></div>`;\n    };\n}\n","/* Taskbar wrapper */\nimport UIElement from \"@fl-ui/base/UIElement\";\nimport { H, defineElement } from \"fest/lure\";\n\n//\n// @ts-ignore\nimport styles from \"../scss/TaskBar.scss?inline\";\nimport { preloadStyle } from \"fest/dom\";\nconst styled = preloadStyle(styles);\n\n//\n// @ts-ignore\n@defineElement(\"ui-taskbar\")\nexport class UITaskBar extends UIElement {\n    constructor() { super(); }\n    styles = () => styled;\n    render = () => H`<div part=\"taskbar\" class=\"taskbar\"><slot></slot></div>`;\n}\n","/* Taskbar Item (Task) */\nimport UIElement from \"@fl-ui/base/UIElement\";\nimport { preloadStyle } from \"fest/dom\";\nimport { H, property, defineElement } from \"fest/lure\";\n\n// @ts-ignore\nimport styles from \"../scss/Task.scss?inline\";\nconst styled = preloadStyle(styles);\n\n//\n// @ts-ignore\n@defineElement(\"ui-task\")\nexport class UITask extends UIElement {\n    @property({ source: \"attr\" }) public title?: string = \"Task\";\n    @property({ source: \"attr\" }) public icon?: string = \"github\";\n\n    //\n    constructor() { super(); }\n    styles = () => styled;\n    render = function () {\n        return H`\n            <div part=\"icon\" class=\"task-icon c2-contrast c2-transparent\"><ui-icon class=\"c2-contrast c2-transparent\" part=\"icon\" icon=\"${this.icon}\"></ui-icon></div>\n            <div part=\"title\" class=\"task-title c2-contrast c2-transparent\">${this.title}</div>\n        `;\n    }\n}\n","/* Task Interaction Logic */\nimport { Q, ITask } from \"fest/lure\";\n\n//\nexport class TaskInteraction {\n    list: ITask[]|any = [];\n    taskbar: HTMLElement|any;\n\n    //\n    constructor(taskbar: HTMLElement|any = null, list: ITask[]|any = []) {\n        this.list = list;\n        this.bindInteraction(taskbar);\n    }\n\n    //\n    bindInteraction(taskbar: HTMLElement|any = null): TaskInteraction {\n        if (taskbar) this.taskbar = taskbar;\n        if (!this.taskbar) return this;\n        this.taskbar?.addEventListener?.(\"click\", (ev)=>{\n            ev.preventDefault();\n\n            //\n            const taskEl = Q(\"ui-task\", ev?.target, 0, \"parent\");\n            const task = this.list?.find((t)=>(t?.taskId == (taskEl?.getAttribute?.(\"data-id\") || \"\"))) ?? null;\n            if (task) {\n                if (!task?.focus) { task.active = true; task.focus = true; } else { task.active = false; };\n            } else {\n                this.list?.forEach?.((t)=>{if (t?.focus) { t.focus = false; }});\n            }\n        });\n        return this;\n    }\n}\n","/* Task Indication Logic */\nimport { bindWith, ITask } from \"fest/lure\";\nimport { handleAttribute } from \"fest/dom\";\nimport { propRef } from \"fest/object\";\n\n//\nexport class TaskIndication {\n    task: ITask|null = null;\n    taskEl: HTMLElement|any;\n\n    //\n    constructor(taskEl: HTMLElement|any = null, task: ITask|null = null) {\n        this.task = task || null;\n        this.bindIndication(taskEl);\n    }\n\n    //\n    bindIndication(taskEl?: HTMLElement|any|null): TaskIndication {\n        this.taskEl = taskEl ?? this.taskEl;\n        if (!this.taskEl) return this;\n\n        //\n        bindWith(this.taskEl, \"data-focus\", propRef(this.task, \"focus\"), handleAttribute);\n        bindWith(this.taskEl, \"data-active\", propRef(this.task, \"active\"), handleAttribute);\n        bindWith(this.taskEl, \"icon\", propRef(this.task?.payload, \"icon\"), handleAttribute);\n        bindWith(this.taskEl, \"title\", propRef(this.task?.payload, \"title\"), handleAttribute);\n        bindWith(this.taskEl, \"data-id\", propRef(this.task, \"taskId\"), handleAttribute);\n\n        //\n        document.addEventListener(\"task-focus\", (e)=>{\n            handleAttribute(this.taskEl, \"data-focus\", this.task?.focus ?? false);\n            handleAttribute(this.taskEl, \"data-active\", this.task?.active ?? false);\n            handleAttribute(this.taskEl, \"icon\", this.task?.payload?.icon ?? \"\");\n            handleAttribute(this.taskEl, \"title\", this.task?.payload?.title ?? \"\");\n            handleAttribute(this.taskEl, \"data-id\", this.task?.taskId ?? \"\");\n        });\n\n        //\n        return this;\n    }\n}\n","/* Desktop Taskbar appearance styles DOM Mixin */\nimport { DOMMixin, preloadStyle } from \"fest/dom\";\n\n//\n// @ts-ignore\nimport styles from \"./Desktop.scss?inline\";\nconst styled = preloadStyle(styles);\n\n//\nexport class DesktopTaskbar extends DOMMixin {\n    element?: HTMLElement|any|null;\n\n    //\n    constructor() {\n        super(\"desktop-taskbar\");\n    }\n\n    //\n    connect(element: HTMLElement|any|null = null) {\n        if (element) { this.element = element; }\n        if (this.element) { this.element.classList.add(\"desktop-taskbar\"); }\n        return this;\n    }\n\n    //\n    disconnect(element: HTMLElement|any|null = null) {\n        if (element) { this.element = null; }\n        return this;\n    }\n}\n","/* Desktop Taskbar appearance styles DOM Mixin */\nimport { DOMMixin, preloadStyle } from \"fest/dom\";\n\n//\n// @ts-ignore\nimport styles from \"./Mobile.scss?inline\";\nconst styled = preloadStyle(styles);\n\n//\nexport class MobileTaskbar extends DOMMixin {\n    element?: HTMLElement|any|null;\n\n    //\n    constructor() {\n        super(\"mobile-taskbar\");\n    }\n\n    //\n    connect(element: HTMLElement|any|null = null) {\n        if (element) { this.element = element; }\n        if (this.element) { this.element.classList.add(\"mobile-taskbar\"); }\n        return this;\n    }\n\n    //\n    disconnect(element: HTMLElement|any|null = null) {\n        if (element) { this.element = null; }\n        return this;\n    }\n}\n","import { observe, iterated, ref, affected } from \"fest/object\";\n\n// OPFS helpers\nimport {\n    openDirectory,\n    getMimeTypeByFilename,\n    downloadFile,\n    writeFile,\n    remove,\n    uploadFile,\n    getFileHandle,\n    getDirectoryHandle,\n    copyFromOneHandlerToAnother,\n    attachFile,\n    provide,\n    readFile,\n    uploadDirectory,\n    handleIncomingEntries\n} from \"fest/lure\";\n\n//\nexport type EntryKind = \"file\" | \"directory\";\nexport interface FileEntryItem {\n    name: string;\n    kind: EntryKind;\n    type?: string;\n    size?: number;\n    lastModified?: number;\n    handle?: any;\n    file?: File;\n}\n\n//\nconst handleCache = new WeakMap<any, any>();\n\n//\nexport class FileOperative {\n    // refs/state\n    #entries = ref<FileEntryItem[]>([]);\n    #loading = ref(false);\n    #error = ref(\"\");\n    #fsRoot: any = null;\n    #dirProxy: any = null;\n    #loadLock = false;\n    #clipboard: { items: string[]; cut?: boolean } | null = null;\n    #subscribed: any = null;\n    #loaderDebounceTimer: any = null;\n\n    //\n    public host: HTMLElement | null = null;\n    public pathRef = ref(\"/user/\");\n\n    //\n    get path() { return this.pathRef?.value || \"/user/\"; }\n    set path(value: string) { if (this.pathRef) this.pathRef.value = value || \"/user/\"; }\n    get entries() { return this.#entries; }\n\n    //\n    constructor() {\n        this.#entries = ref<FileEntryItem[]>([]);\n        this.pathRef ??= ref(\"/user/\");\n\n        //\n        affected(this.pathRef, (path) => this.loadPath(path || \"/user/\"));\n        navigator?.storage?.getDirectory?.()?.then?.((h)=>this.#fsRoot = h);\n    }\n\n    //\n    itemAction(item: FileEntryItem) {\n        const self: any = this;\n        const detail = { path: (self.path || \"/user/\") + item?.name, item, originalEvent: null };\n        const event = new CustomEvent(\"open-item\", { detail, bubbles: true, composed: true, cancelable: true });\n        this.host?.dispatchEvent(event);\n        if (event.defaultPrevented) return;\n\n        //\n        if (item?.kind === \"directory\") {\n            const next = (self.path?.endsWith?.(\"/\") ? self.path : self.path + \"/\") + item?.name + \"/\";\n            self.path = next;\n        } else {\n            const openEvent = new CustomEvent(\"open\", { detail, bubbles: true, composed: true });\n            this.host?.dispatchEvent(openEvent);\n        }\n    }\n\n    //\n    async requestUse() {\n        // TODO: implement\n    }\n\n    //\n    async refreshList(path: any|string = this.path) {\n        if (this.#loadLock) { return requestIdleCallback(() => this.refreshList(path), { timeout: 1000 }); };\n        this.#loadLock = true;\n        try {\n            await this.loadPath(path);\n        } catch (e: any) {\n            this.#error.value = e?.message || String(e || \"\");\n            console.warn(e);\n        } finally {\n            this.#loadLock = false;\n        }\n        return this;\n    }\n\n    //\n    async loadPath(path: any|string = this.path) {\n        const self: any = this;\n\n        //\n        if (this.#loadLock) { return requestIdleCallback(() => this.loadPath(path), { timeout: 1000 }); };\n        this.#loadLock = true;\n\n        //\n        try {\n            this.#loading.value = true;\n            this.#error.value = \"\";\n            const rel = path?.value || path || this.path || \"/user/\"; // openDirectory can consume absolute-like parts (it filters Booleans)\n\n            //\n            if (this.#dirProxy?.dispose) { this.#dirProxy.dispose(); }\n            this.#dirProxy = openDirectory(this.#fsRoot, rel, { create: false });\n            await this.#dirProxy;\n\n            console.log(\"rel\", rel);\n            \n            //\n            const loader = async ($map?: Map<string, any>) => {\n                const $entries = $map instanceof Map ? $map?.entries?.() : null;\n                const handleMap = await Promise.all($entries ? Array.from($entries) : (await Array.fromAsync(await this.#dirProxy?.entries?.() ?? [])));\n\n                //\n                const entries = (await Promise.all(handleMap?.map?.(async ($pair: any, index: number) => {\n                    return Promise.try(async () => {\n                        const [name, handle] = $pair as any; // @ts-ignore\n                        return handleCache?.getOrInsertComputed?.(handle, async () => {\n                            const kind: EntryKind = handle?.kind || (name?.endsWith?.(\"/\") ? \"directory\" : \"file\");\n                            const item: any = observe({ name, kind, handle });\n\n                            //\n                            if (kind === \"file\") {\n                                item.type = getMimeTypeByFilename?.(name);\n                                Promise.try(async () => {\n                                    try {\n                                        const f = await handle?.getFile?.();\n                                        item.file = f;\n                                        item.size = f?.size;\n                                        item.lastModified = f?.lastModified;\n                                        item.type = f?.type || item.type;\n                                    } catch { }\n                                }).catch?.(console.warn.bind(console));\n                            }\n\n                            //\n                            return item;\n                        });\n                    })?.catch?.(console.warn.bind(console));\n                }))?.catch?.(console.warn.bind(console)))?.filter?.(($item: any) => $item != null);\n\n                //\n                if (entries?.length != null && entries?.length >= 0 && typeof entries?.length == \"number\") { this.#entries.value = entries; };\n            };\n\n            //\n            const debouncedLoader = ($map?: Map<string, any>) => {\n                if (this.#loaderDebounceTimer) { clearTimeout(this.#loaderDebounceTimer); }\n                this.#loaderDebounceTimer = setTimeout(() => loader($map), 50);\n            };\n\n            //\n            if (typeof this.#subscribed == \"function\") { this.#subscribed?.(); this.#subscribed = null; }\n            await loader(await this.#dirProxy?.getMap?.() ?? [])?.catch?.(console.warn.bind(console));\n            this.#subscribed = affected((await this.#dirProxy?.getMap?.() ?? []), debouncedLoader);\n        } catch (e: any) {\n            this.#error.value = e?.message || String(e || \"\");\n            console.warn(e);\n        } finally {\n            this.#loading.value = false;\n            this.#loadLock = false;\n        }\n\n        //\n        this.#loadLock = false;\n        return this;\n    }\n\n    //\n    protected onRowClick = (item: FileEntryItem, ev: MouseEvent) => { ev.preventDefault(); this.itemAction(item); };\n    protected onRowDblClick = (item: FileEntryItem, ev: MouseEvent) => { ev.preventDefault(); this.itemAction(item); };\n    protected onRowDragStart = (item: FileEntryItem, ev: DragEvent) => {\n        if (!ev.dataTransfer) return;\n        ev.dataTransfer.effectAllowed = \"copyMove\";\n\n        //\n        const abs = (this.path || \"/user/\") + (item?.name || \"\");\n        ev.dataTransfer.setData(\"text/plain\", abs);\n        ev.dataTransfer.setData(\"text/uri-list\", abs);\n        if (item?.file) {\n            ev.dataTransfer.setData(\"DownloadURL\", item?.file?.type + \":\" + item?.file?.name + \":\" + URL.createObjectURL(item?.file as any));\n            ev.dataTransfer.items.add(item?.file as any);\n        }\n    };\n\n    //\n    protected async onMenuAction(item: FileEntryItem | null, actionId: string, ev: MouseEvent) {\n        try {\n            const itemName = item?.name;\n            if (!actionId) return; const abs = (this.path || \"/user/\") + (itemName || \"\"); switch (actionId) {\n                case \"open\":\n                    this.itemAction(item as FileEntryItem);\n                    break;\n                case \"view\":\n                    // Dispatch custom event for unified messaging\n                    this.dispatchEvent(new CustomEvent('context-action', {\n                        detail: { action: 'view', item }\n                    }));\n                    break;\n                case \"attach-workcenter\":\n                    // Dispatch custom event for unified messaging\n                    this.dispatchEvent(new CustomEvent('context-action', {\n                        detail: { action: 'attach-workcenter', item }\n                    }));\n                    break;\n                case \"download\":\n                    Promise.try(async () => {\n                        if (item?.kind === \"file\") {\n                            await downloadFile(await getFileHandle(this.#fsRoot, abs, { create: false }));\n                        } else {\n                            await downloadFile(await getDirectoryHandle(this.#fsRoot, abs, { create: false }));\n                        }\n                    }).catch(console.warn);\n                     break;\n                case \"delete\":\n                    await remove(this.#fsRoot, abs);\n                    break;\n                case \"rename\":\n                    if (item?.kind === \"file\") {\n                        const next = prompt(\"Rename to:\", itemName);\n                        if (next && next !== itemName) {\n                            await this.renameFile(abs ?? \"\", next ?? \"\");\n                        }\n                    }\n                    break;\n                case \"copyPath\":\n                    this.#clipboard = { items: [abs], cut: false };\n                    try { await navigator.clipboard?.writeText?.(abs); } catch { }\n                    break;\n                case \"copy\":\n                    this.#clipboard = { items: [abs], cut: false };\n                    try { await navigator.clipboard?.writeText?.(abs); } catch { }\n                    break;\n            }\n        } catch (e: any) {\n            console.warn(e);\n            this.#error.value = e?.message || String(e || \"\");\n        }\n    }\n\n    //\n    protected async renameFile(oldName: string, newName: string) {\n        const fromHandle = await getFileHandle(this.#fsRoot, oldName, { create: false });\n        const file = await fromHandle?.getFile?.();\n        if (!file) return;\n        const target = await getFileHandle(this.#fsRoot, newName, { create: true }).catch(() => null);\n        if (!target) {\n            await writeFile(this.#fsRoot, this.path + newName, file);\n        } else {\n            await writeFile(this.#fsRoot, this.path + newName, file);\n        }\n        await remove(this.#fsRoot, this.path + oldName);\n    }\n\n    //\n    async requestUpload() {\n        try {\n            if ((window as any)?.showDirectoryPicker) {\n                /*const confirmed = confirm(\"Upload directory?\");\n                if (confirmed) {\n                    await uploadDirectory(this.path, null);\n                    return;\n                }*/\n            }\n            await uploadFile(this.path, null);\n        } catch (e) { console.warn(e); }\n    }\n\n    //\n    async requestPaste() {\n        try {\n            // 1. Try modern Async Clipboard API first (images, files)\n            try {\n                // @ts-ignore\n                const clipboardItems = await navigator.clipboard.read();\n                if (clipboardItems && clipboardItems.length > 0) {\n                     await handleIncomingEntries(clipboardItems, this.path || \"/user/\");\n                     return;\n                }\n            } catch (e) {\n                // Fallback or permission denied\n            }\n\n            // 2. Try System Clipboard Text\n            let systemText = \"\";\n            try {\n                systemText = await navigator.clipboard?.readText?.();\n            } catch { }\n\n            // 3. Check internal clipboard\n            const internalItems = this.#clipboard?.items || [];\n\n            // Determine sources: Prefer internal if valid and no system text override (simple heuristic)\n            // Actually, unified handling:\n            if (systemText) {\n                await handleIncomingEntries({\n                    getData: (type: string) => type === \"text/plain\" ? systemText : \"\"\n                }, this.path || \"/user/\");\n                return;\n            }\n\n            if (internalItems.length > 0) {\n                const txt = internalItems.join(\"\\n\");\n                await handleIncomingEntries({\n                    getData: (type: string) => type === \"text/plain\" ? txt : \"\"\n                }, this.path || \"/user/\");\n\n                if (this.#clipboard?.cut) {\n                    for (const src of internalItems) {\n                         await remove(this.#fsRoot, src);\n                    }\n                    this.#clipboard = null;\n                }\n            }\n        } catch (e) { console.warn(e); }\n    }\n\n    //\n    public onPaste(ev: ClipboardEvent) {\n        ev.preventDefault();\n\n        // Try to read from event first\n        if (ev.clipboardData || (ev as any).dataTransfer) {\n            handleIncomingEntries(ev.clipboardData || (ev as any).dataTransfer, this.path || \"/user/\");\n            return;\n        }\n\n        //\n        this.requestPaste();\n    }\n\n    //\n    public onCopy(ev: ClipboardEvent) {\n        // Not implemented selection tracking yet\n    }\n\n    //\n    public async onDrop(ev: DragEvent) {\n        ev.preventDefault();\n\n        //\n        if ((ev as any).clipboardData || (ev as any).dataTransfer) {\n            handleIncomingEntries((ev as any).clipboardData || (ev as any).dataTransfer, this.path || \"/user/\");\n            return;\n        }\n    }\n\n    //\n    protected dispatchEvent(event: Event) {\n        this.host?.dispatchEvent(event);\n    }\n}\n\nexport default FileOperative;\n","import { MOCElement } from \"fest/dom\";\nimport type { FileEntryItem } from \"./Operative\";\nimport { ctxMenuTrigger, H } from \"fest/lure\";\n\n//\nconst disconnectRegistry = new FinalizationRegistry((ctxMenu: HTMLElement) => {\n    // utilize redundant ctx menu from DOM\n    //ctxMenu?.remove?.();\n});\n\n//\nconst makeFileActionOps = () => {\n    return [\n        { id: \"open\", label: \"Open\", icon: \"function\" },\n        { id: \"view\", label: \"View\", icon: \"eye\" },\n        { id: \"attach-workcenter\", label: \"Attach to Work Center\", icon: \"lightning\" },\n        { id: \"download\", label: \"Download\", icon: \"download\" }\n    ];\n};\n\n//\nconst makeFileSystemOps = () => {\n    return [\n        { id: \"delete\", label: \"Delete\", icon: \"trash\" },\n        { id: \"rename\", label: \"Rename\", icon: \"pencil\" },\n        { id: \"copyPath\", label: \"Copy Path\", icon: \"copy\" },\n        { id: \"movePath\", label: \"Move Path\", icon: \"hand-withdraw\" }\n    ];\n};\n\n//\nlet hasContextMenu = null;\nconst makeContextMenu = () => {\n    if (hasContextMenu) return hasContextMenu;\n    const ctxMenu = H`<ul class=\"grid-rows round-decor ctx-menu ux-anchor\" style=\"position: fixed; z-index: 99999;\" data-hidden></ul>`;\n    hasContextMenu = ctxMenu;\n    // Append to .basic-app element instead of document.body to inherit theme variables\n    const basicApp = document.querySelector('.basic-app') as HTMLElement;\n    (basicApp || document.body).append(ctxMenu);\n    return ctxMenu;\n}\n\n//\nexport const createItemCtxMenu = async (fileManager: any, onMenuAction: (item: FileEntryItem | null | undefined, actionId: string, ev: MouseEvent) => Promise<void>, entries: {value: FileEntryItem[]}) => {\n    const ctxMenuDesc = {\n        openedWith: null,\n        items: [\n            makeFileActionOps(),\n            makeFileSystemOps(),\n        ],\n        defaultAction: (initiator: HTMLElement, menuItem: any, ev: MouseEvent) => {\n            const rowFromCompose = Array.from(ev?.composedPath?.() || []).find((element: any) => element?.classList?.contains?.(\".row\")) || MOCElement(initiator, \".row\");\n            requestAnimationFrame(() => onMenuAction?.(((entries?.value ?? entries) as FileEntryItem[])?.find?.(item => (item?.name === (rowFromCompose as any)?.getAttribute?.(\"data-id\"))), menuItem?.id, ev));\n        }\n    };\n\n    //\n    const initiatorElement = fileManager;\n\n    //\n    const ctxMenu = makeContextMenu();\n    ctxMenuTrigger(initiatorElement as any, ctxMenuDesc, ctxMenu);\n    disconnectRegistry.register(initiatorElement, ctxMenu);\n    return ctxMenu;\n}\n","/**\n * Shared utilities for file manager components\n *\n * Extracted common functionality from RsExplorer, FileManagerContent, and Operative.\n */\n\nimport type { FileEntry } from \"./types\";\n\n// ============================================================================\n// ICON MAPPING\n// ============================================================================\n\n/**\n * Get icon name by MIME type\n */\nexport const iconByMime = (mime: string | undefined, def = \"file\"): string => {\n    if (!mime) return def;\n    if (mime.startsWith(\"image/\")) return \"image\";\n    if (mime.startsWith(\"audio/\")) return \"music\";\n    if (mime.startsWith(\"video/\")) return \"video\";\n    if (mime === \"application/pdf\") return \"file-text\";\n    if (mime.includes(\"zip\") || mime.includes(\"7z\") || mime.includes(\"rar\")) return \"file-archive\";\n    if (mime.includes(\"json\")) return \"brackets-curly\";\n    if (mime.includes(\"csv\")) return \"file-spreadsheet\";\n    if (mime.includes(\"xml\")) return \"code\";\n    if (mime.startsWith(\"text/\")) return \"file-text\";\n    return def;\n};\n\n/**\n * Extension to icon mapping\n */\nconst EXTENSION_ICON_MAP: Record<string, string> = {\n    // Documents\n    md: \"file-text\",\n    txt: \"file-text\",\n    pdf: \"file-pdf\",\n    doc: \"file-doc\",\n    docx: \"file-doc\",\n\n    // Images\n    png: \"file-image\",\n    jpg: \"file-image\",\n    jpeg: \"file-image\",\n    gif: \"file-image\",\n    svg: \"file-image\",\n    webp: \"file-image\",\n\n    // Code\n    js: \"file-js\",\n    ts: \"file-ts\",\n    jsx: \"file-jsx\",\n    tsx: \"file-tsx\",\n    html: \"file-html\",\n    css: \"file-css\",\n    scss: \"file-css\",\n    json: \"file-json\",\n\n    // Archives\n    zip: \"file-zip\",\n    tar: \"file-zip\",\n    gz: \"file-zip\",\n    rar: \"file-zip\",\n\n    // Media\n    mp3: \"file-audio\",\n    wav: \"file-audio\",\n    mp4: \"file-video\",\n    mov: \"file-video\",\n    webm: \"file-video\"\n};\n\n/**\n * Get icon name by file extension\n */\nexport const getFileIcon = (filename: string): string => {\n    const ext = filename.split(\".\").pop()?.toLowerCase() || \"\";\n    return EXTENSION_ICON_MAP[ext] || \"file\";\n};\n\n/**\n * Get icon for file entry item (unified function)\n * Handles FileEntry objects and string types.\n */\nexport const iconFor = (item: FileEntry | string, type?: string): string => {\n    // Handle string type (legacy support)\n    if (typeof item === \"string\") {\n        return item === \"directory\" ? \"folder\" : iconByMime(type || item || \"\");\n    }\n\n    // Handle FileEntry object\n    if (item?.kind === \"directory\") return \"folder\";\n\n    // Try MIME type first, then extension fallback\n    return iconByMime(item?.type) || getFileIcon(item?.name || \"\");\n};\n\n// ============================================================================\n// SIZE FORMATTING\n// ============================================================================\n\nconst sizeCache = new Map<number, string>();\n\n/**\n * Format file size with caching\n * Uses cached values for performance in lists.\n */\nexport const formatSize = (bytes?: number): string => {\n    if (bytes === undefined || bytes === null) return \"\";\n\n    if (sizeCache.has(bytes)) {\n        return sizeCache.get(bytes)!;\n    }\n\n    let formatted: string;\n    if (bytes < 1024) {\n        formatted = bytes + \" B\";\n    } else if (bytes < 1024 * 1024) {\n        formatted = (bytes / 1024).toFixed(2) + \" kB\";\n    } else if (bytes < 1024 * 1024 * 1024) {\n        formatted = (bytes / 1024 / 1024).toFixed(2) + \" MB\";\n    } else {\n        formatted = (bytes / 1024 / 1024 / 1024).toFixed(2) + \" GB\";\n    }\n\n    sizeCache.set(bytes, formatted);\n    return formatted;\n};\n\n/** @deprecated Use formatSize instead */\nexport const getSize = formatSize;\n\n// ============================================================================\n// DATE FORMATTING\n// ============================================================================\n\nconst dateCache = new Map<number, string>();\n\n/**\n * Format date with caching\n */\nexport const formatDate = (timestamp: number | Date | undefined): string => {\n    if (timestamp === undefined || timestamp === null) return \"\";\n\n    const ts = timestamp instanceof Date ? timestamp.getTime() : timestamp;\n\n    if (dateCache.has(ts)) {\n        return dateCache.get(ts)!;\n    }\n\n    const formatted = new Date(ts).toLocaleString(\"en-US\", {\n        dateStyle: \"short\",\n        timeStyle: \"short\"\n    });\n    dateCache.set(ts, formatted);\n    return formatted;\n};\n\n/** @deprecated Use formatDate instead */\nexport const getFormattedDate = formatDate;\n\n// ============================================================================\n// PATH UTILITIES\n// ============================================================================\n\n/**\n * Get parent directory path\n */\nexport const getParentPath = (path: string): string => {\n    const parts = path.replace(/\\/+$/g, \"\").split(\"/\").filter(Boolean);\n    if (parts.length <= 1) return \"/\";\n    return \"/\" + parts.slice(0, -1).join(\"/\") + \"/\";\n};\n\n/**\n * Normalize path (ensure trailing slash for directories)\n */\nexport const normalizePath = (path: string, isDirectory: boolean = false): string => {\n    if (isDirectory && !path.endsWith(\"/\")) {\n        return path + \"/\";\n    }\n    return path;\n};\n\n/**\n * Join path segments\n */\nexport const joinPath = (...segments: string[]): string => {\n    return \"/\" + segments\n        .map(s => s.replace(/^\\/+|\\/+$/g, \"\"))\n        .filter(Boolean)\n        .join(\"/\");\n};\n\n/**\n * Get file extension\n */\nexport const getExtension = (filename: string): string => {\n    const idx = filename.lastIndexOf(\".\");\n    return idx > 0 ? filename.slice(idx + 1).toLowerCase() : \"\";\n};\n\n// ============================================================================\n// SORTING UTILITIES\n// ============================================================================\n\n/**\n * Get sort order index by first letter (for alphabetical ordering)\n */\nexport const getAlphaOrder = (name: string): number => {\n    const firstChar = name?.charAt?.(0)?.toUpperCase?.() || \"A\";\n    return firstChar.charCodeAt(0) - 65; // A=0, B=1, etc.\n};\n\n/**\n * Get sort order index by first two letters (finer granularity)\n */\nexport const getAlphaOrderFine = (name: string): number => {\n    const first = (name?.charCodeAt?.(0) || 65) - 65;\n    const second = (name?.charCodeAt?.(1) || 65) - 65;\n    return first * 26 + second;\n};\n","import { property, defineElement, H, C, bindWith, initGlobalClipboard, M } from \"fest/lure\";\nimport { addEvent, handleStyleChange, isInFocus, preloadStyle } from \"fest/dom\";\nimport { computed, propRef, ref } from \"fest/object\";\n\n//\nimport { UIElement } from \"@fl-ui/base/UIElement\";\n\n// @ts-ignore\nimport fmCss from \"./FileManagerContent.scss?inline\";\nimport { type FileEntryItem, FileOperative } from \"./Operative\";\n\n//\nimport { createItemCtxMenu } from \"./ContextMenu\";\n\n//\nimport { iconFor, formatSize, formatDate } from \"./utils\";\n\n//\ninitGlobalClipboard();\n\n//\nconst styled = preloadStyle(fmCss);\n\n// @ts-ignore\n@defineElement(\"ui-file-manager-content\")\nexport class FileManagerContent extends UIElement {\n    @property({ source: \"query-shadow\", name: \".fm-grid-rows\" }) gridRowsEl?: HTMLElement;\n    @property({ source: \"query-shadow\", name: \".fm-grid\" }) gridEl?: HTMLElement;\n\n    //\n    public operativeInstance: FileOperative | null = null;\n    public operativeInstanceRef = ref<FileOperative | null>(null);\n\n    //\n    get entries() { return this.operativeInstance?.entries ?? []; }\n    get path() { return this.operativeInstance?.path || \"/user/\"; }\n    set path(value: string) { if (this.operativeInstance) this.operativeInstance.path = value || \"/user/\"; }\n    get pathRef() { return this.operativeInstance?.pathRef; }\n\n    //\n    refreshList() {\n        if (this.gridRowsEl) this.gridRowsEl.innerHTML = ``;\n        if (this.gridEl) this.gridEl.innerHTML = ``;\n        if (this.operativeInstance) this.operativeInstance.refreshList(this.path || \"/user/\");\n    }\n\n    //\n    onInitialize(): this {\n        const result = super.onInitialize();\n        return (result ?? this) as this;\n    }\n\n    //\n    protected bindDropHandlers() {\n        const container = this;\n        if (!container) return;\n        addEvent(container, \"dragover\", (ev: DragEvent) => {\n            if (isInFocus(ev?.target as HTMLElement, \"ui-file-manager-content, ui-file-manager\")) {\n                ev?.preventDefault?.();\n                if (ev.dataTransfer) {\n                    ev.dataTransfer.dropEffect = \"copy\";\n                }\n            }\n        });\n        addEvent(container, \"drop\", (ev: DragEvent) => {\n            if (isInFocus(ev?.target as HTMLElement, \"ui-file-manager-content, ui-file-manager\")) {\n                ev?.preventDefault?.();\n                ev?.stopImmediatePropagation?.();\n                this.operativeInstance?.onDrop?.(ev)\n            }\n        });\n    }\n\n    //\n    public onPaste(ev: ClipboardEvent) {\n        if (isInFocus(ev?.target as HTMLElement, \"ui-file-manager-content, ui-file-manager\")) {\n            if (this.operativeInstance) this.operativeInstance.onPaste(ev);\n        }\n    }\n\n    //\n    public onCopy(ev: ClipboardEvent) {\n        if (isInFocus(ev?.target as HTMLElement, \"ui-file-manager-content, ui-file-manager\")) {\n            if (this.operativeInstance) this.operativeInstance.onCopy(ev);\n        }\n    }\n\n    //\n    byFirstTwoLetterOrName(name: string): number {\n        const firstTwoLetters = name?.substring?.(0, 2)?.toUpperCase?.();\n        const index = (firstTwoLetters?.charCodeAt?.(0) || 65) - 65;\n        return index;\n    }\n\n    //\n    constructor() {\n        super();\n        this.operativeInstance ??= new FileOperative();\n        this.operativeInstance.host = this as any;\n        this.refreshList();\n    }\n\n    //\n    styles = () => styled;\n    render = function () {\n        const self: any = this;\n        const fileHeader = H`<div class=\"fm-grid-header\">\n            <div class=\"c icon\">@</div>\n            <div class=\"c name\">Name</div>\n            <div class=\"c size\">Size</div>\n            <div class=\"c date\">Modified</div>\n            <div class=\"c actions\">Actions</div>\n        </div>`\n\n        //\n        const operative = self.operativeInstance;\n        if (!operative) return \"\";\n\n        //\n        const makeListElement = (item: FileEntryItem) => {\n            const isFile = item?.kind === \"file\" || item?.file;\n            const itemEl = H`<div draggable=\"${isFile}\" data-id=${propRef(item, \"name\")} class=\"row c2-surface\"\n                on:click=${(ev: MouseEvent) => requestAnimationFrame(() => operative.onRowClick?.(item, ev))}\n                on:dblclick=${(ev: MouseEvent) => requestAnimationFrame(() => operative.onRowDblClick?.(item, ev))}\n                on:dragstart=${(ev: DragEvent) => operative.onRowDragStart?.(item, ev)}\n                data-id=${propRef(item, \"name\")}\n            >\n                <div style=\"pointer-events: none; background-color: transparent;\" class=\"c icon\"><ui-icon icon=${computed(item, ()=>{ return iconFor(item); })} /></div>\n                <div style=\"pointer-events: none; background-color: transparent;\" class=\"c name\" title=${propRef(item, \"name\")}>${propRef(item, \"name\")}</div>\n                <div style=\"pointer-events: none; background-color: transparent;\" class=\"c size\">${isFile ? propRef(item, \"size\") : \"\"}</div>\n                <div style=\"pointer-events: none; background-color: transparent;\" class=\"c date\">${isFile ? computed(propRef(item, \"lastModified\"), (val)=>{ return formatDate(val ?? 0); }) : \"\"}</div>\n                <div style=\"pointer-events: none; background-color: transparent;\" class=\"c actions\">\n                    <button class=\"action-btn\" title=\"Copy Path\" on:click=${(ev: MouseEvent) => { ev.stopPropagation(); requestAnimationFrame(() => operative.onMenuAction?.(item, \"copyPath\", ev)); }}>\n                        <ui-icon icon=\"copy\" />\n                    </button>\n                    <button class=\"action-btn\" title=\"Copy\" on:click=${(ev: MouseEvent) => { ev.stopPropagation(); requestAnimationFrame(() => operative.onMenuAction?.(item, \"copy\", ev)); }}>\n                        <ui-icon icon=\"clipboard\" />\n                    </button>\n                    <button class=\"action-btn\" title=\"Delete\" on:click=${(ev: MouseEvent) => { ev.stopPropagation(); requestAnimationFrame(() => operative.onMenuAction?.(item, \"delete\", ev)); }}>\n                        <ui-icon icon=\"trash\" />\n                    </button>\n                </div>\n            </div>`;\n\n            //\n            bindWith(itemEl, \"--order\", computed(propRef(item, \"name\"), (val)=>{ return self.byFirstTwoLetterOrName(val ?? \"\"); }), handleStyleChange);\n            return itemEl;\n        }\n\n        //\n        let fileRows: any = null;\n        const renderedEntries = M(self.entries, (file: any, idx: any) => {\n            console.log(file, idx);\n            if (typeof file == \"object\" && file != null && file?.name != null) {\n                return makeListElement({ name: file.name, kind: file.kind, size: file.size, lastModified: file.lastModified });\n            }\n            return null;\n        });\n        \n        /*const renderedEntries = C(computed(self.entries, (v) => {\n            if (v?.length != null && v?.length >= 0) {\n                if (fileRows != null) fileRows.innerHTML = ``;\n                const fragment = document.createDocumentFragment();\n                fragment.append(...v?.map?.((file: FileEntryItem)=>makeListElement(file))?.filter?.(el => el != null) || []);\n                return fragment;\n            }\n            return [];\n        }));*/\n\n        //\n        fileRows = H`<div class=\"fm-grid-rows\" style=\"will-change: contents;\">${renderedEntries}</div>`\n        renderedEntries.boundParent = fileRows;\n        createItemCtxMenu?.(fileRows, operative.onMenuAction.bind(operative), self.entries);\n        queueMicrotask(() => self.bindDropHandlers());\n\n        //\n        const rendered = H`<div class=\"fm-grid\" part=\"grid\">\n            ${fileHeader}\n            ${fileRows}\n        </div>`;\n\n        //\n        return rendered;\n    }\n}\n\n//\nexport default FileManagerContent;\n","import { H, defineElement, property, getDir, valueLink } from \"fest/lure\";\nimport { addEvent, preloadStyle } from \"fest/dom\";\nimport { affected, propRef } from \"fest/object\";\n\n//\nimport { UIElement } from \"@fl-ui/base/UIElement\";\n\n//\nimport FileManagerContent from \"./FileManagerContent\";\n\n// @ts-ignore\nimport fmCss from \"./FileManager.scss?inline\";\n\n//\nconst styled = preloadStyle(fmCss);\n\n// @ts-ignore\n@defineElement(\"ui-file-manager\")\nexport class FileManager extends UIElement {\n    @property({ source: \"query-shadow\", name: \".fm-grid-rows\" }) gridRowsEl?: HTMLElement;\n    @property({ source: \"query-shadow\", name: \".fm-grid\" }) gridEl?: HTMLElement;\n\n    // explicit sidebar control; if not provided, auto by container size\n    @property({ source: \"attr\", name: \"sidebar\" }) sidebar?: any = \"auto\";\n\n    // container inline size for CQ-based decisions\n    @property({ source: \"inline-size\" }) inlineSize?: number;\n\n    // refs/state\n    styles = () => styled;\n    constructor() { super(); }\n\n    //\n    get content() { return (this as any)?.querySelector?.(\"ui-file-manager-content\") as any; }\n    get operative() { return this.content?.operativeInstance; }\n    get pathRef() { return this.operative?.pathRef; }\n    get path() { return this.content?.path || this.operative?.path || \"/user/\"; }\n    set path(value: string) {\n        if (this.content) this.content.path = value || \"/user/\";\n        if (this.operative) this.operative.path = value || \"/user/\";\n    }\n\n    //\n    get input() { return this?.shadowRoot?.querySelector?.(\"input[name=\\\"address\\\"]\") as HTMLInputElement | null; }\n    get inputValue() { return this.input?.value || \"/user/\"; }\n    set inputValue(value: string) {\n        if (this.input) this.input.value = value || \"/user/\";\n    }\n\n    //\n    onInitialize(): this {\n        const result = super.onInitialize();\n        const self: any = result ?? this;\n\n        //\n        const contents: any = document.createElement(\"ui-file-manager-content\");\n        self.append(contents);\n\n        //\n        return self as this;\n    }\n\n    //\n    onRender(): this|void|undefined {\n        super.onRender();\n\n        // handle address field submit\n        const weak: any = new WeakRef(this);\n        const onEnter = (ev: KeyboardEvent) => {\n            if (ev.key === \"Enter\") {\n                const self = weak.deref() as any;\n                const input = self?.querySelector?.(\"input[name=\\\"address\\\"]\");\n                const val = (input as HTMLInputElement)?.value?.trim?.() || \"\";\n                if (val) self?.navigate(val);\n            }\n        };\n        addEvent(this, \"keydown\", onEnter);\n    }\n\n    //\n    get showSidebar(): boolean {\n        const force = String(this.sidebar ?? \"auto\").toLowerCase();\n        if (force === \"true\" || force === \"1\") return true;\n        if (force === \"false\" || force === \"0\") return false;\n        const width = propRef(this as any, \"inlineSize\")?.value ?? this.inlineSize ?? 0;\n        return width >= 720; // container-query based threshold\n    }\n\n    //\n    async navigate(toPath: string) {\n        const clean = getDir(toPath);\n        this.path = clean || this.path || \"/user/\";\n        this.operative?.refreshList(this.path || \"/user/\");\n        const input = this?.shadowRoot?.querySelector?.(\"input[name=\\\"address\\\"]\");\n        if (input && input instanceof HTMLInputElement && input.value != this.path) { input.value = this.path || \"/user/\"; };\n    }\n\n    //\n    async goUp() {\n        const parts = (this.path || this.content?.path || \"/user/\")\n            .replace(/\\/+$/g, \"\")\n            .split(\"/\")\n            .filter(Boolean);\n        console.log(\"parts\", parts, this.path, this.content?.path);\n        if (parts.length <= 1) return; // stay at /user\n        const up = \"/\" + parts.slice(0, -1).join(\"/\") + \"/\";\n        const clean = getDir(up);\n        this.navigate(this.path = clean || \"/user/\");\n    }\n\n    //\n    requestUpload() { this.operative?.requestUpload?.(); }\n    requestPaste() { this.operative?.requestPaste?.(); }\n    requestUse() { this.operative?.requestUse?.(); }\n\n    //\n    render = function() {\n        const self: any = this;\n        const sidebarVisible = self.showSidebar;\n\n        //\n        const content = H`<div part=\"content\" class=\"fm-content\"><slot></slot></div>`\n        const toolbar = H`<div part=\"toolbar\" class=\"fm-toolbar\">\n            <div class=\"fm-toolbar-left\">\n                <button class=\"btn\" title=\"Up\" on:click=${() => requestAnimationFrame(() => self.goUp())}><ui-icon icon=\"arrow-up\"/></button>\n                <button class=\"btn\" title=\"Refresh\" on:click=${() => requestAnimationFrame(() => self.navigate(self.inputValue || self.path || \"/user/\"))}><ui-icon icon=\"arrow-clockwise\"/></button>\n            </div>\n            <div class=\"fm-toolbar-center\"><form style=\"display: contents;\" onsubmit=\"return false;\">\n                <input class=\"address c2-surface\" autocomplete=\"off\" type=\"text\" name=\"address\" value=${self.path || \"/user/\"} />\n            </form></div>\n            <div class=\"fm-toolbar-right\">\n                <button class=\"btn\" title=\"Add\" on:click=${() => requestAnimationFrame(() => self.requestUpload?.())}><ui-icon icon=\"upload\"/></button>\n                <button class=\"btn\" title=\"Paste\" on:click=${() => requestAnimationFrame(() => self.requestPaste?.())}><ui-icon icon=\"clipboard\"/></button>\n                <button class=\"btn\" title=\"Use\" on:click=${() => requestAnimationFrame(() => self.requestUse?.())}><ui-icon icon=\"hand-withdraw\"/></button>\n            </div>\n        </div>`\n\n        //\n        requestAnimationFrame(() => {\n            affected(this.pathRef, (path) => {\n                const input = this?.shadowRoot?.querySelector?.(\"input[name=\\\"address\\\"]\");\n                if (input && input instanceof HTMLInputElement && input.value != path) { input.value = path || \"/user/\"; };\n            });\n        });\n\n        //\n        return H`<div part=\"root\" class=\"fm-root\" data-with-sidebar=${sidebarVisible}>${toolbar}${content}</div>`;\n    }\n}\n\n//\nexport default FileManager;\nexport { FileManagerContent };\n","/**\n * FL.UI - UI Components Library\n *\n * This is the default entry point that uses veela-advanced for styling.\n *\n * Entry points by style variant:\n * - `fest/fl-ui` - Default (veela-advanced)\n * - `fest/fl-ui/core` - Basic styles only (no veela)\n * - `fest/fl-ui/veela` - Alias for veela-advanced\n * - `fest/fl-ui/veela-basic` - Veela basic styles\n * - `fest/fl-ui/veela-advanced` - Veela advanced styles\n * - `fest/fl-ui/veela-beercss` - Beer CSS compatible styles\n *\n * @example\n * ```ts\n * // Default (veela-advanced)\n * import { Button, Card } from \"fest/fl-ui\";\n *\n * // With specific variant\n * import { Button } from \"fest/fl-ui/veela-basic\";\n * ```\n */\n\nimport { loadInlineStyle, preloadStyle } from \"fest/dom\";\nimport { UIPhosphorIcon } from \"fest/icon\";\nconsole.log(UIPhosphorIcon);\n\n// ============================================================================\n// CONFIGURATION\n// ============================================================================\n\nexport type FlUIStyleVariant = \"core\" | \"veela-basic\" | \"veela-advanced\" | \"veela-beercss\";\n\nexport interface FlUIConfig {\n    /** Whether to load styles automatically (default: true) */\n    loadStyles?: boolean;\n    /** Style variant to use (default: \"veela-advanced\") */\n    styleVariant?: FlUIStyleVariant;\n}\n\nconst defaultConfig: FlUIConfig = {\n    loadStyles: true,\n    styleVariant: \"veela-advanced\"\n};\n\nlet _config = { ...defaultConfig };\n\n/**\n * Configure fl.ui style behavior\n * Call this before importing any components if you want to customize\n */\nexport function configureFlUI(config: Partial<FlUIConfig>): void {\n    _config = { ..._config, ...config };\n}\n\n/**\n * Get current fl.ui configuration\n */\nexport function getFlUIConfig(): FlUIConfig {\n    return { ..._config };\n}\n\n//@ts-ignore\nimport styles from \"./styles/index.scss?inline\";\n\n// ============================================================================\n// EXPORTS\n// ============================================================================\n\nimport { loader } from \"./styles/index.veela\";\nexport * from \"./ui/index\";\n\n//\nexport * from \"./services/file-manager\";\nexport * from \"./services/markdown-view/Markdown\";\n\n//\n(async () => {\n    await loader();\n    const styled = await preloadStyle(styles);\n    // Load styles after runtime so fl.ui component rules win over normalize/base.\n    await loadInlineStyle(styles);\n})();\n"],"file":"index16.js"}