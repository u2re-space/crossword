{"version":3,"file":"index3.js","sources":["../../src/frontend/shells/minimal/index.ts"],"sourcesContent":["/**\n * Minimal Shell\n *\n * Simple toolbar-based single-view shell.\n * Features:\n * - Top navigation toolbar with view buttons\n * - Status bar for messages\n * - Single content area for one active view\n * - NO split view, NO sidebar, NO tabs\n */\n\nimport { H } from \"fest/lure\";\nimport { affected } from \"fest/object\";\nimport type { ShellId, ShellLayoutConfig, ViewId } from \"../types\";\n\n// @ts-ignore - SCSS import\nimport style from \"./minimal.scss?inline\";\n\n// Side effect: register icon component\nimport \"fest/icon\";\nimport { ShellBase } from \"../shell\";\n\n// ============================================================================\n// NAVIGATION ITEMS\n// ============================================================================\n\n/** Navigation item configuration */\ninterface NavItem {\n    readonly id: ViewId;\n    readonly name: string;\n    readonly icon: string;\n}\n\n/** Main navigation items shown in the toolbar */\nconst MAIN_NAV_ITEMS = [\n    { id: \"viewer\", name: \"Viewer\", icon: \"eye\" },\n    { id: \"explorer\", name: \"Explorer\", icon: \"folder\" },\n    { id: \"workcenter\", name: \"Work Center\", icon: \"lightning\" },\n    { id: \"airpad\", name: \"Airpad\", icon: \"hand-pointing\" },\n    { id: \"settings\", name: \"Settings\", icon: \"gear\" },\n    { id: \"history\", name: \"History\", icon: \"clock-counter-clockwise\" }\n] as const satisfies readonly NavItem[];\n\n/** Set of valid nav view IDs for fast lookup */\nconst VALID_NAV_VIEW_IDS = new Set(MAIN_NAV_ITEMS.map(item => item.id));\n\n/** Type guard for valid navigation view IDs */\nfunction isValidNavViewId(id: string): id is typeof MAIN_NAV_ITEMS[number][\"id\"] {\n    return VALID_NAV_VIEW_IDS.has(id as any);\n}\n\n// ============================================================================\n// BASIC SHELL IMPLEMENTATION\n// ============================================================================\n\nexport class MinimalShell extends ShellBase {\n    id: ShellId = \"minimal\";\n    name = \"Minimal\";\n\n    layout: ShellLayoutConfig = {\n        hasSidebar: false,\n        hasToolbar: true,\n        hasTabs: false,\n        supportsMultiView: false,\n        supportsWindowing: false\n    };\n\n    protected createLayout(): HTMLElement {\n        const root = H`\n            <div class=\"app-shell\" data-shell=\"minimal\">\n                <nav class=\"app-shell__nav\" role=\"navigation\" aria-label=\"Main navigation\">\n                    <div class=\"app-shell__nav-left\" data-nav-left>\n                        ${this.renderNavButtons()}\n                    </div>\n                    <div class=\"app-shell__nav-right\" data-shell-toolbar>\n                        <!-- View-specific toolbar actions go here -->\n                    </div>\n                </nav>\n                <main class=\"app-shell__content\" data-shell-content role=\"main\">\n                    <div class=\"app-shell__loading\">\n                        <div class=\"loading-spinner\"></div>\n                        <span>Loading...</span>\n                    </div>\n                </main>\n                <div class=\"app-shell__status\" data-shell-status hidden aria-live=\"polite\"></div>\n            </div>\n        ` as HTMLElement;\n\n        this.setupNavClickHandlers(root);\n        return root;\n    }\n\n    private renderNavButtons(): DocumentFragment {\n        const fragment = document.createDocumentFragment();\n\n        for (const item of MAIN_NAV_ITEMS) {\n            const button = H`\n                <button\n                    class=\"app-shell__nav-btn\"\n                    data-view=\"${item.id}\"\n                    type=\"button\"\n                    title=\"${item.name}\"\n                >\n                    <ui-icon icon=\"${item.icon}\" icon-style=\"duotone\"></ui-icon>\n                    <span class=\"app-shell__nav-label\">${item.name}</span>\n                </button>\n            ` as HTMLButtonElement;\n\n            fragment.appendChild(button);\n        }\n\n        return fragment;\n    }\n\n    private setupNavClickHandlers(root: HTMLElement): void {\n        const navLeft = root.querySelector(\"[data-nav-left]\");\n        if (!navLeft) return;\n\n        // Handle nav button clicks\n        navLeft.addEventListener(\"click\", (e) => {\n            const target = e.target as HTMLElement;\n            const button = target.closest(\"[data-view]\") as HTMLButtonElement | null;\n            if (!button) return;\n\n            const viewId = button.dataset.view;\n            if (viewId && isValidNavViewId(viewId)) {\n                this.navigate(viewId);\n            }\n        });\n\n        // Update active state reactively\n        affected(this.currentView, (viewId) => {\n            this.updateActiveNavButton(navLeft, viewId);\n        });\n    }\n\n    private updateActiveNavButton(navContainer: Element, activeViewId: ViewId): void {\n        const buttons = navContainer.querySelectorAll(\"[data-view]\");\n        buttons.forEach(btn => {\n            const isActive = (btn as HTMLElement).dataset.view === activeViewId;\n            btn.classList.toggle(\"active\", isActive);\n            btn.setAttribute(\"aria-current\", isActive ? \"page\" : \"false\");\n        });\n    }\n\n    protected getStylesheet(): string | null {\n        return style;\n    }\n\n    async mount(container: HTMLElement): Promise<void> {\n        await super.mount(container);\n\n        // Setup path-based navigation\n        this.setupPopstateNavigation();\n\n        // Determine initial view from pathname or default to \"viewer\"\n        const initialView = this.getInitialView();\n        await this.navigate(initialView);\n    }\n\n    private getInitialView(): ViewId {\n        if (typeof globalThis === \"undefined\") return \"viewer\";\n\n        // Get view from pathname (e.g., /viewer, /settings, /workcenter)\n        const pathname = globalThis?.location?.pathname?.replace(/^\\//, \"\").toLowerCase();\n\n        if (pathname && isValidNavViewId(pathname)) {\n            return pathname;\n        }\n\n        // Default to viewer\n        return \"viewer\";\n    }\n}\n\n// ============================================================================\n// FACTORY FUNCTION\n// ============================================================================\n\n/**\n * Factory function for creating MinimalShell instances.\n * \n * Note: The container parameter is required by ShellRegistration interface\n * but not used here - the shell is mounted later via shell.mount(container).\n */\nexport function createShell(_container: HTMLElement): MinimalShell {\n    return new MinimalShell();\n}\n\nexport default createShell;\n"],"names":[],"mappings":"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"}