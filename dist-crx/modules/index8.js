import{H as t,__vitePreload as e}from"./Settings.js";import"./Env.js";import{MarkdownView as o}from"./Markdown.js";import"./_commonjsHelpers.js";import"./index9.js";class n{id="print";name="Print";element=null;options;mdView=null;constructor(t={}){this.options={...t,initialData:t.initialData||t.initialMarkdown}}render(e){const n={...this.options,...e};this.loadStyles().catch(t=>console.warn("[PrintView] Failed to load print styles:",t));const i=new URLSearchParams(globalThis?.location?.search),l=n.initialMarkdown||i.get("content")||i.get("markdown-content")||i.get("text")||n.initialData||"",r=n.title||i.get("title")||"Document",a="docx"===n.exportFormat||"docx"===i.get("export")||"docx"===i.get("format"),s=(n.autoPrint??"false"!==i.get("auto-print"))&&!a,c=n.className||"print-view";if(a&&l.trim()&&this.handleDocxExport(l,r).catch(t=>console.error("[PrintView] DOCX export error:",t)),this.mdView=new o,this.element=t`
            <div class="${c}">
                <div class="print-content">
                    ${this.mdView}
                </div>
            </div>
        `,l.trim()&&this.mdView.setContent?.(l).catch(t=>{console.warn("[PrintView] Failed to set markdown content:",t)}),s&&l.trim()&&"undefined"!=typeof globalThis&&"print"in globalThis){const t=n.printDelay||(i.get("print-delay")?parseInt(i.get("print-delay")):1500);setTimeout(()=>{console.log("[PrintView] Auto-printing document"),globalThis?.print?.()},t)}return console.log("[PrintView] Rendered",{title:r,contentLength:l.length,autoPrint:s}),this.element}async loadStyles(){try{console.log("[PrintView] Using MarkdownView component styles")}catch(t){console.warn("[PrintView] Error during style setup:",t)}}async handleDocxExport(t,o){const{downloadHtmlAsDocx:n,downloadMarkdownAsDocx:i}=await e(async()=>{const{downloadHtmlAsDocx:t,downloadMarkdownAsDocx:e}=await import("./DocxExport.js");return{downloadHtmlAsDocx:t,downloadMarkdownAsDocx:e}},[],import.meta.url),l=`${(o||"document").replace(/[\\/:*?"<>|\u0000-\u001F]+/g,"-").slice(0,180)}.docx`;t.trim().startsWith("<")?await n(t,{title:o,filename:l}):await i(t,{title:o,filename:l});if("true"===new URLSearchParams(globalThis?.location?.search).get("close"))try{globalThis?.close?.()}catch{}}getElement(){return this.element||document.createElement("div")}getToolbar(){return null}lifecycle={onMount:()=>{console.log("[PrintView] Mounted")},onUnmount:()=>{console.log("[PrintView] Unmounted"),this.element=null,this.mdView=null},onShow:()=>{console.log("[PrintView] Shown")},onHide:()=>{console.log("[PrintView] Hidden")}}}function i(t){return new n(t)}const l=i;export{n as PrintView,l as createPrintView,i as createView,i as default};
